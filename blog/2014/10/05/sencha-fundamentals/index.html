
<!DOCTYPE HTML>

<html>

<head>
	<meta charset="utf-8">
	<title>Sencha Fundamentals - AllenToFight Blog</title>
	<meta name="author" content="AllenToFight">

	
	<meta name="description" content="Sencha Fundamentals All of the Sencha Touch visual components (like panels, lists, and toolbars) extend from the Ext.Component class. This base &hellip;">
	

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="AllenToFight Blog" type="application/atom+xml">
	
	<link rel="canonical" href="http://xiekunRonaldo.github.io/blog/2014/10/05/sencha-fundamentals/">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="/stylesheets/font-awesome.min.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><div class="profilepic">
	
	<img src="http://www.gravatar.com/avatar/27a0140c11f18fab9bf284743d2b2b4c?s=160" alt="Profile Picture" style="width: 160px;" />
	
</div>
<hgroup>
  <h1><a href="/">AllenToFight Blog</a></h1>
  
    <h2>Life To Code.</h2>
  
</hgroup>

<nav id="main-nav"><ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
<nav id="sub-nav">
	<div class="social">
		
			<a class="weibo" href="http://www.weibo.com/1876496750" title="Weibo">Facebook</a>
		
		
		
		
		
		
		
		
		
		
		
		
		
		
			<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</nav>
</header>				
			</div>
		</div>	
		<div class="mid-col">
			
				
			
			<div class="mid-col-container">
				<div id="content" class="inner"><article class="post" itemscope itemtype="http://schema.org/BlogPosting">
	<h1 class="title" itemprop="name">Sencha Fundamentals</h1>
	<div class="entry-content" itemprop="articleBody"><p>All of the Sencha Touch visual components (like panels, lists, and toolbars) extend from the Ext.Component class. This base class gives every component the ability to set certain standard layout-related properties, such as height, width, margin, padding, and style, or set content with the html or template (tpl) configs. Every component in Sencha Touch can be rendered to the DOM.</p>

<p>本章中我们将学习以下几点</p>

<ul>
<li><p>How to instantiate a basic component<em> How to implement templates</em> How to make references to components<em> How component traversing works</em> How to make references to DOM nodes* How to fire and remove events using event handling### How to instantiate a basic component
创建一个Sencha Touch view component
<code>javascript
var c = Ext.create('Ext.Component', {
  //key value pairs here, i.e.    html: 'Hello World!'});</code>in Sencha Touch you use a method, Ext.create(), to create a new object instance (in this case, Ext.component). This is because Sencha Touch has a built-in class system and class loader.
<code>Note</code>:在js中，创建一个对象用new，但在sencha touch中,几乎不用，because the new operator won’t inform the Sencha loader to load the required classes in the background
A much simpler way to render components to the DOM is what we call object literal notation (or lazy instantiation). You will probably use this more often when building real-world applications:
<code>javascript
var c = {   xtype: 'component', html : 'Hello World'}</code>
什么是xtype?xtype是以下键值对的别名<code>alias: widget.&lt;some-component&gt;</code>,通常你在以下两种情况下用到xtype:</p></li>
<li><p>When you define your own custom class (a blueprint for objects you create), you set an alias name to this component so you can easily refer to it later.(下一章中我们将学习如何创建自己的类)* To create a component instance in the object literal notation, use the xtype defined in the class blueprint (as above).
每一个Sencha view component都有一个xtype名字</p></li>
<li><code>Ext.List</code>对应<code>xtype:'list'</code></li>
<li><code>Ext.navigation.View</code>对应<code>xtype:'navigationview'</code>
Tip</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>When you use Sencha Architect for building Sencha Touch or Ext JS apps and you are creating an interface, xtype has a different name. You will need to look for the setting useralias. In the code that it generates, Sencha Architect will use alias: widget.&lt;useralias-name&gt;. So, in other words, xtype: &lt;useralias-name&gt; is equivalent to alias: widget.&lt;useralias-name&gt;.</span></code></pre></td></tr></table></div></figure>


<p>当我们创建components时(并且你不使用sencha-touch-all.js/sencha- touch-all-debug.js frameworks)，你需要告诉Sencha的Ext.Loader将相应的类载入内存中,Ext.Loader能将所有你指定的类和信赖关系按正确的顺序加载(类似java中的import),当你定义了自己的类并且嵌入了xtypes时，你可以将需要的类放requeires数据中告诉Ext.Loader去加载这些类,当用Ext.create()来创建这些components时,你能通过Ext.require()方法来加载这些类,<code>Ext.require("Ext.List");</code> or <code>requires: ["Ext.List"]</code>
注意以上的例子中,我们把html的内容写死了,在生产环境中这是非常不合适的,我们常常希望能动态生成内容,我们改用Templates来实现</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Ext</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">&#39;Ext.Component&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">tpl</span><span class="o">:</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">&#39;Ext.XTemplate&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;h1&gt;{name}&lt;/h1&gt;&lt;p&gt;{description}&lt;/p&gt;&#39;</span><span class="p">),</span>
</span><span class='line'>  <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Template&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;This is an example of how to configure a basic template.&#39;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>如上所示,Ext.Component允许你使用Ext.Xtemplate来动态生成内容，再来看一个生产环境中的例子</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Ext</span><span class="p">.</span><span class="nx">onReady</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Taxi Amsterdam&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;The only taxi in Amsterdam that does not circle around&#39;</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>  <span class="nx">Ext</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">&#39;Ext.Component&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">tpl</span><span class="o">:</span> <span class="s1">&#39;&lt;h1&gt;{name}&lt;/h1&gt;&lt;p&gt;{description}&lt;/p&gt;&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="o">:</span> <span class="nx">data</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">styleHtmlContent</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">cls</span><span class="o">:</span> <span class="s1">&#39;box&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">renderTo</span><span class="o">:</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">getBody</span><span class="p">()</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>动态改变数据</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Taxi Amsterdam&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">description</span><span class="o">:</span> <span class="s1">&#39;The only taxi in Amsterdam that does not circle around.&#39;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span><span class='line'><span class="nx">Ext</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;Ext.Component&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">Ext</span><span class="p">.</span><span class="nx">onReady</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">c</span> <span class="o">=</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">&#39;Ext.Component&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">tpl</span><span class="o">:</span> <span class="s1">&#39;&lt;h1&gt;{name}&lt;/h1&gt;&lt;p&gt;{description}&lt;/p&gt;&#39;</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>      <span class="nx">data</span><span class="o">:</span> <span class="nx">data</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">styleHtmlContent</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">cls</span><span class="o">:</span> <span class="s1">&#39;box&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">renderTo</span><span class="o">:</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">getBody</span><span class="p">()</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>  <span class="nx">data</span><span class="p">.</span><span class="nx">description</span> <span class="o">=</span> <span class="s2">&quot;We like tourists a lot!&quot;</span><span class="p">;</span> <span class="nx">c</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>以上的tpl还可简化为</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">myTpl</span> <span class="o">=</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span>
</span><span class='line'><span class="s1">&#39;Ext.XTemplate&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;h1&gt;{name}&lt;/h1&gt;&lt;p&gt;{description}&lt;/p&gt;&#39;</span><span class="p">);</span>
</span><span class='line'><span class="nx">c</span> <span class="o">=</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">&#39;Ext.Component&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">tpl</span><span class="o">:</span> <span class="nx">myTpl</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">data</span><span class="o">:</span> <span class="nx">data</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">styleHtmlContent</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">cls</span><span class="o">:</span> <span class="s1">&#39;box&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">renderTo</span><span class="o">:</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">getBody</span><span class="p">()</span>
</span><span class='line'>  <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>在实际生产环境中,我们会把所有的HTML的templates保存到一个custom separate (singleton) class中，而不是让它暴露在全局域中(参见第八章中的<code>Defining Singletons and Static Members</code>):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">//Example  utils/Template.js </span>
</span><span class='line'><span class="nx">Ext</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s1">&#39;Utils.utils.Template&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">statics</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">MY_TPL</span><span class="o">:</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">&#39;Ext.XTemplate&#39;</span><span class="p">,</span><span class="s1">&#39;&lt;h1&gt;{name}&lt;/h1&gt;&lt;p&gt;{description}&lt;/p&gt;&#39;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span> <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h4>实现更高级的Templates</h4>

<p>如果你不想把数据保存在一个随机的变量中，而是将数据从data store(假设为CabStore)load到template中,如下:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Ext</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">&#39;Ext.data.Store&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">id</span><span class="o">:</span><span class="s1">&#39;CabStore&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">fields</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">],</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">data</span> <span class="o">:</span> <span class="p">[</span>
</span><span class='line'>      <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Taxi Amsterdam&quot;</span><span class="p">,</span> <span class="nx">description</span><span class="o">:</span> <span class="s2">&quot;The best taxi service&quot;</span> <span class="o">+</span> <span class="s2">&quot;of Amsterdam.&quot;</span><span class="p">},</span>
</span><span class='line'>      <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Cab &amp; Co&quot;</span><span class="p">,</span> <span class="nx">description</span><span class="o">:</span> <span class="s2">&quot;Always fast.&quot;</span><span class="p">}</span>
</span><span class='line'>  <span class="p">]</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">myTpl</span> <span class="o">=</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">&#39;Ext.XTemplate&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;tpl for=&quot;.&quot;&gt;&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="s1">&#39;&lt;div class=&quot;row&quot;&gt;&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="s1">&#39;&lt;h1&gt;{name}&lt;/h1&gt;&lt;p&gt;{description}&lt;/p&gt;&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="s1">&#39;&lt;/div&gt;&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="s1">&#39;&lt;/tpl&gt;&#39;</span>
</span><span class='line'><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">Ext</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">&#39;Ext.DataView&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">itemTpl</span><span class="o">:</span> <span class="nx">myTpl</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">styleHtmlContent</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">cls</span><span class="o">:</span> <span class="s1">&#39;box&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">fullscreen</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">height</span><span class="o">:</span> <span class="mi">250</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>&lt;tpl for="."&gt;</code> looping tags, which loop through the root (.) of all the data records. This <code>&lt;tpl&gt;</code> tag sets the template markup for every row of data.</p>

<p>XTemplates是很强大的，不仅限于以上功能,You can run conditional expressions, basic math functions, built-in variables, custom member functions, and loops into templates.</p>

<h4>引用Components</h4>

<p>之前我们讨论了如何创建一个component并配合template使用,现在我们看看如何引用component</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">ComponentQuery</span><span class="o">:</span>
</span><span class='line'><span class="nx">Ext</span><span class="p">.</span><span class="nx">ComponentQuery</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;selector&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>//注意,In the component query, you pass in a string with the xtype:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">cars</span> <span class="o">=</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">ComponentQuery</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;car&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>或者搜索选择多个components:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">carsAndCabs</span> <span class="o">=</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">ComponentQuery</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;car, cab&quot;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>Tip</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">An</span> <span class="nx">alternative</span> <span class="nx">way</span> <span class="nx">of</span> <span class="nx">creating</span> <span class="nx">references</span> <span class="nx">to</span> <span class="nx">components</span> <span class="nx">is</span> <span class="nx">by</span> <span class="nx">using</span> <span class="nx">a</span> <span class="nx">refs</span> <span class="nx">object</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">controller</span><span class="p">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>It’s also possible to retrieve components with a component query for <code>id</code> or <code>itemId</code>, by passing in the string id name, prefixed with a #. As itemIds are not globally unique, it is a better practice to use them(<code>itemIds</code>) instead of ids.<code>javascript
Ext.ComponentQuery.query('#mybutton');</code>
You can even make your component query more complex by passing in CSS-like selectors.
select all panels that have the attribute title=&ldquo;Test&rdquo;:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Ext</span><span class="p">.</span><span class="nx">ComponentQuery</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;panel[title=&quot;Test&quot;]&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Or we can select only child elements from a component:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Ext</span><span class="p">.</span><span class="nx">ComponentQuery</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;formpanel &gt; button&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h4>Traversing Components</h4>

<p>以上最后一个例子就是<code>Traversing Components</code>,To traverse components, you can use the up() and down() methods to retrieve the first parent or first child component:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">//get first parent</span>
</span><span class='line'><span class="nx">myComponent</span><span class="p">.</span><span class="nx">up</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span> <span class="c1">//get first child</span>
</span><span class='line'><span class="nx">myComponent</span><span class="p">.</span><span class="nx">down</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">form</span> <span class="o">=</span> <span class="nx">myButton</span><span class="p">.</span><span class="nx">up</span><span class="p">(</span><span class="s1">&#39;formpanel&#39;</span><span class="p">);</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="nx">form</span><span class="p">.</span><span class="nx">down</span><span class="p">(</span><span class="s1">&#39;textfield[name=&quot;lastname&quot;]&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>the up() or down() method returns the first parent or child that it finds.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&gt;</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">ComponentQuery</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">)</span>
</span><span class='line'><span class="p">[</span><span class="nx">Class</span><span class="p">,</span> <span class="nx">Class</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="o">&gt;</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">Viewport</span><span class="p">.</span><span class="nx">down</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">)</span>
</span><span class='line'><span class="nx">Class</span> <span class="p">{</span><span class="nx">onInitializedListeners</span><span class="o">:</span> <span class="nb">Array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span class='line'><span class="nx">initialConfig</span><span class="o">:</span> <span class="nb">Object</span><span class="p">,</span> <span class="nx">id</span><span class="o">:</span> <span class="s2">&quot;mybutton&quot;</span><span class="p">,</span>
</span><span class='line'><span class="nx">getId</span><span class="o">:</span> <span class="kd">function</span><span class="p">,</span> <span class="nx">element</span><span class="o">:</span> <span class="nx">Class</span><span class="p">...}</span>
</span></code></pre></td></tr></table></div></figure>


<h4>Making References to DOM Nodes</h4>

<p>when you are creating custom components and plug-ins yourself, you might need to work with the DOM.</p>

<p><code>Note</code></p>

<p>Creating custom components or plug-ins in Sencha Touch is beyond the scope of this book. It’s an advanced technique that requires an understanding of the Sencha class system, DOM, and custom styling. If you are interested in custom components, take a look at the <a href="http://market.sencha.com/">Sencha Market</a>, where a lot of plug-in developers share their components and plug-ins for free.</p>

<p>Sencha提供了三种方式获取DOM</p>

<ul>
<li>Getting Sencha’s version of a DOM element.</li>
<li>Getting a collection of multiple direct DOM elements. * Getting the direct DOM node.
假设有以下代码</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">h2</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&quot;title&quot;</span><span class="o">&gt;</span><span class="nx">Taxi</span> <span class="nx">Amsterdam</span><span class="o">&lt;</span><span class="err">/h2&gt; </span>
</span><span class='line'><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&quot;description&quot;</span><span class="o">&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Taxi</span> <span class="nx">description</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span><span class='line'>      <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Taxi</span> <span class="nx">description2</span><span class="o">&lt;</span><span class="err">/p&gt; </span>
</span><span class='line'>  <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<h5>Exg.get()</h5>

<p>Ext.get(el) is the trick you use to retrieve the Ext.dom.Element, which is a kind of wrapper that encapsulates a DOM element, adding simple DOM manipulation facilities and normalizing for browser differences.
你可以传入以下三种形式</p>

<ul>
<li>An ID to the node<em> A DOM node</em> An existing Ext.Element
测试结果</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">title</span> <span class="o">=</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">);</span>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">title</span><span class="p">);</span>
</span><span class='line'><span class="c1">//result</span>
</span><span class='line'><span class="nx">Class</span> <span class="p">{</span><span class="nx">dom</span><span class="o">:</span> <span class="nx">h2</span><span class="err">#</span><span class="nx">title</span><span class="p">,</span> <span class="nx">id</span><span class="o">:</span> <span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="nx">self</span><span class="o">:</span> <span class="kd">function</span><span class="p">,</span>
</span><span class='line'><span class="nx">superclass</span><span class="o">:</span> <span class="nb">Object</span><span class="p">,</span> <span class="nx">defaultConfig</span><span class="o">:</span> <span class="nx">emptyFn</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>Note</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Ext</span><span class="p">.</span><span class="nx">get</span><span class="p">()</span> <span class="nx">is</span> <span class="nx">the</span> <span class="nx">shorthand</span> <span class="nx">notation</span> <span class="k">for</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">dom</span><span class="p">.</span><span class="nx">Element</span><span class="p">.</span><span class="nx">get</span><span class="p">().</span>
</span></code></pre></td></tr></table></div></figure>


<h5>Ext.select()</h5>

<p>选择多个DOM elements,我们可以用Ext.select(selector)
You can pass in a CSS-like selector (with an xtype, itemId, or CSS class), and it returns an Ext.dom.CompositeElementLite, which is a collection of DOM elements providing methods to filter members or to perform actions upon the whole set.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">pars</span> <span class="o">=</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;p&quot;</span><span class="p">);</span>
</span><span class='line'><span class="nx">Class</span> <span class="p">{</span><span class="nx">elements</span><span class="o">:</span> <span class="nb">Array</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nx">el</span><span class="o">:</span> <span class="nx">Class</span><span class="p">,</span> <span class="nx">self</span><span class="o">:</span> <span class="kd">function</span><span class="p">,</span> <span class="nx">superclass</span><span class="o">:</span> <span class="nb">Object</span><span class="p">,</span> <span class="nx">defaultConfig</span><span class="o">:</span> <span class="nx">emptyFn</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>获取第一个DOM Node</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">firstPar</span> <span class="o">=</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;p&quot;</span><span class="p">).</span><span class="nx">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nb">Number</span> <span class="nx">one</span> <span class="nx">taxi</span> <span class="k">in</span> <span class="nx">Amsterdam</span><span class="p">.</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>Note</code></p>

<p>在JS中,你用以下方法来获取一个tag name的所有DOM</p>

<figure class='code'><figcaption><span>var pars = document.getElementsByTagName(&#8216;p&#8217;);</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="err">```</span>
</span><span class='line'><span class="err">#####</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">getDom</span><span class="p">()</span>
</span><span class='line'><span class="nx">Finally</span><span class="p">,</span> <span class="nx">you</span> <span class="nx">can</span> <span class="nx">also</span> <span class="nx">request</span> <span class="nx">the</span> <span class="kc">true</span> <span class="nx">DOM</span> <span class="kd">with</span> <span class="nx">Ext</span> <span class="nx">JS</span> <span class="nx">by</span> <span class="nx">using</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">getDom</span><span class="p">(</span><span class="nx">el</span><span class="p">).</span>
</span><span class='line'><span class="nx">You</span> <span class="nx">can</span> <span class="nx">pass</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">following</span><span class="o">:</span>
</span><span class='line'>
</span><span class='line'><span class="o">*</span> <span class="nx">An</span> <span class="nx">ID</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">node</span>
</span><span class='line'><span class="o">*</span> <span class="nx">A</span> <span class="nx">DOM</span> <span class="nx">node</span>
</span><span class='line'><span class="o">*</span> <span class="nx">An</span> <span class="nx">existing</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">Element</span>
</span><span class='line'>
</span><span class='line'><span class="err">```</span><span class="nx">javascript</span>
</span><span class='line'>  <span class="o">&gt;</span> <span class="kd">var</span> <span class="nx">title</span> <span class="o">=</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">getDom</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nx">h2</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&quot;title&quot;</span><span class="o">&gt;</span><span class="nx">Taxi</span> <span class="nx">Amsterdam</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
</span><span class='line'><span class="err">```</span>
</span><span class='line'>
</span><span class='line'><span class="err">既然我们已经知道如何获取</span><span class="nx">DOM</span> <span class="nx">elements</span><span class="err">和</span><span class="nx">Sencha</span> <span class="nx">components</span><span class="p">,</span><span class="err">我们可以看看如何</span><span class="k">do</span> <span class="nx">something</span> <span class="kd">with</span> <span class="nx">these</span> <span class="nx">references</span>
</span><span class='line'>
</span><span class='line'><span class="err">#####</span> <span class="nx">Handling</span> <span class="nx">Events</span>
</span><span class='line'>
</span><span class='line'><span class="nx">Event</span> <span class="nx">handling</span> <span class="nx">is</span> <span class="nx">done</span> <span class="nx">via</span> <span class="nx">the</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">Observable</span> <span class="nx">mixin</span><span class="p">,</span><span class="nx">A</span> <span class="nx">mixin</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">technique</span> <span class="nx">to</span> <span class="nx">support</span> <span class="p">(</span><span class="nx">multiple</span><span class="p">)</span> <span class="nx">inheritance</span><span class="p">.(</span><span class="err">第四章将有介绍</span><span class="p">)</span><span class="nx">The</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">Component</span> <span class="kr">class</span> <span class="nx">uses</span> <span class="nx">the</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">Observable</span> <span class="nx">mixin</span><span class="p">,</span> <span class="nx">which</span> <span class="nx">means</span> <span class="nx">that</span> <span class="nx">all</span> <span class="nx">components</span> <span class="nx">are</span> <span class="nx">able</span> <span class="nx">to</span> <span class="nx">respond</span> <span class="nx">to</span> <span class="nx">events</span><span class="p">,</span> <span class="nx">because</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">Component</span> <span class="nx">is</span> <span class="nx">the</span> <span class="nx">base</span> <span class="kr">class</span> <span class="k">for</span> <span class="nx">every</span> <span class="nx">view</span> <span class="nx">component</span> <span class="k">in</span> <span class="nx">Sencha</span> <span class="nx">Touch</span><span class="p">.</span>
</span><span class='line'>
</span><span class='line'><span class="err">有三种类型的</span><span class="nx">events</span>
</span><span class='line'>
</span><span class='line'><span class="o">*</span> <span class="nx">System</span> <span class="nx">events</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">Events</span> <span class="nx">invoked</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">framework</span> <span class="err">—</span> <span class="k">for</span> <span class="nx">example</span><span class="p">,</span> <span class="nx">loading</span> <span class="nx">data</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">load</span> <span class="nx">event</span><span class="p">.</span>
</span><span class='line'><span class="o">*</span> <span class="nx">Lifecycle</span> <span class="nx">events</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">Events</span> <span class="nx">invoked</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">framework</span> <span class="nx">lifecycle</span> <span class="err">—</span> <span class="k">for</span> <span class="nx">example</span><span class="p">,</span> <span class="nx">painting</span> <span class="nx">a</span> <span class="nx">view</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">painted</span> <span class="nx">event</span><span class="p">.</span>
</span><span class='line'><span class="o">*</span> <span class="nx">User</span> <span class="nx">events</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">Events</span> <span class="nx">invoked</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">user</span> <span class="err">—</span> <span class="k">for</span> <span class="nx">example</span><span class="p">,</span> <span class="nx">a</span> <span class="nx">tap</span> <span class="nx">event</span><span class="p">.</span>
</span><span class='line'><span class="err">本节我们将关注</span><span class="nx">User</span> <span class="nx">events</span>
</span><span class='line'>
</span><span class='line'><span class="err">######</span> <span class="nx">Firing</span> <span class="nx">Events</span>
</span><span class='line'><span class="err">在原生的</span><span class="nx">JS</span><span class="err">代码中，如果你想监听一个</span><span class="nx">tap</span> <span class="nx">event</span>
</span></code></pre></td></tr></table></div></figure>


<p>javascript
function myEventHandler(ev) { //do something}element.addEventListener(&lsquo;touchend&rsquo;, myEventHandler);</p>

<figure class='code'><figcaption><span>var pars = document.getElementsByTagName(&#8216;p&#8217;);</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="err">在</span><span class="nx">Sencha</span> <span class="nx">Touch</span><span class="err">中，你可以按如下方式来定义</span>
</span></code></pre></td></tr></table></div></figure>


<p>javascript
listeners : {   tap: &lsquo;myEventHandler&rsquo;}</p>

<figure class='code'><figcaption><span>var pars = document.getElementsByTagName(&#8216;p&#8217;);</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="err">来看</span><span class="nx">Sench</span> <span class="nx">Touch</span><span class="err">中的</span><span class="mi">3</span><span class="err">种监听方式</span>
</span><span class='line'>
</span><span class='line'><span class="o">*</span> <span class="nx">listeners</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">the</span> <span class="nx">listeners</span> <span class="nx">configuration</span> <span class="nx">directly</span> <span class="nx">into</span> <span class="nx">the</span> <span class="nx">component</span> <span class="kr">class</span><span class="o">:</span>
</span></code></pre></td></tr></table></div></figure>


<p>javascript
Ext.define(&lsquo;BookTaxiBtn&rsquo;, {</p>

<pre><code>extend: 'Ext.Button', 
xtype: 'booktaxibtn', 
config: {       text: 'Book a Taxi - listeners', margin: 5,     listeners: {            tap: 'bookTaxiEventHandler'         },  },  bookTaxiEventHandler: function(b){      console.log('You tapped the ' + b.getText() + 'button');    }});
</code></pre>

<figure class='code'><figcaption><span>var pars = document.getElementsByTagName(&#8216;p&#8217;);</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">*</span> <span class="nx">handler</span>
</span></code></pre></td></tr></table></div></figure>


<p>javascript</p>

<pre><code>var callTaxiBtn1 = Ext.create('Ext.Button', { 
    text: '1: Call a Taxi - handler',       margin: 5,      handler: callTaxiEventHandler   });```
</code></pre>

<ul>
<li>addListener()
<code>javascript
var callTaxiBtn2 = Ext.create('Ext.Button', {
  margin: 5,  text: '2: Call a Taxi - addListener' });
callTaxiBtn2.addListener('tap', callTaxiEventHandler);</code>
Here we use the short version of the addListener() method: the on() method. It takesthe event name and the function-to-execute name as arguments:
<code>javascript
var callTaxiBtn3 = Ext.create('Ext.Button', {
  margin: 5,  text: '3: Call a Taxi - on' });callTaxiBtn3.on('tap', callTaxiEventHandler);</code>
You’ll just need to wrap each button in an Ext.application.launch() method:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Ext</span><span class="p">.</span><span class="nx">application</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Events&#39;</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">requires</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;BookTaxiBtn&#39;</span><span class="p">],</span>
</span><span class='line'>      <span class="nx">launch</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">callTaxiEventHandler</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;You tapped the &#39;</span> <span class="o">+</span> <span class="nx">b</span><span class="p">.</span><span class="nx">getText</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;button&#39;</span><span class="p">);</span>
</span><span class='line'>          <span class="p">};</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">callTaxiBtn1</span> <span class="o">=</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">&#39;Ext.Button&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;1: Call a Taxi - handler&#39;</span><span class="p">,</span>
</span><span class='line'>              <span class="nx">margin</span><span class="o">:</span> <span class="mi">5</span><span class="p">,</span>
</span><span class='line'>              <span class="nx">handler</span><span class="o">:</span> <span class="nx">callTaxiEventHandler</span>
</span><span class='line'>          <span class="p">});</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">callTaxiBtn2</span> <span class="o">=</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">&#39;Ext.Button&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">margin</span><span class="o">:</span> <span class="mi">5</span><span class="p">,</span>
</span><span class='line'>              <span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;2: Call a Taxi - addListener&#39;</span>
</span><span class='line'>          <span class="p">});</span>
</span><span class='line'>          <span class="nx">callTaxiBtn2</span><span class="p">.</span><span class="nx">addListener</span><span class="p">(</span><span class="s1">&#39;tap&#39;</span><span class="p">,</span> <span class="nx">callTaxiEventHandler</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">callTaxiBtn3</span> <span class="o">=</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">&#39;Ext.Button&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">margin</span><span class="o">:</span> <span class="mi">5</span><span class="p">,</span>
</span><span class='line'>              <span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;3: Call a Taxi - on&#39;</span>
</span><span class='line'>          <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>          <span class="nx">callTaxiBtn3</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;tap&#39;</span><span class="p">,</span> <span class="nx">callTaxiEventHandler</span><span class="p">);</span>
</span><span class='line'>          <span class="c1">//Display the buttons, for testing purposes</span>
</span><span class='line'>          <span class="nx">Ext</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">&#39;Ext.Container&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">fullscreen</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">padding</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">items</span><span class="o">:</span> <span class="p">[</span>
</span><span class='line'>              <span class="nx">callTaxiBtn1</span><span class="p">,</span>
</span><span class='line'>              <span class="nx">callTaxiBtn2</span><span class="p">,</span>
</span><span class='line'>              <span class="nx">callTaxiBtn3</span><span class="p">,</span>
</span><span class='line'>              <span class="p">{</span> <span class="nx">xtype</span><span class="o">:</span> <span class="s1">&#39;booktaxibtn&#39;</span><span class="p">}</span>
</span><span class='line'>          <span class="p">]</span>
</span><span class='line'>          <span class="p">});</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<h6>Removing Events</h6>

<p>To remove a listener, you need a reference to its function. In case you want to remove event listeners, it’s a good practice to not write event-handler function bodies inline in the code. You should always assign functions to a variable;otherwise, it will be hard to reference the function to remove(from outside the function body).
原生的JS，可以按以下方式来removeEventListener</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">element</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s1">&#39;touchend&#39;</span><span class="p">,</span><span class="nx">myEventHandler</span><span class="p">,</span><span class="kc">false</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>To remove an event listener, use the removeListener() method, pass in the event name you want to remove</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">button</span><span class="p">.</span><span class="nx">removeListener</span><span class="p">(</span><span class="s1">&#39;tap&#39;</span><span class="p">,</span> <span class="nx">myEventHandler</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>以下为完整演示demo</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Ext</span><span class="p">.</span><span class="nx">application</span><span class="p">({</span> <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Events&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">launch</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">callTaxiEventHandler</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;You tapped the &#39;</span> <span class="o">+</span> <span class="nx">b</span><span class="p">.</span><span class="nx">getText</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;button&#39;</span><span class="p">);</span>
</span><span class='line'>          <span class="k">this</span><span class="p">.</span><span class="nx">removeListener</span><span class="p">(</span><span class="s1">&#39;tap&#39;</span><span class="p">,</span> <span class="nx">callTaxiEventHandler</span><span class="p">);</span>
</span><span class='line'>          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;From now on, you can not call again.&#39;</span><span class="p">);</span>
</span><span class='line'>      <span class="p">};</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">callTaxi</span> <span class="o">=</span> <span class="nx">Ext</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">&#39;Ext.Button&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;Call the Taxi&#39;</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">margin</span><span class="o">:</span> <span class="mi">5</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">listeners</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>              <span class="nx">tap</span><span class="o">:</span> <span class="nx">callTaxiEventHandler</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>      <span class="p">});</span>
</span><span class='line'>      <span class="c1">//just for testing purposes</span>
</span><span class='line'>      <span class="nx">Ext</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">&#39;Ext.Container&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">fullscreen</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">padding</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
</span><span class='line'>          <span class="nx">items</span><span class="o">:</span> <span class="p">[</span><span class="nx">callTaxi</span><span class="p">]</span>
</span><span class='line'>      <span class="p">});</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>Note</code></p>

<p>Just as the on() method is a shorthand version for addListener(), there is a shorthand version for the removeListener() function un(). So, instead of:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">button</span><span class="p">.</span><span class="nx">removeListener</span><span class="p">(</span><span class="s1">&#39;tap&#39;</span><span class="p">,</span> <span class="nx">myEventHandler</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>you can use:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">button</span><span class="p">.</span><span class="nx">un</span><span class="p">(</span><span class="s1">&#39;tap&#39;</span><span class="p">,</span> <span class="nx">myEventHandler</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<h6>Firing Custom Events</h6>

<p>监听模式</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">listeners</span> <span class="o">:</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">tap</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
</span><span class='line'>      <span class="k">this</span><span class="p">.</span><span class="nx">up</span><span class="p">(</span><span class="s1">&#39;taxiview&#39;</span><span class="p">).</span><span class="nx">fireEvent</span><span class="p">(</span><span class="s1">&#39;calltaxi&#39;</span><span class="p">,</span> <span class="nx">e</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The controller listens to the custom calltaxi event:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Ext</span><span class="p">.</span><span class="nx">define</span><span class="p">(</span><span class="s1">&#39;TaxiController&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">extend</span><span class="o">:</span> <span class="s1">&#39;Ext.app.Controller&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="nx">config</span><span class="o">:</span> <span class="p">{</span> <span class="nx">control</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>      <span class="s1">&#39;taxiview&#39;</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">calltaxi</span><span class="o">:</span> <span class="s1">&#39;onCallTaxi&#39;</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'>  <span class="nx">onCallTaxi</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Call the Taxi&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>

</div>

</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>





  <section>
    <h1>Comments</h1>
    <div id="comments" aria-live="polite"><!-- Duoshuo Comment BEGIN -->
<div class="ds-thread"></div>
<script type="text/javascript">
  var duoshuoQuery = {short_name:"allentofight"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = 'http://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script>
<!-- Duoshuo Comment END --></div>
  </section>
</div>
			</div>
			<footer id="footer" class="inner"><p>
  Copyright &copy; 2014 - AllenToFight -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

Design credit: <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a></footer>
			<script src="/javascripts/slash.js"></script>
	

<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->







		</div>
	</div>
</body>
</html>
