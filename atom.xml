<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[AllenToFight Blog]]></title>
  <link href="http://xiekunRonaldo.github.io/atom.xml" rel="self"/>
  <link href="http://xiekunRonaldo.github.io/"/>
  <updated>2014-08-17T10:58:56+08:00</updated>
  <id>http://xiekunRonaldo.github.io/</id>
  <author>
    <name><![CDATA[AllenToFight]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Swift]]></title>
    <link href="http://xiekunRonaldo.github.io/blog/2014/08/12/swift/"/>
    <updated>2014-08-12T21:29:29+08:00</updated>
    <id>http://xiekunRonaldo.github.io/blog/2014/08/12/swift</id>
    <content type="html"><![CDATA[<h4>å˜é‡å®šä¹‰</h4>

<p>å¸¸é‡ç”¨let,å˜é‡ç”¨var</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var myVariable = 42
</span><span class='line'>myVariable = 50
</span><span class='line'>let myConstant = 42
</span><span class='line'>let explicitDouble: Double = 70
</span></code></pre></td></tr></table></div></figure>


<p>å˜é‡çš„å€¼ä¸ä¼šè‡ªåŠ¨è½¬åŒ–ä¸ºå…¶ä»–ç±»å‹çš„</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let label = "The width is "
</span><span class='line'>let width = 94
</span><span class='line'>let widthLabel = label+String(width)</span></code></pre></td></tr></table></div></figure>


<p>Stringå†…çš„å€¼æ›¿æ¢</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let apples = 3
</span><span class='line'>let oranges = 5
</span><span class='line'>let appleSummary = "I have \(apples) apples.â€</span></code></pre></td></tr></table></div></figure>


<p>æ•°ç»„å’Œå­—å…¸</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var shoppingList = ["catfish", "water", "tulips", "blue paint"]
</span><span class='line'>
</span><span class='line'>shoppingList[1] = "bottle of water"
</span><span class='line'> 
</span><span class='line'>var occupations = [
</span><span class='line'>
</span><span class='line'>    "Malcolm": "Captain",
</span><span class='line'>
</span><span class='line'>    "Kaylee": "Mechanic",
</span><span class='line'>]
</span><span class='line'>occupations["Jayne"] = "Public Relationsâ€
</span><span class='line'>
</span><span class='line'>let emptyArray = String[]()
</span><span class='line'>let emptyDictionary = Dictionary&lt;String, Float&gt;()
</span></code></pre></td></tr></table></div></figure>


<p>å¦‚æœç±»å‹æ˜¯èƒ½æ¨æ–­çš„ï¼Œå¯ä»¥ç”¨[]åˆ›å»ºä¸€ä¸ªç©ºæ•°ç»„ï¼Œç”¨[:]åˆ›å»ºä¸€ä¸ªç©ºå­—å…¸</p>

<h4>æ¡ä»¶è¯­å¥</h4>

<p>if&hellip;else&hellip;</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let individualScores = [75, 43, 103, 87, 12]
</span><span class='line'>var teamScore = 0
</span><span class='line'>for score in individualScores {
</span><span class='line'>    if score &gt; 50 {
</span><span class='line'>        teamScore += 3
</span><span class='line'>    } else {
</span><span class='line'>        teamScore += 1
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>teamScore</span></code></pre></td></tr></table></div></figure>


<p>æ³¨æ„ï¼Œåœ¨ifæ¡ä»¶è¯­å¥ä¸­ï¼Œconditionå¿…é¡»æ˜¯boolè¡¨è¾¾å¼ï¼Œæ‰€ä»¥ç±»ä¼¼<code>if score {...}</code>è¿™æ ·çš„ä»£ç æ˜¯é”™è¯¯çš„
ifå’Œoptional valueç»„æˆçš„æ¡ä»¶è¡¨è¾¾å¼</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var optionalString: String? = "Hello"
</span><span class='line'>optionalString == nil
</span><span class='line'> 
</span><span class='line'>var optionalName: String? = "John Appleseed"
</span><span class='line'>var greeting = "Hello!"
</span><span class='line'>if let name = optionalName {
</span><span class='line'>    greeting = "Hello, \(name)"
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>switchå’Œcaseè¯­å¥æ”¯æŒå¤šç§ç±»å‹çš„æ¯”è¾ƒ,ä¸é™äºinteger</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let vegetable = "red pepper"
</span><span class='line'>switch vegetable {
</span><span class='line'>case "celery":
</span><span class='line'>    let vegetableComment = "Add some raisins and make ants on a log."
</span><span class='line'>case "cucumber", "watercress":
</span><span class='line'>    let vegetableComment = "That would make a good tea sandwich."
</span><span class='line'>case let x where x.hasSuffix("pepper"):
</span><span class='line'>    let vegetableComment = "Is it a spicy \(x)?"
</span><span class='line'>default:
</span><span class='line'>    let vegetableComment = "Everything tastes good in soup."
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>æ³¨æ„:æ‰§è¡Œå®Œcaseè¯­å¥ï¼Œç¨‹åºå°±ä»switchè¯­å¥é‡Œç»ˆæ­¢äº†ï¼Œæ‰€ä»¥æ— éœ€break!</p>

<p>éå†dictionary</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let interestingNumbers = [
</span><span class='line'>    "Prime": [2, 3, 5, 7, 11, 13],
</span><span class='line'>    "Fibonacci": [1, 1, 2, 3, 5, 8],
</span><span class='line'>    "Square": [1, 4, 9, 16, 25],
</span><span class='line'>]
</span><span class='line'>var largest = 0
</span><span class='line'>for (kind, numbers) in interestingNumbers {
</span><span class='line'>    for number in numbers {
</span><span class='line'>        if number &gt; largest {
</span><span class='line'>            largest = number
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>largest</span></code></pre></td></tr></table></div></figure>


<p>whileè¯­å¥</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var n = 2
</span><span class='line'>while n &lt; 100 {
</span><span class='line'>    n = n * 2
</span><span class='line'>}
</span><span class='line'>n
</span><span class='line'> 
</span><span class='line'>var m = 2
</span><span class='line'>do {
</span><span class='line'>    m = m * 2
</span><span class='line'>} while m &lt; 100
</span><span class='line'>m</span></code></pre></td></tr></table></div></figure>


<p><code>..</code>çš„å¦™ç”¨,ä»¥ä¸‹ä¸¤ä¸ªå¾ªç¯æ˜¯ç­‰ä»·çš„</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var firstForLoop = 0
</span><span class='line'>for i in 0..3 {
</span><span class='line'>    firstForLoop += i
</span><span class='line'>}
</span><span class='line'>firstForLoop
</span><span class='line'> 
</span><span class='line'>var secondForLoop = 0
</span><span class='line'>for var i = 0; i &lt; 3; ++i {
</span><span class='line'>    secondForLoop += 1
</span><span class='line'>}
</span><span class='line'>secondForLoop</span></code></pre></td></tr></table></div></figure>


<h4>å‡½æ•°å’Œé—­åŒ…</h4>

<p>å‡½æ•°çš„å£°æ˜
ç”¨->å°†å‚æ•°ä¸è¿”å›å€¼åŒºåˆ†å¼€æ¥</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func greet(name: String, day: String) -&gt; String {
</span><span class='line'>    return "Hello \(name), today is \(day)."
</span><span class='line'>}
</span><span class='line'>greet("Bob", "Tuesday")</span></code></pre></td></tr></table></div></figure>


<p>ç”¨tupleä»å‡½æ•°ä¸­è¿”å›å¤šä¸ªå€¼</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func getGasPrices() -&gt; (Double, Double, Double) {
</span><span class='line'>    return (3.59, 3.69, 3.79)
</span><span class='line'>}
</span><span class='line'>getGasPrices()</span></code></pre></td></tr></table></div></figure>


<p>å‡½æ•°ä¹Ÿèƒ½æ¥æ”¶ä¸å®šæ•°é‡çš„å‚æ•°ï¼Œå°†å®ƒä»¬å°æˆåˆ°ä¸€ä¸ªæ•°ç»„é‡Œ</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func sumOf(numbers: Int...) -&gt; Int {
</span><span class='line'>    var sum = 0
</span><span class='line'>    for number in numbers {
</span><span class='line'>        sum += number
</span><span class='line'>    }
</span><span class='line'>    return sum
</span><span class='line'>}
</span><span class='line'>sumOf()
</span><span class='line'>sumOf(42, 597, 12)</span></code></pre></td></tr></table></div></figure>


<p>å‡½æ•°ä¹Ÿèƒ½åµŒå¥—ï¼Œå†…åµŒçš„å‡½æ•°èƒ½è®¿é—®å£°æ˜åœ¨å¤–éƒ¨å‡½æ•°çš„å˜é‡</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func returnFifteen() -&gt; Int {
</span><span class='line'>    var y = 10
</span><span class='line'>    func add() {
</span><span class='line'>        y += 5
</span><span class='line'>    }
</span><span class='line'>    add()
</span><span class='line'>    return y
</span><span class='line'>}
</span><span class='line'>returnFifteen()</span></code></pre></td></tr></table></div></figure>


<p>å‡½æ•°æ˜¯first-classç±»å‹ï¼Œè¿™æ„å‘³ç€å‡½æ•°ä¹Ÿèƒ½è¿”å›å¦ä¸€ä¸ªå‡½æ•°</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func makeIncrementer() -&gt; (Int -&gt; Int) {
</span><span class='line'>    func addOne(number: Int) -&gt; Int {
</span><span class='line'>        return 1 + number
</span><span class='line'>    }
</span><span class='line'>    return addOne
</span><span class='line'>}
</span><span class='line'>var increment = makeIncrementer()
</span><span class='line'>increment(7)</span></code></pre></td></tr></table></div></figure>


<p>å‡½æ•°çš„å‚æ•°ä¹Ÿèƒ½æ˜¯å‡½æ•°</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func hasAnyMatches(list: Int[], condition: Int -&gt; Bool) -&gt; Bool {
</span><span class='line'>    for item in list {
</span><span class='line'>        if condition(item) {
</span><span class='line'>            return true
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>    return false
</span><span class='line'>}
</span><span class='line'>func lessThanTen(number: Int) -&gt; Bool {
</span><span class='line'>    return number &lt; 10
</span><span class='line'>}
</span><span class='line'>var numbers = [20, 19, 7, 12]
</span><span class='line'>hasAnyMatches(numbers, lessThanTen)</span></code></pre></td></tr></table></div></figure>


<p>å‡½æ•°å®é™…ä¸Šæ˜¯é—­åŒ…çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨{}æ¥å†™ä¸€ä¸ªåŒ¿åçš„é—­åŒ…,ç”¨inæ¥å°†å‚æ•°å’Œè¿”å›ç±»å‹åŒºåˆ†å¼€æ¥</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>numbers.map({
</span><span class='line'>    (number: Int) -&gt; Int in
</span><span class='line'>    let result = 3 * number
</span><span class='line'>    return result
</span><span class='line'>    })</span></code></pre></td></tr></table></div></figure>


<p>å¦‚æœä¸€ä¸ªclosureçš„ç±»å‹æ˜¯å·²çŸ¥çš„ï¼Œæ¯”å¦‚å·²çŸ¥ä¸€ä¸ªdelegateçš„å›è°ƒï¼Œæˆ‘ä»¬å¯ä»¥çœç•¥å‚æ•°çš„ç±»å‹ï¼Œè¿”å›ç±»å‹æˆ–ä¸¤è€…éƒ½çœç•¥,ä»¥ä¸Šå¯ä»¥æ”¹å†™æˆä»¥ä¸‹</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>numbers.map({ number in 3 * number })</span></code></pre></td></tr></table></div></figure>


<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æ•°å­—è€Œä¸æ˜¯åå­—æ¥è¡¨ç¤ºå‚æ•°</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sort([1, 5, 3, 12, 2]) { $0 &gt; $1 }</span></code></pre></td></tr></table></div></figure>


<h4>å¯¹è±¡å’Œç±»</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class Shape {
</span><span class='line'>    var numberOfSides = 0
</span><span class='line'>    func simpleDescription() -&gt; String {
</span><span class='line'>        return "A shape with \(numberOfSides) sides."
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>var shape = Shape()
</span><span class='line'>shape.numberOfSides = 7
</span><span class='line'>var shapeDescription = shape.simpleDescription()</span></code></pre></td></tr></table></div></figure>


<p><code>init</code>çš„ä½¿ç”¨</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class NamedShape {
</span><span class='line'>    var numberOfSides: Int = 0
</span><span class='line'>    var name: String
</span><span class='line'>    
</span><span class='line'>    init(name: String) {
</span><span class='line'>        self.name = name
</span><span class='line'>    }
</span><span class='line'>    
</span><span class='line'>    func simpleDescription() -&gt; String {
</span><span class='line'>        return "A shape with \(numberOfSides) sides."
</span><span class='line'>    }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>æ¯ä¸€ä¸ªpropertyéƒ½éœ€è¦èµ‹å€¼ï¼Œå¯ä»¥åœ¨å®ƒå£°æ˜çš„æ—¶å€™(å¦‚numberOfSlides)ä¹Ÿå¯ä»¥åœ¨initializeré‡Œ(å¦‚name)
å®šä¹‰deinitæ¥åˆ›å»ºä¸€ä¸ªdeinitializerå¦‚æœä½ éœ€è¦åœ¨å¯¹è±¡è¢«é‡Šæ”¾å‰åšä¸€äº›æ¸…ç†å·¥ä½œçš„è¯
ç»§æ‰¿æ—¶ï¼Œå¦‚æœè¦é‡å†™superclassçš„æ–¹æ³•ï¼Œå¿…é¡»è¦åœ¨é‡å†™çš„æ–¹æ³•å‰åŠ override</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class Square: NamedShape {
</span><span class='line'>    var sideLength: Double
</span><span class='line'>    
</span><span class='line'>    init(sideLength: Double, name: String) {
</span><span class='line'>        self.sideLength = sideLength
</span><span class='line'>        super.init(name: name)
</span><span class='line'>        numberOfSides = 4
</span><span class='line'>    }
</span><span class='line'>    
</span><span class='line'>    func area() -&gt;  Double {
</span><span class='line'>        return sideLength * sideLength
</span><span class='line'>    }
</span><span class='line'>    
</span><span class='line'>    override func simpleDescription() -&gt; String {
</span><span class='line'>        return "A square with sides of length \(sideLength)."
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>let test = Square(sideLength: 5.2, name: "my test square")
</span><span class='line'>test.area()
</span><span class='line'>test.simpleDescription()</span></code></pre></td></tr></table></div></figure>


<p>ä¸ºpropertyå®šä¹‰getterå’Œsetter</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class EquilateralTriangle: NamedShape {
</span><span class='line'>    var sideLength: Double = 0.0
</span><span class='line'>    
</span><span class='line'>    init(sideLength: Double, name: String) {
</span><span class='line'>        self.sideLength = sideLength
</span><span class='line'>        super.init(name: name)
</span><span class='line'>        numberOfSides = 3
</span><span class='line'>    }
</span><span class='line'>    
</span><span class='line'>    var perimeter: Double {
</span><span class='line'>    get {
</span><span class='line'>        return 3.0 * sideLength
</span><span class='line'>    }
</span><span class='line'>    set {
</span><span class='line'>        sideLength = newValue / 3.0
</span><span class='line'>    }
</span><span class='line'> }
</span><span class='line'> 
</span><span class='line'> override func simpleDescription() -&gt; String {
</span><span class='line'>          return "An equilateral triagle with sides of length \(sideLength)."
</span><span class='line'>      }
</span><span class='line'> }
</span><span class='line'>var triangle = EquilateralTriangle(sideLength: 3.1, name: "a triangle")
</span><span class='line'>triangle.perimeter
</span><span class='line'>triangle.perimeter = 9.9
</span><span class='line'>triangle.sideLength</span></code></pre></td></tr></table></div></figure>


<p>åœ¨perimeterçš„setteræ–¹æ³•ä¸­ï¼Œæ–°å€¼æœ‰ä¸€ä¸ªé»˜è®¤çš„åå­—newValue,æˆ‘ä»¬å¯ä»¥åœ¨setåçš„æ‹¬å·é‡Œä¸ºè¿™ä¸ªå€¼æŒ‡å®šä¸€ä¸ªåå­—
å¦‚æœä½ æ— éœ€è®¡ç®—propertyçš„å€¼ï¼Œä½†éœ€è¦åœ¨è®¾ç½®æ–°å€¼çš„å‰ååšä¸€äº›æ“ä½œï¼Œå¯ä»¥ç”¨<code>willSet</code>å’Œ<code>didSet</code>,æ¯”å¦‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class TriangleAndSquare {
</span><span class='line'>    var triangle: EquilateralTriangle {
</span><span class='line'>      willSet {
</span><span class='line'>          square.sideLength = newValue.sideLength
</span><span class='line'>      }
</span><span class='line'>    }
</span><span class='line'>    var square: Square {
</span><span class='line'>      willSet {
</span><span class='line'>          triangle.sideLength = newValue.sideLength
</span><span class='line'>      }
</span><span class='line'>    }
</span><span class='line'>    init(size: Double, name: String) {
</span><span class='line'>        square = Square(sideLength: size, name: name)
</span><span class='line'>        triangle = EquilateralTriangle(sideLength: size, name: name)
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>var triangleAndSquare = TriangleAndSquare(size: 10, name: "another test shape")
</span><span class='line'>triangleAndSquare.square.sideLength
</span><span class='line'>triangleAndSquare.triangle.sideLength
</span><span class='line'>triangleAndSquare.square = Square(sideLength: 50, name: "larger square")
</span><span class='line'>triangleAndSquare.triangle.sideLength</span></code></pre></td></tr></table></div></figure>


<p>ç±»æ–¹æ³•ä¸å‡½æ•°æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„åŒºåˆ«ï¼Œç±»æ–¹æ³•é‡Œå¯ä»¥ä¸ºå‚æ•°æŒ‡å®šä¸€ä¸ªåˆ«å,è€Œå‡½æ•°ä¸è¡Œï¼Œå¦‚ä¸‹</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class Counter {
</span><span class='line'>    var count: Int = 0
</span><span class='line'>    func incrementBy(amount: Int, numberOfTimes times: Int) {
</span><span class='line'>        count += amount * times
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>var counter = Counter()
</span><span class='line'>counter.incrementBy(2, numberOfTimes: 7)</span></code></pre></td></tr></table></div></figure>


<p>å½“ä¸optional valueså·¥ä½œæ—¶ï¼Œä½ å¯ä»¥åœ¨æœ‰å…³æ–¹æ³•ï¼Œå±æ€§å’Œ[]æ“ä½œå‰å†™ä¸€ä¸ª<code>?</code>å¦‚æœåœ¨?å‰çš„å€¼ä¸ºnil,åˆ™ä¸€åˆ‡åœ¨ï¼Ÿåçš„æ“ä½œéƒ½è¢«å¿½ç•¥äº†ï¼Œæ•´ä¸ªè¡¨è¾¾å¼çš„å€¼ä¹Ÿå°±æ˜¯niläº†ï¼Œå¦åˆ™optional value unwrapped,æ‰€æœ‰?åè¡¨è¾¾å¼å¯¹åº”çš„å€¼ä¸ºoptional value,æ— è®ºå¦‚ä½•ï¼Œæ•´ä¸ªè¡¨è¾¾å¼çš„å€¼éƒ½æ˜¯optional value</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let optionalSquare: Square? = Square(sideLength: 2.5, name: "optional square")
</span><span class='line'>let sideLength = optionalSquare?.sideLength</span></code></pre></td></tr></table></div></figure>


<h4>Enumerations and Structures</h4>

<p>åƒç±»å’Œå…¶ä»–ç±»å‹ä¸€æ ·,enumerationså¯ä»¥æœ‰æ–¹æ³•</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>enum Rank: Int {
</span><span class='line'>    case Ace = 1  //ä¹Ÿå¯ä»¥ç”¨å­—ç¬¦ä¸²æˆ–ç¬¦ç‚¹å‹æ¥æŒ‡å®šæšä¸¾çš„ç±»å‹
</span><span class='line'>    case Two, Three, Four, Five, Six, Seven, Eight, Nine, Ten
</span><span class='line'>    case Jack, Queen, King
</span><span class='line'>    func simpleDescription() -&gt; String {
</span><span class='line'>        switch self {
</span><span class='line'>        case .Ace:
</span><span class='line'>            return "ace"
</span><span class='line'>        case .Jack:
</span><span class='line'>            return "jack"
</span><span class='line'>        case .Queen:
</span><span class='line'>            return "queen"
</span><span class='line'>        case .King:
</span><span class='line'>            return "king"
</span><span class='line'>        default:
</span><span class='line'>            return String(self.toRaw())
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>let ace = Rank.Ace
</span><span class='line'>let aceRawValue = ace.toRaw() //1</span></code></pre></td></tr></table></div></figure>


<p>ç”¨<code>toRaw</code>å’Œ<code>fromRaw</code>å‡½æ•°æ¥å¯¹raw valueå’Œæšä¸¾å€¼è¿›è¡Œç›¸äº’è½¬æ¢</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>if let convertedRank = Rank.fromRaw(3) {
</span><span class='line'>    let threeDescription = convertedRank.simpleDescription()
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>The member values of an enumeration are actual values, not just another way of writing their raw values.å¦‚æœæ²¡æœ‰ä¸€ä¸ªæœ‰æ„ä¹‰çš„raw valueï¼Œä½ ä¸éœ€è¦å†æŒ‡å®šå®ƒ</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>enum Suit {
</span><span class='line'>    case Spades, Hearts, Diamonds, Clubs
</span><span class='line'>    func simpleDescription() -&gt; String {
</span><span class='line'>        switch self {
</span><span class='line'>        case .Spades:
</span><span class='line'>            return "spades"
</span><span class='line'>        case .Hearts:
</span><span class='line'>            return "hearts"
</span><span class='line'>        case .Diamonds:
</span><span class='line'>            return "diamonds"
</span><span class='line'>        case .Clubs:
</span><span class='line'>            return "clubs"
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>let hearts = Suit.Hearts
</span><span class='line'>let heartsDescription = hearts.simpleDescription()</span></code></pre></td></tr></table></div></figure>


<p>ç”¨structæ¥åˆ›å»ºä¸€ä¸ªç»“æ„,structæ”¯æŒç±»çš„å¾ˆå¤šæ–¹é¢ï¼Œå¦‚æ–¹æ³•å’Œåˆå§‹åŒ–ï¼Œå’Œç±»çš„æœ€å¤§åŒºåˆ«æ˜¯structuresæ€»é‡ä»¥copyçš„å½¢å¼ä¼ é€’ï¼Œè€Œclassåˆ™ä»¥å¼•ç”¨çš„å½¢å¼ä¼ é€’</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>struct Card {
</span><span class='line'>    var rank: Rank
</span><span class='line'>    var suit: Suit
</span><span class='line'>    func simpleDescription() -&gt; String {
</span><span class='line'>        return "The \(rank.simpleDescription()) of \(suit.simpleDescription())"
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>let threeOfSpades = Card(rank: .Three, suit: .Spades)
</span><span class='line'>let threeOfSpadesDescription = threeOfSpades.simpleDescription()</span></code></pre></td></tr></table></div></figure>


<p>Instances of the same enumeration member can have different values associated with them.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>enum ServerResponse {
</span><span class='line'>    case Result(String, String)
</span><span class='line'>    case Error(String)
</span><span class='line'>}
</span><span class='line'> 
</span><span class='line'>let success = ServerResponse.Result("6:00 am", "8:09 pm")
</span><span class='line'>let failure = ServerResponse.Error("Out of cheese.")
</span><span class='line'> 
</span><span class='line'>switch success {
</span><span class='line'>case let .Result(sunrise, sunset):
</span><span class='line'>    let serverResponse = "Sunrise is at \(sunrise) and sunset is at \(sunset)."
</span><span class='line'>case let .Error(error):
</span><span class='line'>    let serverResponse = "Failure...  \(error)"
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>æ³¨æ„sunriseå’Œsunsetå¦‚ä½•åŒ¹é…switchä¸­caseçš„æ¡ä»¶è€Œä»ServerResponseé‡Œå€¼å–å‡ºæ¥çš„</p>

<h4>åè®®å’ŒExtensions</h4>

<p>ç”¨<code>protocol</code>æ¥å£°æ˜ä¸€ä¸ªåè®®</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>protocol ExampleProtocol {
</span><span class='line'>    var simpleDescription: String { get }
</span><span class='line'>    mutating func adjust()
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>class SimpleClass: ExampleProtocol {
</span><span class='line'>    var simpleDescription: String = "A very simple class."
</span><span class='line'>    var anotherProperty: Int = 69105
</span><span class='line'>    func adjust() {
</span><span class='line'>        simpleDescription += "  Now 100% adjusted."
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>var a = SimpleClass()
</span><span class='line'>a.adjust()
</span><span class='line'>let aDescription = a.simpleDescription
</span><span class='line'> 
</span><span class='line'>struct SimpleStructure: ExampleProtocol {
</span><span class='line'>    var simpleDescription: String = "A simple structure"
</span><span class='line'>    mutating func adjust() {
</span><span class='line'>        simpleDescription += " (adjusted)"
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>var b = SimpleStructure()
</span><span class='line'>b.adjust()
</span><span class='line'>let bDescription = b.simpleDescription</span></code></pre></td></tr></table></div></figure>


<p>æ³¨æ„åœ¨structä¸­mutatingçš„ä½¿ç”¨,classä¸­çš„æ–¹æ³•æ— éœ€æ ‡è®°ä¸ºmutating,å› ä¸ºç±»ä¸­çš„æ–¹æ³•æ€»æ˜¯å¯ä»¥æ”¹å˜ç±»çš„
ç”¨extensionsæ¥ä¸ºä¸€ä¸ªå·²çŸ¥çš„ç±»å‹æ·»åŠ åŠŸèƒ½ï¼Œæ¯”å¦‚æ–°çš„æ–¹æ³•å’Œcomputed properties</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>extension Int: ExampleProtocol {
</span><span class='line'>    var simpleDescription: String {
</span><span class='line'>    return "The number \(self)"
</span><span class='line'>    }
</span><span class='line'>    mutating func adjust() {
</span><span class='line'>        self += 42
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>7.simpleDescription</span></code></pre></td></tr></table></div></figure>


<p>You can use an extension to add protocol conformance to a type that is declared elsewhere, or even to a type that you imported from a library or framework.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let protocolValue: ExampleProtocol = a
</span><span class='line'>protocolValue.simpleDescription
</span><span class='line'>// protocolValue.anotherProperty  // Uncomment to see the errorâ€</span></code></pre></td></tr></table></div></figure>


<p>å°½ç®¡protocolValueæœ‰ä¸€ä¸ªè¿è¡Œæ—¶çš„ç±»å‹SimpleClass,ä½†ç¼–è¯‘å™¨ä»æŠŠå®ƒå½“ä½œExampleProtocolçš„ä¸€ç§ç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´è¯´äº†å®šä¹‰æ—¶åè®®å¯¹åº”çš„æ–¹æ³•ï¼Œä½ ä¸èƒ½è°ƒç”¨å®ƒå®é™…æ‰€å±ç±»çš„æ–¹æ³•ï¼Œå±æ€§</p>

<h4>Generics</h4>

<p>åœ¨å°–æ‹¬å·é‡Œå†™ä¸€ä¸ªåå­—æ¥åˆ›å»ºä¸€ä¸ªgenericå‡½æ•°æˆ–ç±»å‹</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func repeat&lt;ItemType&gt;(item: ItemType, times: Int) -&gt; ItemType[] {
</span><span class='line'>    var result = ItemType[]()
</span><span class='line'>    for i in 0..times {
</span><span class='line'>        result += item
</span><span class='line'>    }
</span><span class='line'>    return result
</span><span class='line'>}
</span><span class='line'>repeat("knock", 4)</span></code></pre></td></tr></table></div></figure>


<p>æˆ‘ä»¬æ—¢å¯ä»¥å°†è¿™ç§å½¢å¼ç”¨åœ¨å‡½æ•°å’Œæ–¹æ³•ä¸Šï¼Œä¹Ÿå¯ä»¥ç”¨åœ¨ç±»ï¼Œæšä¸¾ï¼Œç»“æ„ä½“çš„å®šä¹‰ä¸Š</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// Reimplement the Swift standard library's optional type
</span><span class='line'>enum OptionalValue&lt;T&gt; {
</span><span class='line'>    case None
</span><span class='line'>    case Some(T)
</span><span class='line'>}
</span><span class='line'>var possibleInteger: OptionalValue&lt;Int&gt; = .None
</span><span class='line'>possibleInteger = .Some(100)</span></code></pre></td></tr></table></div></figure>


<p>åœ¨ç±»å‹åååŠ ä¸€ä¸ªwhereæ¥æŒ‡å®šä¸€äº›å¿…é¡»æ¡ä»¶</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func anyCommonElements &lt;T, U where T: Sequence, U: Sequence, T.GeneratorType.Element: Equatable, T.GeneratorType.Element == U.GeneratorType.Element&gt; (lhs: T, rhs: U) -&gt; Bool {
</span><span class='line'>    for lhsItem in lhs {
</span><span class='line'>        for rhsItem in rhs {
</span><span class='line'>            if lhsItem == rhsItem {
</span><span class='line'>                return true
</span><span class='line'>            }
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>    return false
</span><span class='line'>}
</span><span class='line'>anyCommonElements([1, 2, 3], [3])</span></code></pre></td></tr></table></div></figure>


<p>ç»ƒä¹ 
Modify the anyCommonElements function to make a function that returns an array of the elements that any two sequences have in common.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func anyCommonElements &lt;T, U where T: Sequence, U: Sequence, T.GeneratorType.Element:     Equatable, T.GeneratorType.Element == U.GeneratorType.Element&gt; (lhs: T, rhs: U) -&gt; Array&lt;T.GeneratorType.Element&gt; {
</span><span class='line'>    var toReturn = Array&lt;T.GeneratorType.Element&gt;()
</span><span class='line'>    for lhsItem in lhs {
</span><span class='line'>        for rhsItem in rhs {
</span><span class='line'>            if lhsItem == rhsItem {
</span><span class='line'>                toReturn.append(lhsItem)
</span><span class='line'>            }
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>    return toReturn
</span><span class='line'>}
</span><span class='line'>anyCommonElements([1, 2, 3], [3])</span></code></pre></td></tr></table></div></figure>


<p>åœ¨ä¸€äº›ç®€å•çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥çœç•¥whereï¼Œåªåœ¨åˆ†å·åå†™ä¸€ä¸ªprotocolæˆ–æ˜¯ç±»åï¼Œ&lt;T: Equatable>å’Œ<T where T: Equatable>æ˜¯ä¸€æ ·çš„
Swiftæ˜¯ç±»å‹å®‰å…¨çš„è¯­è¨€,å¦‚æœä½ çš„ä»£ç å¸Œæœ›çš„æ˜¯Stringç±»å‹ï¼Œç±»å‹å®‰å…¨å°†é˜»æ­¢ä½ èµ‹Intå€¼ç»™å®ƒ</p>

<h4>å¸¸é‡å’Œå˜é‡çš„å‘½å</h4>

<p>æˆ‘ä»¬å‡ ä¹å¯ä»¥ç”¨ä»»ä½•å­—ç¬¦æ¥å‘½åå¸¸é‡å’Œå˜é‡ï¼ŒåŒ…æ‹¬Unicodeå­—ç¬¦</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let Ï€ = 3.14159
</span><span class='line'>let ä½ å¥½ = "ä½ å¥½ä¸–ç•Œ"
</span><span class='line'>let ğŸ¶ğŸ® = "dogcowâ€</span></code></pre></td></tr></table></div></figure>


<p>ä¸€æ—¦ä½ å£°æ˜äº†æŸç§ç±»å‹çš„å¸¸é‡å’Œå˜é‡ï¼Œä½ å°±ä¸èƒ½ä¸ºå®ƒèµ‹äºˆå…¶ä»–ç±»å‹çš„å˜é‡</p>

<h4>æ‰“å°</h4>

<p>æ‰“å°å˜é‡</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>println(friendlyWelcome)</span></code></pre></td></tr></table></div></figure>


<p>æ‰“å°ä¸­åŒ…å«å­—ç¬¦æ›¿æ¢</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>println("The current value of friendlyWelcome is \(friendlyWelcome)")</span></code></pre></td></tr></table></div></figure>


<h4>æ³¨é‡Š</h4>

<p>ä¸åƒCè¯­è¨€ä¸­çš„å¤šè¡Œæ³¨é‡Šï¼ŒSwiftçš„å¤šè¡Œæ³¨é‡Šæ˜¯å¯ä»¥åµŒå¥—çš„</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/* this is the start of the first multiline comment
</span><span class='line'>/* this is the second, nested multiline comment */
</span><span class='line'>this is the end of the first multiline comment */</span></code></pre></td></tr></table></div></figure>


<h4>åˆ†å·çš„ä½¿ç”¨</h4>

<p>å¦‚æœä¸€è¡Œä¸­åŒ…å«å¤šæ¡è¯­å¥ï¼Œå°±å¾—ç”¨åˆ†å·</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let cat = "ğŸ±"; println(cat)
</span><span class='line'>// prints "ğŸ±â€</span></code></pre></td></tr></table></div></figure>


<h4>æ•´å‹</h4>

<ul>
<li>æ•´å‹èŒƒå›´</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let minValue = UInt8.min  // minValue is equal to 0, and is of type UInt8
</span><span class='line'>let maxValue = UInt8.max  // maxValue is equal to 255, and is of type UInt8â€</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Intå‹å’ŒUInt
åœ¨32ä½OSä¸Šï¼Œ(U)Intå’Œ(U)Int32çš„å¤§å°ä¸€æ ·
åœ¨64ä½OSä¸Šï¼Œ(U)Intå’Œ(U)Int64çš„å¤§å°ä¸€æ ·
åªæœ‰åœ¨ä½ ç¡®å®éœ€è¦å’ŒOSæœ¬èº«çš„å­—å¤§å°ä¸€æ ·çš„éæ•´å½¢ç±»å‹æ—¶æ‰ç”¨UIntï¼Œå¦åˆ™å°½é‡ç”¨Int

<h4>æµ®ç‚¹å‹</h4></li>
<li>Doubleä»£è¡¨äº†64ä½çš„æµ®ç‚¹æ•°ï¼Œæœ‰è‡³å°‘15ä½å°æ•°çš„ç²¾åº¦</li>
<li>Floatä»£è¡¨äº†32ä½ï¼Œåªæœ‰6ä½å°æ•°çš„ç²¾åº¦

<h4>Numeric Literals</h4>

<p>æ•´å‹å­—é¢é‡å¯ä»¥å†™æˆä»¥ä¸‹å½¢å¼</p></li>
<li>10è¿›åˆ¶ï¼Œæ— å‰ç¼€</li>
<li>äºŒè¿›åº¦ï¼Œ0bå‰ç¼€</li>
<li>å…«è¿›åˆ¶ï¼Œ0oå‰ç¼€</li>
<li>åå…­è¿›åˆ¶ï¼Œ0xå‰ç¼€</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let decimalInteger = 17
</span><span class='line'>let binaryInteger = 0b10001       // 17 in binary notation
</span><span class='line'>let octalInteger = 0o21           // 17 in octal notation
</span><span class='line'>let hexadecimalInteger = 0x11     // 17 in hexadecimal notationâ€</span></code></pre></td></tr></table></div></figure>


<p>æµ®ç‚¹å‹å¯ä»¥æ˜¯ååˆ¶çš„(æ— å‰ç¼€),ä¹Ÿå¯ä»¥æ˜¯åå…­è¿›åˆ¶çš„</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>1.25e2 means 1.25 Ã— 102, or 125.0.
</span><span class='line'>1.25e-2 means 1.25 Ã— 10-2, or 0.0125.
</span><span class='line'>0xFp2 means 15 Ã— 2*2, or 60.0.
</span><span class='line'>0xFp-2 means 15 Ã— (2çš„-2æ¬¡æ–¹), or 3.75.</span></code></pre></td></tr></table></div></figure>


<h4>æ•´å‹è½¬æ¢</h4>

<p>æº¢å‡ºä¼šæŠ¥é”™</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let cannotBeNegative: UInt8 = -1
</span><span class='line'>// UInt8 cannot store negative numbers, and so this will report an error
</span><span class='line'>let tooBig: Int8 = Int8.max + 1
</span><span class='line'>// Int8 cannot store a number larger than its maximum value,
</span><span class='line'>// and so this will also report an error</span></code></pre></td></tr></table></div></figure>


<p>æ¥çœ‹ä»¥ä¸‹ä¾‹å­</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let twoThousand: UInt16 = 2_000
</span><span class='line'>let one: UInt8 = 1
</span><span class='line'>let twoThousandAndOne = twoThousand + UInt16(one)</span></code></pre></td></tr></table></div></figure>


<p>ä»¥ä¸Šçš„UInt16æ˜¯å¿…é¡»çš„,å› ä¸ºä¸¤ä¸ªå˜é‡çš„ç±»å‹ä¸åŒ</p>

<h4>æ•´å½¢å’Œæµ®ç‚¹å‹çš„è½¬æ¢</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let three = 3
</span><span class='line'>let pointOneFourOneFiveNine = 0.14159
</span><span class='line'>let pi = Double(three) + pointOneFourOneFiveNine</span></code></pre></td></tr></table></div></figure>


<p>æµ®ç‚¹å‹è½¬ä¸ºæ•´å‹ï¼Œåªä¿ç•™æ•´æ•°,ä¸ä¼šå‡ºç°å››èˆäº”å…¥è¿™ç§æƒ…å†µ</p>

<h4>Type Aliases</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>typealias AudioSample = UInt16
</span><span class='line'>var maxAmplitudeFound = AudioSample.min</span></code></pre></td></tr></table></div></figure>


<h4>Boolå‹</h4>

<p>Swiftçš„ç±»å‹å®‰å…¨é˜»æ­¢äº†ä»»ä½•éboolå‹çš„å€¼è‡ªåŠ¨æ›¿æ¢æˆBoolå‹çš„å€¼</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let i = 1
</span><span class='line'>if i {
</span><span class='line'>    // this example will not compile, and will report an error
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>ä¸è¿‡ï¼Œä»¥ä¸‹ä½¿ç”¨æ–¹å¼å´æ˜¯å¯¹çš„</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let i = 1
</span><span class='line'>if i == 1 {
</span><span class='line'>    // this example will compile successfully
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h4>Tuples</h4>

<p>tupleå°†å¤šä¸ªå€¼ç»„åˆä¸€ä¸ªå¤åˆçš„å€¼ï¼Œå¹¶ä¸”è¿™äº›å€¼å¯ä»¥æ˜¯ä¸åŒç±»å‹çš„</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let http404Error = (404, "Not Found")
</span><span class='line'>
</span><span class='line'>let (statusCode, statusMessage) = http404Error
</span><span class='line'>println("The status code is \(statusCode)")
</span><span class='line'>// prints "The status code is 404"
</span><span class='line'>println("The status message is \(statusMessage)")
</span><span class='line'>// prints "The status message is Not Found</span></code></pre></td></tr></table></div></figure>


<p>å¦‚æœä½ åªéœ€è¦ä¸€éƒ¨åˆ†tupleçš„å€¼ ï¼Œä½ å¯ä»¥ç”¨_æ¥å¿½ç•¥ä½ ä¸éœ€è¦çš„å€¼</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let (justTheStatusCode, _) = http404Error
</span><span class='line'>println("The status code is \(justTheStatusCode)")
</span><span class='line'>// prints "The status code is 404</span></code></pre></td></tr></table></div></figure>


<p>ä¹Ÿå¯ä»¥ç”¨ä»¥ä¸‹æ–¹å¼æ¥è·å–tupleé‡Œçš„å€¼</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>println("The status code is \(http404Error.0)")
</span><span class='line'>// prints "The status code is 404"
</span><span class='line'>println("The status message is \(http404Error.1)")
</span><span class='line'>// prints "The status message is Not Found</span></code></pre></td></tr></table></div></figure>


<p>åœ¨å®šä¹‰tupleçš„æ—¶å€™å¯ä»¥ä¸ºæ¯ä¸ªelementèµ‹å€¼</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let http200Status = (statusCode: 200, description: "OK")
</span><span class='line'>println("The status code is \(http200Status.statusCode)")
</span><span class='line'>// prints "The status code is 200"
</span><span class='line'>println("The status message is \(http200Status.description)")
</span><span class='line'>// prints "The status message is OK"</span></code></pre></td></tr></table></div></figure>


<p>æ³¨æ„:Tuplesä»…ä»…é€‚ç”¨äºä¸´æ—¶çš„ä¸€ç»„ç›¸å…³çš„æ•°æ®,å®ƒå¹¶ä¸é€‚ç”¨äºå¤æ‚æ•°æ®ç±»å‹çš„åˆ›å»º</p>

<h4>Optionals</h4>

<p>Swiftâ€™s optionals let you indicate the absence of a value for any type at all, without the need for special constants.</p>

<h4>Forced Unwrapping</h4>

<p>å½“æˆ‘ä»¬ç¡®å®šoptional<code>ç¡®å®š</code>å«æœ‰ä¸€ä¸ªå€¼æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªoptionalçš„åå­—åé¢åŠ ä¸€ä¸ª!æ¥è·å–å®ƒçš„å€¼</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>if convertedNumber {
</span><span class='line'>    println("\(possibleNumber) has an integer value of \(convertedNumber!)")
</span><span class='line'>} else {
</span><span class='line'>    println("\(possibleNumber) could not be converted to an integer")
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h4>Optional Binding</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>if let constantName = someOptional {
</span><span class='line'>    statements
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>æˆ‘ä»¬å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼é‡å†™ä¹‹å‰çš„<code>possibleNumber</code>çš„ä¾‹å­</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>if let actualNumber = possibleNumber.toInt() {
</span><span class='line'>    println("\(possibleNumber) has an integer value of \(actualNumber)")
</span><span class='line'>} else {
</span><span class='line'>    println("\(possibleNumber) could not be converted to an integer")
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>ä½ å¯ä»¥èµ‹äºˆä¸€ä¸ªoptional å€¼ä¸ºnil,éoptionalçš„åˆ™ä¸è¡Œ</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var serverResponseCode: Int? = 404
</span><span class='line'>// serverResponseCode contains an actual Int value of 404
</span><span class='line'>serverResponseCode = nil</span></code></pre></td></tr></table></div></figure>


<p>å¦‚æœåœ¨å®šä¹‰ä¸€ä¸ªoptional valueæ—¶ä¸æä¾›ä¸€ä¸ªé»˜è®¤å€¼ï¼Œåˆ™å®ƒä¸ºnil</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var surveyAnswer: String?
</span><span class='line'>// surveyAnswer is automatically set to nilâ€</span></code></pre></td></tr></table></div></figure>


<p>éœ€è¦æ³¨æ„çš„æ˜¯swiftçš„nilä¸ocä¸­çš„nilä¸åŒ,ocä¸­çš„nilæ˜¯ä¸€ä¸ªæŒ‡å®šä¸å­˜åœ¨çš„å¯¹è±¡çš„æŒ‡é’ˆï¼Œè€Œswiftä¸­çš„nilåˆ™ä¸æ˜¯æŒ‡é’ˆï¼Œå®ƒåªæ˜¯è¡¨ç¤ºæŸç§ç±»å‹çš„å€¼ä¸å­˜åœ¨ï¼Œä»»ä½•ç±»å‹çš„optionaléƒ½èƒ½è®¾ç½®ä¸ºnilï¼Œè€Œä¸ä»…ä»…æ˜¯å¯¹è±¡</p>

<h4>Implicitly Unwrapped Optional</h4>

<p>ä¹Ÿå°±æ˜¯ç±»å‹ååŠ !,ä»”ç»†çœ‹ä»¥ä¸‹çš„åŒºåˆ«</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let possibleString: String? = "An optional string."
</span><span class='line'>println(possibleString!) // requires an exclamation mark to access its value
</span><span class='line'>// prints "An optional string."
</span><span class='line'> 
</span><span class='line'>let assumedString: String! = "An implicitly unwrapped optional string."
</span><span class='line'>println(assumedString)  // no exclamation mark is needed to access its value
</span><span class='line'>// prints "An implicitly unwrapped optional string.
</span><span class='line'>
</span><span class='line'>if assumedString {
</span><span class='line'>    println(assumedString)
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h4>æ–­è¨€</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let age = -3
</span><span class='line'>assert(age &gt;= 0, "A person's age cannot be less than zero")
</span><span class='line'>// this causes the assertion to trigger, because age is not &gt;= 0</span></code></pre></td></tr></table></div></figure>


<p>ä¹Ÿå¯ä»¥ä¸å†™string</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>assert(age &gt;= 0)</span></code></pre></td></tr></table></div></figure>


<p>æ³¨æ„asserté‡Œçš„stringä¸æ”¯æŒ<code>\()</code>å½¢å¼çš„æ›¿æ¢</p>

<h4>åŸºæœ¬æ“ä½œ</h4>

<p>Swiftå…è®¸ä½ å¯¹æµ®ç‚¹å€¼è¿›è¡Œ%çš„è¿ç®—
èµ‹å€¼</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let b = 10
</span><span class='line'>var a = 5
</span><span class='line'>a = b</span></code></pre></td></tr></table></div></figure>


<p>ä¸è¿‡ä¸åƒCï¼Œèµ‹å€¼æœ¬èº«ä¸è¿”å›å€¼ï¼Œæ‰€ä»¥ä»¥ä¸‹æ˜¯éæ³•çš„</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>if x = y {
</span><span class='line'>    // this is not valid, because x = y does not return a value
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>ä¸åƒCï¼ŒSwifté»˜è®¤æƒ…å†µä¸‹ä¸å…è®¸è¿›è¡Œç®—æœ¯è¿ç®—æ—¶çš„å€¼æº¢å‡º
ä¸¤ä¸ªCharacterçš„å€¼ï¼Œæˆ–è€…ä¸€ä¸ªCharacterå’Œä¸€ä¸ªStringçš„å€¼ï¼Œèƒ½ç›¸åŠ ç»„æˆä¸€ä¸ªæ–°çš„Stringçš„å€¼</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let dog: Character = "ğŸ¶"
</span><span class='line'>let cow: Character = "ğŸ®"
</span><span class='line'>let dogCow = dog + cow
</span><span class='line'>// dogCow is equal to "ğŸ¶ğŸ®â€</span></code></pre></td></tr></table></div></figure>


<h4>æ±‚ä½™è¿ç®—ç¬¦%</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>-9 % 4   // equals -1</span></code></pre></td></tr></table></div></figure>


<p>é™¤æ•°çš„ç¬¦å·æ˜¯è¢«å¿½ç•¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´a % bå’Œa % -bçš„å€¼æ˜¯ä¸€æ ·çš„
æµ®ç‚¹æ•°çš„æ±‚ä½™æ“ä½œ</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>8 % 2.5   // equals 0.5</span></code></pre></td></tr></table></div></figure>


<h4>æ¯”è¾ƒæ“ä½œç¬¦</h4>

<p><code>===</code>å¯ä»¥ç”¨æ¥æµ‹è¯•ä¸¤ä¸ªå¯¹è±¡çš„å¼•ç”¨æ˜¯å¦æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let name = "world"
</span><span class='line'>if name == "world" {
</span><span class='line'>    println("hello, world")
</span><span class='line'>} else {
</span><span class='line'>    println("I'm sorry \(name), but I don't recognize you")
</span><span class='line'>}
</span><span class='line'>// prints "hello, world", because name is indeed equal to "world"</span></code></pre></td></tr></table></div></figure>


<h4>Rangeæ“ä½œ</h4>

<p>é—­åŒºé—´</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>for index in 1...5 {
</span><span class='line'>    println("\(index) times 5 is \(index * 5)")
</span><span class='line'>}
</span><span class='line'>// 1 times 5 is 5
</span><span class='line'>// 2 times 5 is 10
</span><span class='line'>// 3 times 5 is 15
</span><span class='line'>// 4 times 5 is 20
</span><span class='line'>// 5 times 5 is 25â€</span></code></pre></td></tr></table></div></figure>


<p>å¼€åŒºé—´</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let names = ["Anna", "Alex", "Brian", "Jack"]
</span><span class='line'>let count = names.count
</span><span class='line'>for i in 0..count {
</span><span class='line'>    println("Person \(i + 1) is called \(names[i])")
</span><span class='line'>}
</span><span class='line'>// Person 1 is called Anna
</span><span class='line'>// Person 2 is called Alex
</span><span class='line'>// Person 3 is called Brian
</span><span class='line'>// Person 4 is called Jack</span></code></pre></td></tr></table></div></figure>


<h4>å­—ç¬¦ä¸²å’Œå­—ç¬¦</h4>

<p>Every string is composed of encoding-independent Unicode characters, and provides support for accessing those characters in various Unicode representations.
æ³¨æ„OCä¸­çš„stringç›¸å…³çš„APIï¼ŒSwiftéƒ½çš„Stringéƒ½èƒ½ä½¿ç”¨</p>

<h5>String Literals</h5>

<ul>
<li>è½¬ä¹‰å­—ç¬¦\0(ç©ºå­—ç¬¦),\(è¿”æ–œæ†),\t,\n,\r,\&ldquo;,`</li>
<li>å•å­—èŠ‚çš„Unicode scalars,\xnn,nnæ˜¯ä¸¤ä½åå…­è¿›åˆ¶çš„æ•°å­—</li>
<li>ä¸¤ä¸ªå­—èŠ‚çš„Unicode scalars,\unnnn,nnnnæ˜¯ä¸€ä¸ªå››ä½åå…­è¿›åˆ¶çš„æ•°å­—</li>
<li>å››ä¸ªå­—èŠ‚çš„Unicode scalars,\Unnnnnnnn,nnnnnnnnæ˜¯å…«ä½çš„åå…­è¿›åˆ¶çš„æ•°å­—</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let wiseWords = "\"Imagination is more important than knowledge\" - Einstein"
</span><span class='line'>// "Imagination is more important than knowledge" - Einstein
</span><span class='line'>let dollarSign = "\x24"        // $,  Unicode scalar U+0024
</span><span class='line'>let blackHeart = "\u2665"      // â™¥,  Unicode scalar U+2665
</span><span class='line'>let sparklingHeart = "\U0001F496"  // ğŸ’–, Unicode scalar U+1F496â€</span></code></pre></td></tr></table></div></figure>


<h4>åˆå§‹åŒ–ä¸€ä¸ªç©ºå­—ç¬¦ä¸²</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var emptyString = ""               // empty string literal
</span><span class='line'>var anotherEmptyString = String()  // initializer syntax
</span><span class='line'>// these two strings are both empty, and are equivalent to each other</span></code></pre></td></tr></table></div></figure>


<p>åˆ¤æ–­ä¸€ä¸ªStringçš„å€¼æ˜¯å¦æ˜¯ç©ºçš„</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>if emptyString.isEmpty {
</span><span class='line'>    println("Nothing to see here")
</span><span class='line'>}
</span><span class='line'>// prints "Nothing to see here</span></code></pre></td></tr></table></div></figure>


<p>ä½ å¯ä»¥åœ¨å®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²æ—¶ç”¨varå’Œletæ¥è¡¨ç¤ºå­—ç¬¦ä¸²æ˜¯å¦å¯å˜</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var variableString = "Horse"
</span><span class='line'>variableString += " and carriage"
</span><span class='line'>// variableString is now "Horse and carriage"
</span><span class='line'> 
</span><span class='line'>let constantString = "Highlander"
</span><span class='line'>constantString += " and another Highlander"
</span><span class='line'>// this reports a compile-time error - a constant string cannot be modified</span></code></pre></td></tr></table></div></figure>


<h4>Stringsæ˜¯å€¼ç±»å‹</h4>

<p>ä¹Ÿå°±æ˜¯è¯´å¦‚æœstringçš„å€¼è¢«ä¼ å…¥å‡½æ•°æˆ–æ–¹æ³•ï¼Œæˆ–è¢«èµ‹å€¼æ—¶ï¼Œå®ƒæ˜¯è¢«copyçš„ï¼å¹•åï¼ŒSwiftçš„ç¼–è¯‘å™¨ä¼˜åŒ–äº†stringçš„ä½¿ç”¨ï¼Œæ‰€ä»¥copyåªæœ‰åœ¨çœŸæ­£éœ€è¦çš„æ—¶å€™æ‰å‘ç”Ÿ,è¿™æ„å‘³ç€ä½ æ— éœ€æ‹…å¿ƒæ€§èƒ½æ€»é‡</p>

<h5>éå†stringä¸­çš„å­—ç¬¦</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>for character in "Dog!ğŸ¶" {
</span><span class='line'>    println(character)
</span><span class='line'>}
</span><span class='line'>// D
</span><span class='line'>// o
</span><span class='line'>// g
</span><span class='line'>// !
</span><span class='line'>// ğŸ¶â€</span></code></pre></td></tr></table></div></figure>


<p>åˆ›å»ºä¸€ä¸ªcharacter</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let yenSign: Character = "Â¥"</span></code></pre></td></tr></table></div></figure>


<h4>è®¡ç®—Charactersçš„ä¸ªæ•°</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let unusualMenagerie = "Koala ğŸ¨, Snail ğŸŒ, Penguin ğŸ§, Dromedary ğŸª"
</span><span class='line'>println("unusualMenagerie has \(countElements(unusualMenagerie)) characters")
</span><span class='line'>// prints "unusualMenagerie has 40 charactersâ€</span></code></pre></td></tr></table></div></figure>


<p>ä¸åŒçš„Unicodeå­—ç¬¦æˆ–åŒä¸€Unicodeå­—ç¬¦çš„ä¸åŒè¡¨ç¤ºå½¢å¼åœ¨å†…å­˜ä¸­å çš„ç©ºé—´ä¸ä¸€æ ·ï¼ŒåŸºäºæ­¤ï¼Œswiftä¸­çš„å­—ç¬¦å¹¶ä¸å ç”¨åŒæ ·çš„å†…å­˜ï¼Œæ‰€ä»¥è¦è®¡ç®—ä¸€ä¸ªstringçš„é•¿åº¦ï¼Œæˆ‘ä»¬å¿…é¡»é€ä¸ªéå†å­—ç¬¦</p>

<p><code>Note</code> also that the character count returned by countElements is not always the same as the length property of an NSString that contains the same characters. The length of an NSString is based on the number of 16-bit code units within the stringâ€™s UTF-16 representation and not the number of Unicode characters within the string. To reflect this fact, the length property from NSString is called utf16count when it is accessed on a Swift String value.</p>

<h4>è¿æ¥å­—ç¬¦ä¸²å’Œå­—ç¬¦</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let string1 = "hello"
</span><span class='line'>let string2 = " there"
</span><span class='line'>let character1: Character = "!"
</span><span class='line'>let character2: Character = "?"
</span><span class='line'> 
</span><span class='line'>let stringPlusCharacter = string1 + character1        // equals "hello!"
</span><span class='line'>let stringPlusString = string1 + string2              // equals "hello there"
</span><span class='line'>let characterPlusString = character1 + string1        // equals "!hello"
</span><span class='line'>let characterPlusCharacter = character1 + character2  // equals "!?â€</span></code></pre></td></tr></table></div></figure>


<h4>æ¯”è¾ƒå­—ç¬¦ä¸²</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let quotation = "We're a lot alike, you and I."
</span><span class='line'>let sameQuotation = "We're a lot alike, you and I."
</span><span class='line'>if quotation == sameQuotation {
</span><span class='line'>    println("These two strings are considered equal")
</span><span class='line'>}
</span><span class='line'>// prints "These two strings are considered equal</span></code></pre></td></tr></table></div></figure>


<h5>å‰ç¼€å’Œåç¼€çš„æ¯”è¾ƒ</h5>

<p>hasPrefixå’ŒhasSuffix
å‰ç¼€</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let romeoAndJuliet = [
</span><span class='line'>    "Act 1 Scene 1: Verona, A public place",
</span><span class='line'>    "Act 1 Scene 2: Capulet's mansion",
</span><span class='line'>    "Act 1 Scene 3: A room in Capulet's mansion",
</span><span class='line'>    "Act 1 Scene 4: A street outside Capulet's mansion",
</span><span class='line'>    "Act 1 Scene 5: The Great Hall in Capulet's mansion",
</span><span class='line'>    "Act 2 Scene 1: Outside Capulet's mansion",
</span><span class='line'>    "Act 2 Scene 2: Capulet's orchard",
</span><span class='line'>    "Act 2 Scene 3: Outside Friar Lawrence's cell",
</span><span class='line'>    "Act 2 Scene 4: A street in Verona",
</span><span class='line'>    "Act 2 Scene 5: Capulet's mansion",
</span><span class='line'>    "Act 2 Scene 6: Friar Lawrence's cell"
</span><span class='line'>]
</span><span class='line'>
</span><span class='line'>var act1SceneCount = 0
</span><span class='line'>for scene in romeoAndJuliet {
</span><span class='line'>    if scene.hasPrefix("Act 1 ") {
</span><span class='line'>        ++act1SceneCount
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>println("There are \(act1SceneCount) scenes in Act 1")
</span><span class='line'>// prints "There are 5 scenes in Act 1</span></code></pre></td></tr></table></div></figure>


<p>åç¼€</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var mansionCount = 0
</span><span class='line'>var cellCount = 0
</span><span class='line'>for scene in romeoAndJuliet {
</span><span class='line'>    if scene.hasSuffix("Capulet's mansion") {
</span><span class='line'>        ++mansionCount
</span><span class='line'>    } else if scene.hasSuffix("Friar Lawrence's cell") {
</span><span class='line'>        ++cellCount
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>println("\(mansionCount) mansion scenes; \(cellCount) cell scenes")
</span><span class='line'>// prints "6 mansion scenes; 2 cell scenesâ€</span></code></pre></td></tr></table></div></figure>


<h5>å¤§å°å†™è½¬æ¢</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let normal = "Could you help me, please?""
</span><span class='line'>let shouty = normal.uppercaseString
</span><span class='line'>// shouty is equal to "COULD YOU HELP ME, PLEASE?"
</span><span class='line'>let whispered = normal.lowercaseString
</span><span class='line'>// whispered is equal to "could you help me, please?â€</span></code></pre></td></tr></table></div></figure>


<h4>Unicode p118</h4>

<h4>Collection ç±»å‹</h4>

<h5>Array</h5>

<p>ä¸åŒäºOCä¸­çš„array(å¯å­˜å‚¨ä¸åŒç±»å‹çš„å¯¹è±¡)ï¼Œarrayå­˜å‚¨äº†åŒç±»å‹çš„å¯¹è±¡ï¼Œæ— éœ€ä¸€å®šè¦å­˜å‚¨å¯¹è±¡ï¼Œä¹Ÿå¯å­˜å‚¨Intç­‰ç±»å‹
ä»¥ä¸‹ä¸¤ä¸ªå®šä¹‰ç­‰ä»·</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var shoppingList: String[] = ["Eggs", "Milk"]
</span><span class='line'>var shoppingList = ["Eggs", "Milk"]</span></code></pre></td></tr></table></div></figure>


<h5>è®¿é—®æˆ–ä¿®æ”¹array</h5>

<p>è®¡ç®—arrayçš„å¤§å°</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>â€œprintln("The shopping list contains \(shoppingList.count) items.")
</span><span class='line'>// prints "The shopping list contains 2 items.â€</span></code></pre></td></tr></table></div></figure>


<p>ç”¨isEmptyæ¥åˆ¤æ–­counå¾—å¦ä¸º0</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>if shoppingList.isEmpty {
</span><span class='line'>    println("The shopping list is empty.")
</span><span class='line'>} else {
</span><span class='line'>    println("The shopping list is not empty.")
</span><span class='line'>}
</span><span class='line'>// prints "The shopping list is not empty."</span></code></pre></td></tr></table></div></figure>


<p>æ·»åŠ å…ƒç´ </p>

<ul>
<li>ç”¨append</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>shoppingList.append("Flour")
</span><span class='line'>// shoppingList now contains 3 items, and someone is making pancakesâ€</span></code></pre></td></tr></table></div></figure>


<ul>
<li>ç”¨+=</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>shoppingList += "Baking Powder"
</span><span class='line'>// shoppingList now contains 4 itemsâ€
</span><span class='line'>
</span><span class='line'>shoppingList += ["Chocolate Spread", "Cheese", "Butter"]
</span><span class='line'>// shoppingList now contains 7 itemsâ€</span></code></pre></td></tr></table></div></figure>


<p>ç”¨Rangeæ¥æ”¹å˜æ•°ç»„é‡Œä¸€äº›å…ƒç´ çš„å€¼</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>shoppingList[4...6] = ["Bananas", "Apples"]
</span><span class='line'>// shoppingList now contains 6 itemsâ€</span></code></pre></td></tr></table></div></figure>


<p>åœ¨æŸä½ç½®æ’å…¥å…ƒç´ </p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>shoppingList.insert("Maple Syrup", atIndex: 0)
</span><span class='line'>// shoppingList now contains 7 items
</span><span class='line'>// "Maple Syrup" is now the first item in the listâ€</span></code></pre></td></tr></table></div></figure>


<p>ç§»é™¤å…ƒç´ </p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let mapleSyrup = shoppingList.removeAtIndex(0)
</span><span class='line'>let apples = shoppingList.removeLast()</span></code></pre></td></tr></table></div></figure>


<p>éå†</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>for item in shoppingList {
</span><span class='line'>    println(item)
</span><span class='line'>}
</span><span class='line'>// Six eggs
</span><span class='line'>// Milk
</span><span class='line'>// Flour
</span><span class='line'>// Baking Powder
</span><span class='line'>// Bananasâ€</span></code></pre></td></tr></table></div></figure>


<p>å¦‚æœä½ åœ¨éå†æ—¶éœ€è¦çŸ¥é“å¯¹åº”çš„indexï¼Œå¯ä»¥ç”¨ä»¥ä¸‹æ–¹å¼</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>for (index, value) in enumerate(shoppingList) {
</span><span class='line'>    println("Item \(index + 1): \(value)")
</span><span class='line'>}
</span><span class='line'>// Item 1: Six eggs
</span><span class='line'>// Item 2: Milk
</span><span class='line'>// Item 3: Flour
</span><span class='line'>// Item 4: Baking Powder
</span><span class='line'>// Item 5: Bananas</span></code></pre></td></tr></table></div></figure>


<h4>åˆ›å»ºå’Œåˆå§‹åŒ–Array</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var someInts = Int[]()
</span><span class='line'>println("someInts is of type Int[] with \(someInts.count) items.")
</span><span class='line'>// prints "someInts is of type Int[] with 0 items.</span></code></pre></td></tr></table></div></figure>


<p>æ³¨æ„ä»¥ä¸‹ä¾‹å­ï¼Œè™½ç„¶someInt=[]ä¸æŒ‡å®šä»»ä½•ç±»å‹ï¼Œä½†ä»å‰æ®µä»£ç å¯çŸ¥å®ƒçš„å…ƒç´ æ˜¯Intç±»å‹çš„</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>someInts.append(3)
</span><span class='line'>// someInts now contains 1 value of type Int
</span><span class='line'>someInts = []
</span><span class='line'>// someInts is now an empty array, but is still of type Int[]</span></code></pre></td></tr></table></div></figure>


<p>æŒ‡å®šdefaultå€¼å’Œæ•°ç›®çš„åˆå§‹åŒ–</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var threeDoubles = Double[](count: 3, repeatedValue: 0.0)
</span><span class='line'>// threeDoubles is of type Double[], and equals [0.0, 0.0, 0.0]
</span><span class='line'>
</span><span class='line'>var anotherThreeDoubles = Array(count: 3, repeatedValue: 2.5)
</span><span class='line'>// anotherThreeDoubles is inferred as Double[], and equals [2.5, 2.5, 2.5]</span></code></pre></td></tr></table></div></figure>


<p>æœ€åæˆ‘ä»¬èƒ½é€šè¿‡+æ¥å°†ä¸¤ä¸ªæ•°ç»„è¿æˆä¸€ä¸ª</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var sixDoubles = threeDoubles + anotherThreeDoubles
</span><span class='line'>// sixDoubles is inferred as Double[], and equals [0.0, 0.0, 0.0, 2.5, 2.5, 2.5]â€</span></code></pre></td></tr></table></div></figure>


<h4>å­—å…¸</h4>

<p>å¯¹keyçš„å”¯ä¸€è¦æ±‚æ˜¯hashable,Enumeration member values without associated values (as described in Enumerations) are also hashable by default.
ä»¥ä¸‹ä¸¤ä¸ªå®šä¹‰æ˜¯ç­‰ä»·çš„ï¼Œswiftèƒ½æ¨æµ‹å‡ºå®ƒçš„ç±»å‹</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var airports: Dictionary&lt;String, String&gt; = ["TYO": "Tokyo", "DUB": "Dublin"]â€
</span><span class='line'>var airports: Dictionary&lt;String, String&gt; = ["TYO": "Tokyo", "DUB": "Dublin"]
</span></code></pre></td></tr></table></div></figure>


<h4>è®¿é—®å’Œä¿®æ”¹å­—å…¸</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>println("The dictionary of airports contains \(airports.count) items.")
</span><span class='line'>// prints "The dictionary of airports contains 2 items.</span></code></pre></td></tr></table></div></figure>


<p>æ–¹æ³•updateValue(forKey:)çš„ä½¿ç”¨</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>if let oldValue = airports.updateValue("Dublin International", forKey: "DUB") {
</span><span class='line'>    println("The old value for DUB was \(oldValue).")
</span><span class='line'>}
</span><span class='line'>// prints "The old value for DUB was Dublin.</span></code></pre></td></tr></table></div></figure>


<p>æ³¨æ„ï¼Œæ­¤æ–¹æ³•å¯¹åº”çš„æ˜¯keyå¯¹åº”çš„æ—§å€¼ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªoptional value
ç”¨[]è·å–çš„å€¼ä¹Ÿæ˜¯optional vlaue</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>if let airportName = airports["DUB"] {
</span><span class='line'>    println("The name of the airport is \(airportName).")
</span><span class='line'>} else {
</span><span class='line'>    println("That airport is not in the airports dictionary.")
</span><span class='line'>}
</span><span class='line'>// prints "The name of the airport is Dublin International.</span></code></pre></td></tr></table></div></figure>


<p>æˆ‘ä»¬å¯ä»¥å°†nilèµ‹äºˆkeyå¯¹åº”çš„å€¼æ¥ç§»é™¤æ­¤key</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>airports["APL"] = "Apple International"
</span><span class='line'>// "Apple International" is not the real airport for APL, so delete it
</span><span class='line'>airports["APL"] = nil
</span><span class='line'>// APL has now been removed from the dictionary</span></code></pre></td></tr></table></div></figure>


<p>ä¹Ÿå¯ä»¥ç”¨<code>removeValueForKey</code>æ–¹æ³•
æ­¤æ–¹æ³•è¿”å›çš„æ˜¯keyå¯¹åº”çš„æ—§å€¼,æˆ–è€…nil(å¦‚æœä¸å­˜åœ¨çš„è¯)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>if let removedValue = airports.removeValueForKey("DUB") {
</span><span class='line'>    println("The removed airport's name is \(removedValue).")
</span><span class='line'>} else {
</span><span class='line'>    println("The airports dictionary does not contain a value for DUB.")
</span><span class='line'>}
</span><span class='line'>// prints "The removed airport's name is Dublin International.â€</span></code></pre></td></tr></table></div></figure>


<h5>éå†å­—å…¸</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>for (airportCode, airportName) in airports {
</span><span class='line'>    println("\(airportCode): \(airportName)")
</span><span class='line'>}
</span><span class='line'>// TYO: Tokyo
</span><span class='line'>// LHR: London Heathrow
</span><span class='line'>
</span><span class='line'>for airportCode in airports.keys {
</span><span class='line'>    println("Airport code: \(airportCode)")
</span><span class='line'>}
</span><span class='line'>// Airport code: TYO
</span><span class='line'>// Airport code: LHR
</span><span class='line'> 
</span><span class='line'>for airportName in airports.values {
</span><span class='line'>    println("Airport name: \(airportName)")
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>//ç”¨keysæˆ–valuesåˆ›å»ºä¸€ä¸ªæ•°ç»„
</span><span class='line'>let airportCodes = Array(airports.keys)
</span><span class='line'>// airportCodes is ["TYO", "LHR"]
</span><span class='line'> 
</span><span class='line'>let airportNames = Array(airports.values)
</span><span class='line'>// airportNames is ["Tokyo", "London Heathrow"]</span></code></pre></td></tr></table></div></figure>


<h4>åˆ›å»ºä¸€ä¸ªç©ºçš„å­—å…¸</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var namesOfIntegers = Dictionary&lt;Int, String&gt;()</span></code></pre></td></tr></table></div></figure>


<p>æ³¨æ„ä»¥ä¸‹,namesIntegersèƒ½è¢«æ¨æ–­å‡ºæ˜¯&lt;Int,String></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>namesOfIntegers[16] = "sixteen"
</span><span class='line'>// namesOfIntegers now contains 1 key-value pair
</span><span class='line'>namesOfIntegers = [:]</span></code></pre></td></tr></table></div></figure>


<p><code>æ³¨æ„</code>Behind the scenes, Swiftâ€™s array and dictionary types are implemented as generic collections</p>

<h4>Mutability Of Collections</h4>

<p>å¯¹å­—å…¸æ¥è¯´,immutabilityæ„å‘³ç€ä½ ä¸èƒ½æ”¹å˜ä¸€ä¸ªkeyå¯¹åº”çš„å€¼ï¼Œè€Œå¯¹æ•°ç»„æ¥è¯´ï¼Œä½ åªæ˜¯ä¸èƒ½æ”¹å˜å®ƒçš„å¤§å°ï¼Œä½†ä»ç„¶èƒ½æ”¹å˜æŸä¸ªindexå¯¹åº”çš„å€¼</p>

<h4>æ¡ä»¶è¯­å¥</h4>

<p>æ³¨æ„,swiftçš„switchä¸­çš„caseåæ— éœ€è·Ÿç€breakï¼Œå› ä¸ºæ‰§è¡Œå®Œcaseé‡Œçš„è¯­å¥å°±è‡ªåŠ¨breakäº†ï¼Œcasesä¹Ÿèƒ½åŒ¹é…ä¸åŒçš„ç±»å‹ï¼ŒåŒ…æ‹¬range,tuplesæˆ–è½¬æ¢ä¸ºæŸä¸€å…·ä½“çš„ç±»å‹</p>

<h5>For Loops</h5>

<ul>
<li>For-In</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>for index in 1...5 {
</span><span class='line'>    println("\(index) times 5 is \(index * 5)")
</span><span class='line'>}
</span><span class='line'>// 1 times 5 is 5
</span><span class='line'>// 2 times 5 is 10
</span><span class='line'>// 3 times 5 is 15
</span><span class='line'>// 4 times 5 is 20
</span><span class='line'>// 5 times 5 is 25â€</span></code></pre></td></tr></table></div></figure>


<p>å¦‚æœä½ ä¸éœ€è¦indexï¼Œå¯ä»¥ç”¨<code>_</code>æ¥å¿½ç•¥å®ƒ</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let base = 3
</span><span class='line'>let power = 10
</span><span class='line'>var answer = 1
</span><span class='line'>for _ in 1...power {
</span><span class='line'>    answer *= base
</span><span class='line'>}
</span><span class='line'>println("\(base) to the power of \(power) is \(answer)")
</span><span class='line'>// prints "3 to the power of 10 is 59049</span></code></pre></td></tr></table></div></figure>


<p>array,dictionary,charactersçš„for-in</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let names = ["Anna", "Alex", "Brian", "Jack"]
</span><span class='line'>for name in names {
</span><span class='line'>    println("Hello, \(name)!")
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>let numberOfLegs = ["spider": 8, "ant": 6, "cat": 4]
</span><span class='line'>for (animalName, legCount) in numberOfLegs {
</span><span class='line'>    println("\(animalName)s have \(legCount) legs")
</span><span class='line'>}
</span><span class='line'>// spiders have 8 legs
</span><span class='line'>// ants have 6 legs
</span><span class='line'>// cats have 4 legs
</span><span class='line'>
</span><span class='line'>for character in "Hello" {
</span><span class='line'>    println(character)
</span><span class='line'>}
</span><span class='line'>// H
</span><span class='line'>// e
</span><span class='line'>// l
</span><span class='line'>// l
</span><span class='line'>// o</span></code></pre></td></tr></table></div></figure>


<h5>For-Condition-Increment</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>for var index = 0; index &lt; 3; ++index {
</span><span class='line'>    println("index is \(index)")
</span><span class='line'>}
</span><span class='line'>// index is 0
</span><span class='line'>// index is 1
</span><span class='line'>// index is 2</span></code></pre></td></tr></table></div></figure>


<p>æ³¨æ„foråæ— éœ€æ‹¬å·</p>

<h5>æ¡ä»¶è¯­å¥</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var temperatureInFahrenheit = 30
</span><span class='line'>if temperatureInFahrenheit &lt;= 32 {
</span><span class='line'>    println("It's very cold. Consider wearing a scarf.")
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h5>switchè¯­å¥</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let someCharacter: Character = "e"
</span><span class='line'>switch someCharacter {
</span><span class='line'>case "a", "e", "i", "o", "u":
</span><span class='line'>    println("\(someCharacter) is a vowel")
</span><span class='line'>case "b", "c", "d", "f", "g", "h", "j", "k", "l", "m",
</span><span class='line'>"n", "p", "q", "r", "s", "t", "v", "w", "x", "y", "z":
</span><span class='line'>    println("\(someCharacter) is a consonant")
</span><span class='line'>default:
</span><span class='line'>    println("\(someCharacter) is not a vowel or a consonant")
</span><span class='line'>}
</span><span class='line'>// prints "e is a vowelâ€</span></code></pre></td></tr></table></div></figure>


<p>æ³¨æ„ï¼Œä»¥ä¸‹æ–¹å¼ä¸è¡Œ</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let anotherCharacter: Character = "a"
</span><span class='line'>switch anotherCharacter {
</span><span class='line'>case "a":
</span><span class='line'>case "A":
</span><span class='line'>    println("The letter A")
</span><span class='line'>default:
</span><span class='line'>    println("Not the letter A")
</span><span class='line'>}
</span><span class='line'>// this will report a compile-time error</span></code></pre></td></tr></table></div></figure>


<p>æ¯ä¸ªcaseé‡Œå¿…é¡»å¯¹åº”ç›¸åº”çš„è¯­å¥</p>

<h5>Range Matching</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let count = 3_000_000_000_000
</span><span class='line'>let countedThings = "stars in the Milky Way"
</span><span class='line'>var naturalCount: String
</span><span class='line'>switch count {
</span><span class='line'>case 0:
</span><span class='line'>    naturalCount = "no"
</span><span class='line'>case 1...3:
</span><span class='line'>    naturalCount = "a few"
</span><span class='line'>case 4...9:
</span><span class='line'>    naturalCount = "several"
</span><span class='line'>case 10...99:
</span><span class='line'>    naturalCount = "tens of"
</span><span class='line'>case 100...999:
</span><span class='line'>    naturalCount = "hundreds of"
</span><span class='line'>case 1000...999_999:
</span><span class='line'>    naturalCount = "thousands of"
</span><span class='line'>default:
</span><span class='line'>    naturalCount = "millions and millions of"
</span><span class='line'>}
</span><span class='line'>println("There are \(naturalCount) \(countedThings).")
</span><span class='line'>// prints "There are millions and millions of stars in the Milky Way.â€</span></code></pre></td></tr></table></div></figure>


<h5>Tuples</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let somePoint = (1, 1)
</span><span class='line'>switch somePoint {
</span><span class='line'>case (0, 0):
</span><span class='line'>    println("(0, 0) is at the origin")
</span><span class='line'>case (_, 0):
</span><span class='line'>    println("(\(somePoint.0), 0) is on the x-axis")
</span><span class='line'>case (0, _):
</span><span class='line'>    println("(0, \(somePoint.1)) is on the y-axis")
</span><span class='line'>case (-2...2, -2...2):
</span><span class='line'>    println("(\(somePoint.0), \(somePoint.1)) is inside the box")
</span><span class='line'>default:
</span><span class='line'>    println("(\(somePoint.0), \(somePoint.1)) is outside of the box")
</span><span class='line'>}
</span><span class='line'>// prints "(1, 1) is inside the boxâ€</span></code></pre></td></tr></table></div></figure>


<h4>Value Bindings</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let anotherPoint = (2, 0)
</span><span class='line'>switch anotherPoint {
</span><span class='line'>case (let x, 0):
</span><span class='line'>    println("on the x-axis with an x value of \(x)")
</span><span class='line'>case (0, let y):
</span><span class='line'>    println("on the y-axis with a y value of \(y)")
</span><span class='line'>case let (x, y):
</span><span class='line'>    println("somewhere else at (\(x), \(y))")
</span><span class='line'>}
</span><span class='line'>// prints "on the x-axis with an x value of 2â€</span></code></pre></td></tr></table></div></figure>


<h5>whereçš„ä½¿ç”¨</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let yetAnotherPoint = (1, -1)
</span><span class='line'>switch yetAnotherPoint {
</span><span class='line'>case let (x, y) where x == y:
</span><span class='line'>    println("(\(x), \(y)) is on the line x == y")
</span><span class='line'>case let (x, y) where x == -y:
</span><span class='line'>    println("(\(x), \(y)) is on the line x == -y")
</span><span class='line'>case let (x, y):
</span><span class='line'>    println("(\(x), \(y)) is just some arbitrary point")
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h5>Control Transferè¯­å¥</h5>

<p>æ³¨æ„FallThroughçš„ä½¿ç”¨,æ¥çœ‹ä»¥ä¸‹ä¾‹å­</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let integerToDescribe = 5
</span><span class='line'>var description = "The number \(integerToDescribe) is"
</span><span class='line'>switch integerToDescribe {
</span><span class='line'>case 2, 3, 5, 7, 11, 13, 17, 19:
</span><span class='line'>    description += " a prime number, and also"
</span><span class='line'>    fallthrough
</span><span class='line'>default:
</span><span class='line'>    description += " an integer."
</span><span class='line'>}
</span><span class='line'>println(description)
</span><span class='line'>// prints "The number 5 is a prime number, and also an integer.â€</span></code></pre></td></tr></table></div></figure>


<h4>Labeledè¯­å¥</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>gameLoop: while square != finalSquare {
</span><span class='line'>    if ++diceRoll == 7 { diceRoll = 1 }
</span><span class='line'>    switch square + diceRoll {
</span><span class='line'>    case finalSquare:
</span><span class='line'>        // diceRoll will move us to the final square, so the game is over
</span><span class='line'>        break gameLoop
</span><span class='line'>    case let newSquare where newSquare &gt; finalSquare:
</span><span class='line'>        // diceRoll will move us beyond the final square, so roll again
</span><span class='line'>        continue gameLoop
</span><span class='line'>    default:
</span><span class='line'>        // this is a valid move, so find out its effect
</span><span class='line'>        square += diceRoll
</span><span class='line'>        square += board[square]
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>println("Game over!")â€</span></code></pre></td></tr></table></div></figure>


<h4>å‡½æ•°</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func sayHello(personName: String) -&gt; String {
</span><span class='line'>    let greeting = "Hello, " + personName + "!"
</span><span class='line'>    return greeting
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>println(sayHello("Anna"))
</span><span class='line'>// prints "Hello, Anna!"
</span><span class='line'>println(sayHello("Brian"))
</span><span class='line'>// prints "Hello, Brian!â€
</span><span class='line'>
</span><span class='line'>func sayHelloWorld() -&gt; String {
</span><span class='line'>    return "hello, world"
</span><span class='line'>}
</span><span class='line'>println(sayHelloWorld())
</span><span class='line'>// prints "hello, worldâ€</span></code></pre></td></tr></table></div></figure>


<p>æ— è¿”å›å€¼çš„å‡½æ•°</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func sayGoodbye(personName: String) {
</span><span class='line'>    println("Goodbye, \(personName)!")
</span><span class='line'>}
</span><span class='line'>sayGoodbye("Dave")
</span><span class='line'>// prints "Goodbye, Dave!"</span></code></pre></td></tr></table></div></figure>


<p>æ³¨æ„ï¼Œå®é™…ä¸Šï¼Œè™½ç„¶å‡½æ•°æ²¡å†™è¿”å›å€¼ï¼Œä½†å®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªç©ºçš„tuple<code>()</code></p>

<h5>è¿”å›å¤šä¸ªå€¼</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func count(string: String) -&gt; (vowels: Int, consonants: Int, others: Int) {
</span><span class='line'>    var vowels = 0, consonants = 0, others = 0
</span><span class='line'>    for character in string {
</span><span class='line'>        switch String(character).lowercaseString {
</span><span class='line'>        case "a", "e", "i", "o", "u":
</span><span class='line'>            ++vowels
</span><span class='line'>        case "b", "c", "d", "f", "g", "h", "j", "k", "l", "m",
</span><span class='line'>        "n", "p", "q", "r", "s", "t", "v", "w", "x", "y", "z":
</span><span class='line'>            ++consonants
</span><span class='line'>        default:
</span><span class='line'>            ++others
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>    return (vowels, consonants, others)
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>let total = count("some arbitrary string!")
</span><span class='line'>println("\(total.vowels) vowels and \(total.consonants) consonants")
</span><span class='line'>// prints "6 vowels and 13 consonantsâ€</span></code></pre></td></tr></table></div></figure>


<p><code>æ³¨æ„</code>,.vowerlså’Œ.consonantsä¾ç„¶å¯ç”¨!!!</p>

<h5>External Parameter Names</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func someFunction(externalParameterName localParameterName: Int) {
</span><span class='line'>    // function body goes here, and can use localParameterName
</span><span class='line'>    // to refer to the argument value for that parameter
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>func join(string s1: String, toString s2: String, withJoiner joiner: String)
</span><span class='line'>    -&gt; String {
</span><span class='line'>        return s1 + joiner + s2
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>join(string: "hello", toString: "world", withJoiner: ", ")</span></code></pre></td></tr></table></div></figure>


<h5>Shorthand External Parameter Names</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func containsCharacter(#string: String, #characterToFind: Character) -&gt; Bool {
</span><span class='line'>    for character in string {
</span><span class='line'>        if character == characterToFind {
</span><span class='line'>            return true
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>    return false
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>let containsAVee = containsCharacter(string: "aardvark", characterToFind: "v")
</span><span class='line'>// containsAVee equals true, because "aardvark" contains a "vâ€</span></code></pre></td></tr></table></div></figure>


<h4>å‚æ•°çš„é»˜è®¤å€¼</h4>

<p>å°†æœ‰é»˜è®¤å€¼çš„å‚æ•°æ”¾åœ¨æœ€å</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func join(string s1: String, toString s2: String,
</span><span class='line'>    withJoiner joiner: String = " ") -&gt; String {
</span><span class='line'>        return s1 + joiner + s2
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>join(string: "hello", toString: "world", withJoiner: "-")
</span><span class='line'>// returns "hello-world"
</span><span class='line'>
</span><span class='line'>join(string: "hello", toString: "world")
</span><span class='line'>// returns "hello world"</span></code></pre></td></tr></table></div></figure>


<h5>External Names for Parameters with Default Values</h5>

<p>Swift provides an automatic external name for any defaulted parameter you define
æ•…å¯ä»¥åƒå¦‚ä¸‹è°ƒç”¨</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>join("hello", "world", joiner: "-")</span></code></pre></td></tr></table></div></figure>


<h5>Variadic Parameters</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func arithmeticMean(numbers: Double...) -&gt; Double {
</span><span class='line'>    var total: Double = 0
</span><span class='line'>    for number in numbers {
</span><span class='line'>        total += number
</span><span class='line'>    }
</span><span class='line'>    return total / Double(numbers.count)
</span><span class='line'>}
</span><span class='line'>arithmeticMean(1, 2, 3, 4, 5)
</span><span class='line'>// returns 3.0, which is the arithmetic mean of these five numbers
</span><span class='line'>arithmeticMean(3, 8, 19)
</span><span class='line'>// returns 10.0, which is the arithmetic mean of these three numbers</span></code></pre></td></tr></table></div></figure>


<p>ä¸€ä¸ªå‡½æ•°è‡³å¤šåªèƒ½æœ‰ä¸€ä¸ªvariadicå‚æ•°ï¼Œå®ƒå¿…é¡»æ€»æ˜¯åœ¨æ‰€æœ‰å‚æ•°çš„æœ€å!</p>

<h5>Constant å’Œ Variable å‚æ•°</h5>

<p>å‡½æ•°çš„å‚æ•°é»˜è®¤æ˜¯constantçš„,å¦‚æœè¯•å›¾ä¿®æ”¹å®ƒå°†å¯¼è‡´é”™è¯¯,æˆ‘ä»¬å¯ä»¥åœ¨å‚æ•°å‰åŠ varæ¥è®©å®ƒå¯ä¿®æ”¹</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func alignRight(var string: String, count: Int, pad: Character) -&gt; String {
</span><span class='line'>    let amountToPad = count - countElements(string)
</span><span class='line'>    for _ in 1...amountToPad {
</span><span class='line'>        string = pad + string
</span><span class='line'>    }
</span><span class='line'>    return string
</span><span class='line'>}
</span><span class='line'>let originalString = "hello"
</span><span class='line'>let paddedString = alignRight(originalString, 10, "-")
</span><span class='line'>// paddedString is equal to "-----hello"
</span><span class='line'>// originalString is still equal to "helloâ€</span></code></pre></td></tr></table></div></figure>


<h5>In-Outå‚æ•°</h5>

<p>æ¥çœ‹ä¸ªdemoå°±æ˜ç™½In-Outæ˜¯å¦‚ä½•ä½¿ç”¨çš„äº†</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func swapTwoInts(inout a: Int, inout b: Int) {
</span><span class='line'>    let temporaryA = a
</span><span class='line'>    a = b
</span><span class='line'>    b = temporaryA
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>var someInt = 3
</span><span class='line'>var anotherInt = 107
</span><span class='line'>swapTwoInts(&someInt, &anotherInt)
</span><span class='line'>println("someInt is now \(someInt), and anotherInt is now \(anotherInt)")
</span><span class='line'>// prints "someInt is now 107, and anotherInt is now 3â€</span></code></pre></td></tr></table></div></figure>


<p>éœ€è¦æ³¨æ„çš„æ˜¯In-outå‚æ•°ä¸èƒ½æœ‰é»˜è®¤å€¼,variadicå‚æ•°ä¸èƒ½ä¸inoutä¸€èµ·ä½¿ç”¨,letä¹Ÿä¸è¡Œ</p>

<h5>å‡½æ•°ç±»å‹</h5>

<p>å¯ä»¥åƒä»¥ä¸‹è¿™ä¹ˆç”¨</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var mathFunction: (Int, Int) -&gt; Int = addTwoInts
</span><span class='line'>println("Result: \(mathFunction(2, 3))")</span></code></pre></td></tr></table></div></figure>


<p>åŒæ ·çš„å‡½æ•°ç­¾åä¹Ÿå¯ä»¥èµ‹å€¼</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mathFunction = multiplyTwoInts
</span><span class='line'>println("Result: \(mathFunction(2, 3))")
</span><span class='line'>// prints "Result: 6</span></code></pre></td></tr></table></div></figure>


<p>ä¹Ÿå¯ä»¥æ ¹æ®Swiftçš„è‡ªåŠ¨æ¨æ–­åŠŸèƒ½åƒä»¥ä¸‹æ–¹æ³•ä½¿ç”¨</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let anotherMathFunction = addTwoInts</span></code></pre></td></tr></table></div></figure>


<h5>å……å½“å‚æ•°çš„å‡½æ•°ç±»å‹</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func printMathResult(mathFunction: (Int, Int) -&gt; Int, a: Int, b: Int) {
</span><span class='line'>    println("Result: \(mathFunction(a, b))")
</span><span class='line'>}
</span><span class='line'>printMathResult(addTwoInts, 3, 5)
</span><span class='line'>// prints "Result: 8â€</span></code></pre></td></tr></table></div></figure>


<h5>ä½œä¸ºè¿”å›ç±»å‹çš„å‡½æ•°ç±»å‹</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func stepForward(input: Int) -&gt; Int {
</span><span class='line'>    return input + 1
</span><span class='line'>}
</span><span class='line'>func stepBackward(input: Int) -&gt; Int {
</span><span class='line'>    return input - 1
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>func chooseStepFunction(backwards: Bool) -&gt; (Int) -&gt; Int {
</span><span class='line'>    return backwards ? stepBackward : stepForward
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>var currentValue = 3
</span><span class='line'>let moveNearerToZero = chooseStepFunction(currentValue &gt; 0)
</span><span class='line'>// moveNearerToZero now refers to the stepBackward() function
</span><span class='line'>
</span><span class='line'>println("Counting to zero:")
</span><span class='line'>// Counting to zero:
</span><span class='line'>while currentValue != 0 {
</span><span class='line'>    println("\(currentValue)... ")
</span><span class='line'>    currentValue = moveNearerToZero(currentValue)
</span><span class='line'>}
</span><span class='line'>println("zero!")
</span><span class='line'>// 3...
</span><span class='line'>// 2...
</span><span class='line'>// 1...
</span><span class='line'>// zero!</span></code></pre></td></tr></table></div></figure>


<h5>åµŒå¥—å‡½æ•°</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func chooseStepFunction(backwards: Bool) -&gt; (Int) -&gt; Int {
</span><span class='line'>    func stepForward(input: Int) -&gt; Int { return input + 1 }
</span><span class='line'>    func stepBackward(input: Int) -&gt; Int { return input - 1 }
</span><span class='line'>    return backwards ? stepBackward : stepForward
</span><span class='line'>}
</span><span class='line'>var currentValue = -4
</span><span class='line'>let moveNearerToZero = chooseStepFunction(currentValue &gt; 0)
</span><span class='line'>// moveNearerToZero now refers to the nested stepForward() function
</span><span class='line'>while currentValue != 0 {
</span><span class='line'>    println("\(currentValue)... ")
</span><span class='line'>    currentValue = moveNearerToZero(currentValue)
</span><span class='line'>}
</span><span class='line'>println("zero!")
</span><span class='line'>// -4...
</span><span class='line'>// -3...
</span><span class='line'>// -2...
</span><span class='line'>// -1...
</span><span class='line'>// zero!</span></code></pre></td></tr></table></div></figure>


<h4>é—­åŒ…</h4>

<p>ç±»ä¼¼OCä¸­çš„block</p>

<h5>Sortå‡½æ•°</h5>

<p>ç¬¬ä¸€ç§ä½¿ç”¨æ–¹å¼</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let names = ["Chris", "Alex", "Ewa", "Barry", "Daniella"]
</span><span class='line'>//demo 1
</span><span class='line'>func backwards(s1: String, s2: String) -&gt; Bool {
</span><span class='line'>    return s1 &gt; s2
</span><span class='line'>}
</span><span class='line'>var reversed = sort(names, backwards)</span></code></pre></td></tr></table></div></figure>


<p>ç¬¬äºŒç§</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>reversed = sort(names, { (s1: String, s2: String) -&gt; Bool in
</span><span class='line'>    return s1 &gt; s2
</span><span class='line'>    })</span></code></pre></td></tr></table></div></figure>


<p>closureçš„bodyå’Œå£°æ˜ç”¨inå…³é”®è¯åˆ†éš”å¼€æ¥</p>

<h5>Inferring Type From Context</h5>

<p>ç”±äºsortçš„closureæ˜¯ä»¥å‚æ•°çš„å½¢å¼ä¼ å…¥å‡½æ•°ï¼Œæ‰€ä»¥swiftèƒ½ä»æ¨æµ‹å‡ºé—­åŒ…çš„å‚æ•°ç±»å‹å’Œè¿”å›å€¼ç±»å‹,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŒ‰ä»¥ä¸‹æ–¹å¼æ¥å†™</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>reversed = sort(names, { s1, s2 in return s1 &gt; s2 } )</span></code></pre></td></tr></table></div></figure>


<p>ä¹Ÿå¯ä»¥çœç•¥return,å› ä¸ºé»˜è®¤æ˜¯æœ‰returnè¿™ä¸ªå…³é”®å­—çš„</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>reversed = sort(names, { s1, s2 in  s1 &gt; s2 } )</span></code></pre></td></tr></table></div></figure>


<h5>Shorthand Argument Names</h5>

<p>Swifté»˜è®¤ä¸ºå†…è”çš„å‚æ•°åæŒ‡å®šäº†è¯¸å¦‚$0, $1ç­‰åå­—
If you use these shorthand argument names within your closure expression, you can omit the closureâ€™s argument list from its definition, and the number and type of the shorthand argument names will be inferred from the expected function type. The in keyword can also be omitted, because the closure expression is made up entirely of its body:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>reversed = sort(names, { $0 &gt; $1 } )</span></code></pre></td></tr></table></div></figure>


<p>ä»¥ä¸Šçš„demoä¸­,$0å’Œ$1åˆ†åˆ«æŒ‡å‘äº†é—­åŒ…çš„ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªStringå‚æ•°</p>

<h5>Operators Function</h5>

<p>Thereâ€™s actually an even shorter way to write the closure expression above. Swiftâ€™s String type defines its string-specific implementation of the greater-than operator (>) as a function that has two parameters of type String, and returns a value of type Bool. This exactly matches the function type needed for the sort functionâ€™s second parameter. Therefore, you can simply pass in the greater-than operator, and Swift will infer that you want to use its string-specific implementation:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>reversed = sort(names, &gt;)</span></code></pre></td></tr></table></div></figure>


<h5>Trailing Closures</h5>

<p>å¦‚æœä½ å°†ä¸€ä¸ªé—­åŒ…æŒ‡å®šä¸ºä¸€ä¸ªå‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°ï¼Œå¹¶ä¸”è¿™ä¸ªé—­åŒ…è¡¨è¾¾å¼å¾ˆé•¿ï¼Œä½ å¯ä»¥å°†å®ƒä½œä¸ºä¸€ä¸ªtrailing closure,å®ƒæ˜¯ä¸€ä¸ªå†™åœ¨å‡½æ•°çš„æ‹¬å·ä¹‹å¤–çš„closure</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func someFunctionThatTakesAClosure(closure: () -&gt; ()) {
</span><span class='line'>    // function body goes here
</span><span class='line'>}
</span><span class='line'> 
</span><span class='line'>// here's how you call this function without using a trailing closure:
</span><span class='line'> 
</span><span class='line'>someFunctionThatTakesAClosure({
</span><span class='line'>    // closure's body goes here
</span><span class='line'>    })
</span><span class='line'> 
</span><span class='line'>// here's how you call this function with a trailing closure instead:
</span><span class='line'> 
</span><span class='line'>someFunctionThatTakesAClosure() {
</span><span class='line'>    // trailing closure's body goes here
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p><code>æ³¨æ„</code>:å¦‚æœä¸€ä¸ªclosure expressionæ˜¯ä¸€ä¸ªå‡½æ•°çš„æƒŸå‚æ•°,åˆ™æ— éœ€è¦æ‹¬å·ï¼Œæ•…ä»¥ä¸Šä¹Ÿå¯ä»¥å†™æˆ</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>someFunctionThatTakesAClosure {
</span><span class='line'>    // trailing closure's body goes here
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>æ¥çœ‹ä¸€ä¸ªArrayä¸­çš„mapæ–¹æ³•çš„ä¾‹å­ï¼Œåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªclosure</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let digitNames = [
</span><span class='line'>    0: "Zero", 1: "One", 2: "Two",   3: "Three", 4: "Four",
</span><span class='line'>    5: "Five", 6: "Six", 7: "Seven", 8: "Eight", 9: "Nine"
</span><span class='line'>]
</span><span class='line'>let numbers = [16, 58, 510]
</span><span class='line'>
</span><span class='line'>let strings = numbers.map {
</span><span class='line'>    (var number) -&gt; String in
</span><span class='line'>    var output = ""
</span><span class='line'>    while number &gt; 0 {
</span><span class='line'>        output = digitNames[number % 10]! + output
</span><span class='line'>        number /= 10
</span><span class='line'>    }
</span><span class='line'>    return output
</span><span class='line'>}
</span><span class='line'>// strings is inferred to be of type String[]
</span><span class='line'>// its value is ["OneSix", "FiveEight", "FiveOneZero"]</span></code></pre></td></tr></table></div></figure>


<h5>Capturing Values</h5>

<p>Swiftä¸­closureçš„æœ€ç®€å•å½¢å¼æ˜¯ä¸€ä¸ªå†…åµŒçš„å‡½æ•°</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func makeIncrementor(forIncrement amount: Int) -&gt; () -&gt; Int {
</span><span class='line'>    var runningTotal = 0
</span><span class='line'>    func incrementor() -&gt; Int {
</span><span class='line'>        runningTotal += amount
</span><span class='line'>        return runningTotal
</span><span class='line'>    }
</span><span class='line'>    return incrementor
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>because it modifies the runningTotal variable each time it is called, incrementor captures a reference to the current runningTotal variable, and not just a copy of its initial value. Capturing a reference ensures sure that runningTotal does not disappear when the call to makeIncrementor ends, and ensures that runningTotal will continue to be available the next time that the incrementor function is called.
æ³¨æ„ä»¥ä¸‹çš„è°ƒç”¨</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let incrementByTen = makeIncrementor(forIncrement: 10)
</span><span class='line'>
</span><span class='line'>incrementByTen()
</span><span class='line'>// returns a value of 10
</span><span class='line'>incrementByTen()
</span><span class='line'>// returns a value of 20
</span><span class='line'>incrementByTen()
</span><span class='line'>// returns a value of 30</span></code></pre></td></tr></table></div></figure>


<p>If you create another incrementor, it will have its own stored reference to a new, separate runningTotal variable</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let incrementBySeven = makeIncrementor(forIncrement: 7)
</span><span class='line'>incrementBySeven()
</span><span class='line'>// returns a value of 7
</span><span class='line'>incrementByTen()
</span><span class='line'>// returns a value of 40</span></code></pre></td></tr></table></div></figure>


<p>incrementByTenæ•è·çš„å˜é‡ä¸incrementBySevenæ•è·çš„æ— å…³</p>

<h5>Closureæ˜¯å¼•ç”¨ç±»å‹</h5>

<p>ä¹Ÿå°±æ˜¯è¯´å¦‚æœä½ å°†closureèµ‹ç»™ä¸¤ä¸ªä¸åŒçš„å¸¸é‡æˆ–å˜é‡ï¼Œè¿™ä¸¤ä¸ªå¸¸é‡æˆ–å˜é‡å°†æŒ‡å‘ä¸€æ ·çš„closure</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let alsoIncrementByTen = incrementByTen
</span><span class='line'>alsoIncrementByTen()
</span><span class='line'>// returns a value of 50</span></code></pre></td></tr></table></div></figure>


<h4>Enumerations</h4>

<p>Enumerations in Swift are first-class types in their own right. They adopt many features traditionally supported only by classes, such as computed properties to provide additional information about the enumerationâ€™s current value, and instance methods to provide functionality related to the values the enumeration represents. Enumerations can also define initializers to provide an initial member value; can be extended to expand their functionality beyond their original implementation; and can conform to protocols to provide standard functionality.</p>

<h5>Enumeration Syntax</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>enum CompassPoint {
</span><span class='line'>    case North
</span><span class='line'>    case South
</span><span class='line'>    case East
</span><span class='line'>    case West
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p><code>æ³¨æ„</code></p>

<pre><code>    Unlike C and Objective-C, Swift enumeration members are not assigned a default integer value when they are created. In the CompassPoints example above, North, South, East and West do not implicitly equal 0, 1, 2 and 3. Instead, the different enumeration members are fully-fledged values in their own right, with an explicitly-defined type of CompassPoint.
</code></pre>

<p>å¤šä¸ªæˆå‘˜å€¼å¯ä»¥å‡ºç°åœ¨åŒä¸€è¡Œä¸Šï¼Œç”¨<code>,</code>åˆ†å¼€</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>enum Planet {
</span><span class='line'>    case Mercury, Venus, Earth, Mars, Jupiter, Saturn, Uranus, Neptune
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>æ¥çœ‹ä»¥ä¸‹ä¾‹å­</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var directionToHead = CompassPoint.West
</span><span class='line'>directionToHead = .East</span></code></pre></td></tr></table></div></figure>


<p>ä¸€æ—¦çŸ¥é“äº†directionToHeadçš„ç±»å‹ï¼Œå®ƒçš„type(CompassPoint)å¯ä»¥çœç•¥</p>

<h5>Switch..case</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>directionToHead = .South
</span><span class='line'>switch directionToHead {
</span><span class='line'>case .North:
</span><span class='line'>    println("Lots of planets have a north")
</span><span class='line'>case .South:
</span><span class='line'>    println("Watch out for penguins")
</span><span class='line'>case .East:
</span><span class='line'>    println("Where the sun rises")
</span><span class='line'>case .West:
</span><span class='line'>    println("Where the skies are blue")
</span><span class='line'>}
</span><span class='line'>// prints "Watch out for penguins</span></code></pre></td></tr></table></div></figure>


<h5>Associated Values</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>enum Barcode {
</span><span class='line'>    case UPCA(Int, Int, Int)
</span><span class='line'>    case QRCode(String)
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>var productBarcode = Barcode.UPCA(8, 85909_51226, 3)
</span><span class='line'>productBarcode = .QRCode("ABCDEFGHIJKLMNOP")
</span><span class='line'>
</span><span class='line'>switch productBarcode {
</span><span class='line'>case .UPCA(let numberSystem, let identifier, let check):
</span><span class='line'>    println("UPC-A with value of \(numberSystem), \(identifier), \(check).")
</span><span class='line'>case .QRCode(let productCode):
</span><span class='line'>    println("QR code with value of \(productCode).")
</span><span class='line'>}
</span><span class='line'>// prints "QR code with value of ABCDEFGHIJKLMNOP.â€</span></code></pre></td></tr></table></div></figure>


<p>If all of the associated values for a enumeration member are extracted as constants, or if all are extracted as variables, you can place a single var or let annotation before the member name, for brevity:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>switch productBarcode {
</span><span class='line'>case let .UPCA(numberSystem, identifier, check):
</span><span class='line'>    println("UPC-A with value of \(numberSystem), \(identifier), \(check).")
</span><span class='line'>case let .QRCode(productCode):
</span><span class='line'>    println("QR code with value of \(productCode).")
</span><span class='line'>}
</span><span class='line'>// prints "QR code with value of ABCDEFGHIJKLMNOP.â€</span></code></pre></td></tr></table></div></figure>


<h5>Raw Values</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>enum ASCIIControlCharacter: Character {
</span><span class='line'>    case Tab = "\t"
</span><span class='line'>    case LineFeed = "\n"
</span><span class='line'>    case CarriageReturn = "\r"
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>The raw value for a particular enumeration member is always the same. Associated values are set when you create a new constant or variable based on one of the enumerationâ€™s members, and can be different each time you do so.
æ³¨æ„ï¼Œå¦‚æœæ•´å‹è¢«ç”¨æ¥ä½œä¸ºraw values,å¦‚æœå…¶ä»–enumeration memberæ— å€¼ï¼Œåˆ™å…¶ä»–çš„å°†ä¼šè‡ªåŠ¨å¢é•¿</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>enum Planet: Int {
</span><span class='line'>    case Mercury = 1, Venus, Earth, Mars, Jupiter, Saturn, Uranus, Neptune
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>.venus = 2,&hellip;ä¾æ­¤ç±»æ¨
ç”¨toRawæ–¹æ³•æ¥è·å–ä¸€ä¸ªenumeration memberçš„rawValueå€¼</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let earthsOrder = Planet.Earth.toRaw()
</span><span class='line'>// earthsOrder is 3</span></code></pre></td></tr></table></div></figure>


<p>ç”¨fromRawæ¥è·å–æ‹¥æœ‰ä¸€ä¸ªraw valueçš„enumberation member</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let possiblePlanet = Planet.fromRaw(7)</span></code></pre></td></tr></table></div></figure>


<p>æ³¨æ„fromRawè¿”å›çš„æ˜¯optional value,æ‰€ä»¥å¯ä»¥åƒå¦‚ä¸‹è¿™ä¸ªå†™</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let positionToFind = 9
</span><span class='line'>if let somePlanet = Planet.fromRaw(positionToFind) {
</span><span class='line'>    switch somePlanet {
</span><span class='line'>    case .Earth:
</span><span class='line'>        println("Mostly harmless")
</span><span class='line'>    default:
</span><span class='line'>        println("Not a safe place for humans")
</span><span class='line'>    }
</span><span class='line'>} else {
</span><span class='line'>    println("There isn't a planet at position \(positionToFind)")
</span><span class='line'>}
</span><span class='line'>// prints "There isn't a planet at position 9â€</span></code></pre></td></tr></table></div></figure>


<h4>Classeså’ŒStructures</h4>

<p>Unlike other programming languages, Swift does not require you to create separate interface and implementation files for custom classes and structures. In Swift, you define a class or a structure in a single file, and the external interface to that class or structure is automatically made available for other code to use.</p>

<h5>äºŒè€…çš„æ¯”è¾ƒ</h5>

<p>å…±åŒä¹‹å¤„</p>

<ul>
<li>Define properties to store values</li>
<li>Define methods to provide functionality</li>
<li>Define subscripts to provide access to their values using subscript syntax</li>
<li>Define initializers to set up their initial state</li>
<li>Be extended to expand their functionality beyond a default implementation</li>
<li><p>Conform to protocols to provide standard functionality of a certain kind
ç±»æœ‰çš„ï¼Œè€ŒStructureæœ¨æœ‰çš„</p></li>
<li><p>Inheritance enables one class to inherit the characteristics of another.</p></li>
<li>Type casting enables you to check and interpret the type of a class instance at runtime.</li>
<li>Deinitializers enable an instance of a class to free up any resources it has assigned.</li>
<li>Reference counting allows more than one reference to a class instance.
<code>æ³¨æ„</code>Structuresæ€»æ˜¯è¢«copiesçš„è€Œä¸ç”¨å¼•ç”¨è®¡æ•°

<h5>è¯­æ³•å®šä¹‰</h5></li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>struct Resolution {
</span><span class='line'>    var width = 0
</span><span class='line'>    var height = 0
</span><span class='line'>}
</span><span class='line'>class VideoMode {
</span><span class='line'>    var resolution = Resolution()
</span><span class='line'>    var interlaced = false
</span><span class='line'>    var frameRate = 0.0
</span><span class='line'>    var name: String?
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h5>Class and Structures Instances</h5>

<p>åˆ›å»ºå¯¹è±¡å®ä¾‹</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let someResolution = Resolution()
</span><span class='line'>let someVideoMode = VideoMode()</span></code></pre></td></tr></table></div></figure>


<h5>è®¿é—®å±æ€§</h5>

<p>å¯ä»¥å±‚å±‚è®¿é—®ï¼Œæ³¨æ„ä»¥ä¸‹</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>println("The width of someVideoMode is \(someVideoMode.resolution.width)")
</span><span class='line'>// prints "The width of someVideoMode is 0â€</span></code></pre></td></tr></table></div></figure>


<p><code>æ³¨æ„</code>
Unlike Objective-C, Swift enables you to set sub-properties of a structure property directly. In the last example above, the width property of the resolution property of someVideoMode is set directly, without your needing to set the entire resolution property to a new value.</p>

<h5>Memberwise Initializers for Structure Types</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let vga = Resolution(width: 640, height: 480)</span></code></pre></td></tr></table></div></figure>


<p>ä¸è¿‡ä¸åƒstructures,ç±»çš„å¯¹è±¡åˆå§‹åŒ–æ—¶æ²¡æœ‰è¿™æ ·é»˜è®¤çš„æˆå‘˜åˆå§‹åŒ–</p>

<h4>Structuså’ŒEnumerationsæ˜¯å€¼ç±»å‹</h4>

<p>ä¹Ÿå°±æ˜¯è¯´å½“å®ƒèµ‹ç»™ä¸€ä¸ªå˜é‡æˆ–ä¸“ç»™å‡½æ•°æ—¶ï¼Œå®ƒä»¬æ˜¯copyçš„
å®é™…ä¸Š,Swiftä¸­çš„æ‰€æœ‰åŸºæœ¬ç±»å‹ï¼Œæ•´å‹ï¼Œæµ®ç‚¹å‹ï¼Œboolå‹ï¼Œstringï¼Œarrayå’Œdictionaryéƒ½æ˜¯å€¼ç±»å‹ï¼Œä¸è¿‡å¹•åéƒ½ä»¥structureçš„å½¢å¼å‘ˆç°
demo</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>enum CompassPoint {
</span><span class='line'>    case North, South, East, West
</span><span class='line'>}
</span><span class='line'>var currentDirection = CompassPoint.West
</span><span class='line'>let rememberedDirection = currentDirection
</span><span class='line'>currentDirection = .East
</span><span class='line'>if rememberedDirection == .West {
</span><span class='line'>    println("The remembered direction is still .West")
</span><span class='line'>}
</span><span class='line'>// prints "The remembered direction is still .Westâ€</span></code></pre></td></tr></table></div></figure>


<h4>ç±»æ˜¯å¼•ç”¨ç±»å‹</h4>

<p>æˆ‘ä»¬å¯ä»¥åˆ¤æ–­ä¸¤ä¸ªå˜é‡æ˜¯å¦æŒ‡å‘åŒä¸€ä¸ªç±»çš„å¯¹è±¡
å¯ä»¥ç”¨<code>===</code></p>

<h4>é€‰æ‹©ç±»æˆ–æ˜¯Structure</h4>

<p>structureæ€»æ˜¯æŒ‰å€¼ä¼ é€’ï¼Œclassæ€»æ˜¯æŒ‰å¼•ç”¨ä¼ é€’</p>

<h4>Assignment and Copy Behavior for Collection Types</h4>

<ul>
<li>Assignment and Copy Behavior for Dictionaries
å½“ä½ å°†ä¸€ä¸ªdictionaryèµ‹äºˆä¸€ä¸ªå¸¸é‡æˆ–å˜é‡ï¼Œæˆ–è€…å°†å®ƒä¼ å…¥å‡½æ•°æ—¶,dictionaryå°±è¢«copiedäº†
å¦‚æœkeys/valuesæ˜¯å€¼ç±»å‹,å®ƒä»¬ä¹Ÿåœ¨èµ‹å€¼æˆ–ä½œä¸ºå‚æ•°ä¼ å…¥å‡½æ•°æ—¶ä¹Ÿè¢«copyäº†ï¼Œä¸è¿‡å¦‚æœå®ƒä»¬æ˜¯å¼•ç”¨ç±»å‹çš„è¯ï¼Œåªæ˜¯å¼•ç”¨copyäº†ï¼Œå¯¹è±¡å¹¶æœªè¢«copyï¼Œè¿™ç§copyè§„åˆ™ä¸ä¸€ä¸ªstructureçš„propertiesä¸€æ ·ï¼Œå¦‚æœstructureè¢«copyçš„è¯</li>
<li>Assignment and Copy Behavior for Arrays
arrayçš„copyè§„åˆ™ä¸dictionaryçš„å¤§å¤§ä¸åŒ!arrayçš„copyåªå‘ç”Ÿåœ¨ä½ æ‰€åšçš„ä¿®æ”¹ä¼šæ”¹å˜arrayçš„å¤§å°çš„æ—¶å€™</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var a = [1, 2, 3]
</span><span class='line'>var b = a
</span><span class='line'>var c = a
</span><span class='line'>
</span><span class='line'>a[0] = 42
</span><span class='line'>println(a[0])
</span><span class='line'>// 42
</span><span class='line'>println(b[0])
</span><span class='line'>// 42
</span><span class='line'>println(c[0])
</span><span class='line'>// 42
</span><span class='line'>
</span><span class='line'>a.append(4)
</span><span class='line'>a[0] = 777
</span><span class='line'>println(a[0])
</span><span class='line'>// 777
</span><span class='line'>println(b[0])
</span><span class='line'>// 42
</span><span class='line'>println(c[0])
</span><span class='line'>// 42</span></code></pre></td></tr></table></div></figure>


<h4>ç¡®ä¿arrayæ˜¯å”¯ä¸€çš„</h4>

<p>é€šè¿‡å¯¹ä¸€ä¸ªarrayçš„å˜é‡è°ƒç”¨unshareæ–¹æ³•ï¼Œä½ èƒ½ç¡®ä¿è¿™ä¸ªè¿™ä¸ªå˜é‡å¯¹è¿™ä¸ªarrayçš„å”¯ä¸€æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæœ‰å¤šä¸ªå˜é‡æŒ‡å‘åŒä¸€ä¸ªarray,å¦‚æœä½ å¯¹å…¶ä¸­çš„æŸä¸€ä¸ªå˜é‡è°ƒç”¨unshareæ–¹æ³•ï¼Œè¿™ä¸ªarrayå°±è¢«copyäº†,æ‰€ä»¥è¿™ä¸ªå˜é‡æœ‰æ­¤arrayçš„ç‹¬ç«‹æ‹·è´,ä¸è¿‡å¦‚æœåªæœ‰ä¸€ä¸ªå˜é‡æŒ‡å‘æ­¤array,åˆ™copyä¸ä¼šå‘ç”Ÿ
åœ¨ä»¥ä¸Šçš„ä¾‹å­ä¸­,å‡è®¾æˆ‘ä»¬è°ƒç”¨äº†å¦‚ä¸‹è¯­å¥</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>b.unshare()</span></code></pre></td></tr></table></div></figure>


<p>åˆ™ç»“æœå¦‚ä¸‹</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>b[0] = -105
</span><span class='line'>println(a[0])
</span><span class='line'>// 777
</span><span class='line'>println(b[0])
</span><span class='line'>// -105
</span><span class='line'>println(c[0])
</span><span class='line'>// 42</span></code></pre></td></tr></table></div></figure>


<h5>Checking Whether Two Arrays Share the Same Elements</h5>

<p>Check whether two arrays or subarrays share the same storage and elements by comparing them with the identity operators (=== and !==).</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>if b === c {
</span><span class='line'>    println("b and c still share the same array elements.")
</span><span class='line'>} else {
</span><span class='line'>    println("b and c now refer to two independent sets of array elements.")
</span><span class='line'>}
</span><span class='line'>// prints "b and c now refer to two independent sets of array elements.</span></code></pre></td></tr></table></div></figure>


<p>Alternatively, use the identity operators to check whether two subarrays share the same elements. The example below compares two identical subarrays from b and confirms that they refer to the same elements:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>if b[0...1] === b[0...1] {
</span><span class='line'>    println("These two subarrays share the same elements.")
</span><span class='line'>} else {
</span><span class='line'>    println("These two subarrays do not share the same elements.")
</span><span class='line'>}
</span><span class='line'>// prints "These two subarrays share the same elements.â€</span></code></pre></td></tr></table></div></figure>


<h5>å¼ºåˆ¶arrayçš„copy</h5>

<p>è°ƒç”¨arrayçš„copyæ–¹æ³•,è¿™ä¸ªæ–¹æ³•åªæ˜¯å¯¹arrayè¿›è¡Œ<code>æµ…å¤åˆ¶</code></p>

<h4>Properties</h4>

<p>Properties associate values with a particular class, structure, or enumeration. Stored properties store constant and variable values as part of an instance, whereas computed properties calculate (rather than store) a value. Computed properties are provided by classes, structures, and enumerations. Stored properties are provided only by classes and structures.</p>

<p>Stored and computed properties are usually associated with instances of a particular type. However, properties can also be associated with the type itself. Such properties are known as type properties.</p>

<p>In addition, you can define property observers to monitor changes in a propertyâ€™s value, which you can respond to with custom actions. Property observers can be added to stored properties you define yourself, and also to properties that a subclass inherits from its superclass.</p>

<h5>Stored Properties</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>struct FixedLengthRange {
</span><span class='line'>    var firstValue: Int
</span><span class='line'>    let length: Int
</span><span class='line'>}
</span><span class='line'>var rangeOfThreeItems = FixedLengthRange(firstValue: 0, length: 3)
</span><span class='line'>// the range represents integer values 0, 1, and 2
</span><span class='line'>rangeOfThreeItems.firstValue = 6
</span><span class='line'>// the range now represents integer values 6, 7, and 8</span></code></pre></td></tr></table></div></figure>


<h5>Stored Properties of Constant Structure Instances</h5>

<p>å¦‚æœä½ åˆ›å»ºäº†ä¸€ä¸ªstructureçš„instanceï¼Œå¹¶ä¸”å°†è¿™ä¸ªinstanceèµ‹äºˆä¸€ä¸ªå¸¸é‡,ä½ ä¸èƒ½é€šè¿‡è¿™ä¸ªå¸¸é‡ä¿®æ”¹è¿™ä¸ªinstanceçš„properties,å³ä½¿å®ƒä»¬è¢«å£°æ˜ä¸ºvariable properties</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>let rangeOfFourItems = FixedLengthRange(firstValue: 0, length: 4)
</span><span class='line'>// this range represents integer values 0, 1, 2, and 3
</span><span class='line'>rangeOfFourItems.firstValue = 6
</span><span class='line'>// this will report an error, even thought firstValue is a variable property</span></code></pre></td></tr></table></div></figure>


<p>è¿™æ˜¯å› ä¸ºstructureæ˜¯å€¼ç±»å‹çš„ç¼˜æ•…,å¦‚æœä¸€ä¸ªå€¼ç±»å‹çš„instanceè¢«æ ‡è®°ä¸ºå¸¸é‡ï¼Œåˆ™å®ƒçš„propertyä¹Ÿæ˜¯
ä¸è¿‡classä¸æ­¤ä¸åŒï¼Œclassç…§æ ·å¯ä¿®æ”¹instanceçš„variable propertiesï¼Œæ—¢ç„¶å®ƒè¢«èµ‹å€¼ä¸ºä¸€ä¸ªå¸¸é‡</p>

<h5>Lazy Stored Properties</h5>

<p>A lazy stored property is a property whose initial value is not calculated until the first time it is used. You indicate a lazy stored property by writing the @lazy attribute before its declaration.</p>

<p><code>æ³¨æ„</code>
You must always declare a lazy property as a variable (with the var keyword), because its initial value may not be retrieved until after instance initialization completes. Constant properties must always have a value before initialization completes, and therefore cannot be declared as lazy.</p>

<p>Lazy properties are useful when the initial value for a property is dependent on outside factors whose values are not known until after an instanceâ€™s initialization is complete. Lazy properties are also useful when the initial value for a property requires complex or computationally expensive setup that should not be performed unless or until it is needed.</p>

<p>The example below uses a lazy stored property to avoid unnecessary initialization of a complex class. This example defines two classes called DataImporter and DataManager, neither of which is shown in full:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class DataImporter {
</span><span class='line'>    /*
</span><span class='line'>    DataImporter is a class to import data from an external file.
</span><span class='line'>    The class is assumed to take a non-trivial amount of time to initialize.
</span><span class='line'>    */
</span><span class='line'>    var fileName = "data.txt"
</span><span class='line'>    // the DataImporter class would provide data importing functionality here
</span><span class='line'>}
</span><span class='line'> 
</span><span class='line'>class DataManager {
</span><span class='line'>    @lazy var importer = DataImporter()
</span><span class='line'>    var data = String[]()
</span><span class='line'>    // the DataManager class would provide data management functionality here
</span><span class='line'>}
</span><span class='line'> 
</span><span class='line'>let manager = DataManager()
</span><span class='line'>manager.data += "Some data"
</span><span class='line'>manager.data += "Some more data"
</span><span class='line'>// the DataImporter instance for the importer property has not yet been created</span></code></pre></td></tr></table></div></figure>


<p>åªæœ‰åœ¨importerçš„propertyé¦–æ¬¡è¢«è®¿é—®çš„æ—¶å€™ï¼Œimporteræ‰è¢«åˆ›å»º</p>

<h4>Computed Properties</h4>

<p>ä¸»è¦ç”¨æ¥è®¡ç®—ï¼Œè€Œéå­˜å‚¨ï¼Œä¸»è¦æä¾›äº†ä¸€ä¸ªgetterå’Œä¸€ä¸ªå¯é€‰çš„setter</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>struct Point {
</span><span class='line'>    var x = 0.0, y = 0.0
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>struct Size {
</span><span class='line'>    var width = 0.0, height = 0.0
</span><span class='line'>}
</span><span class='line'>struct Rect {
</span><span class='line'>    var origin = Point()
</span><span class='line'>    var size = Size()
</span><span class='line'>    var center: Point {
</span><span class='line'>    get {
</span><span class='line'>        let centerX = origin.x + (size.width / 2)
</span><span class='line'>        let centerY = origin.y + (size.height / 2)
</span><span class='line'>        return Point(x: centerX, y: centerY)
</span><span class='line'>    }
</span><span class='line'>    set(newCenter) {
</span><span class='line'>        origin.x = newCenter.x - (size.width / 2)
</span><span class='line'>        origin.y = newCenter.y - (size.height / 2)
</span><span class='line'>    }
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>var square = Rect(origin: Point(x: 0.0, y: 0.0),
</span><span class='line'>    size: Size(width: 10.0, height: 10.0))
</span><span class='line'>let initialSquareCenter = square.center
</span><span class='line'>square.center = Point(x: 15.0, y: 15.0)
</span><span class='line'>println("square.origin is now at (\(square.origin.x), \(square.origin.y))")
</span><span class='line'>// prints "square.origin is now at (10.0, 10.0)</span></code></pre></td></tr></table></div></figure>


<h5>Shorthand Setter Declaration</h5>

<p>å¦‚æœä¸€ä¸ªcomputed propertyçš„setterå¹¶ä¸ä¸ºæ–°å€¼å®šä¹‰ä¸€ä¸ªåå­—,åˆ™æ–°å€¼çš„é»˜è®¤åä¸ºnewValue</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>struct AlternativeRect {
</span><span class='line'>    var origin = Point()
</span><span class='line'>    var size = Size()
</span><span class='line'>    var center: Point {
</span><span class='line'>    get {
</span><span class='line'>        let centerX = origin.x + (size.width / 2)
</span><span class='line'>        let centerY = origin.y + (size.height / 2)
</span><span class='line'>        return Point(x: centerX, y: centerY)
</span><span class='line'>    }
</span><span class='line'>    set {
</span><span class='line'>        origin.x = newValue.x - (size.width / 2)
</span><span class='line'>        origin.y = newValue.y - (size.height / 2)
</span><span class='line'>    }
</span><span class='line'>    }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>åªè¯»çš„Computed Properties
ä¸€ä¸ªcomputed propertyå¦‚æœåªæœ‰ä¸€ä¸ªgetterï¼Œè€Œæ²¡æœ‰setterï¼Œåˆ™å®ƒè¢«ç§°ä¸ºread-only computed property,å®ƒåªèƒ½è¿”å›ä¸€ä¸ªå€¼(é€šè¿‡.)è€Œä¸èƒ½èµ‹å€¼</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>struct Cuboid {
</span><span class='line'>    var width = 0.0, height = 0.0, depth = 0.0
</span><span class='line'>    var volume: Double {
</span><span class='line'>    return width * height * depth
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>let fourByFiveByTwo = Cuboid(width: 4.0, height: 5.0, depth: 2.0)
</span><span class='line'>println("the volume of fourByFiveByTwo is \(fourByFiveByTwo.volume)")
</span><span class='line'>// prints "the volume of fourByFiveByTwo is 40.0â€</span></code></pre></td></tr></table></div></figure>


<p> <code>æ³¨æ„</code>ä½ å¿…é¡»ç”¨varæ¥å£°æ˜computed properties(å³ä½¿æ˜¯åªè¯»çš„ä¹Ÿä¸€æ ·),letåªç”¨äºconstant properties</p>

<p> #####Property Observer
Property observers observe and respond to changes in a propertyâ€™s value. Property observers are called every time a propertyâ€™s value is set, even if the new value is the same as the propertyâ€™s current value.</p>

<p>You can add property observers to any stored properties you define, apart from lazy stored properties. You can also add property observers to any inherited property (whether stored or computed) by overriding the property within a subclass</p>

<p><code>æ³¨æ„</code>
You donâ€™t need to define property observers for non-overridden computed properties, because you can observe and respond to changes to their value from directly within the computed propertyâ€™s setter.</p>

<p>you have the option to define either or both of these observers on a property:</p>

<ul>
<li>willSet is called just before the value is stored.</li>
<li>didSet is called immediately after the new value is stored.</li>
</ul>


<p>If you implement a willSet observer, it is passed the new property value as a constant parameter. You can specify a name for this parameter as part of your willSet implementation. If you choose not to write the parameter name and parentheses within your implementation, the parameter will still be made available with a default parameter name of newValue.</p>

<p>Similarly, if you implement a didSet observer, it will be passed a constant parameter containing the old property value. You can name the parameter if you wish, or use the default parameter name of oldValue.</p>

<p><code>æ³¨æ„</code>
willSet and didSet observers are not called when a property is first initialized. They are only called when the propertyâ€™s value is set outside of an initialization context.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class StepCounter {
</span><span class='line'>    var totalSteps: Int = 0 {
</span><span class='line'>    willSet(newTotalSteps) {
</span><span class='line'>        println("About to set totalSteps to \(newTotalSteps)")
</span><span class='line'>    }
</span><span class='line'>    didSet {
</span><span class='line'>        if totalSteps &gt; oldValue  {
</span><span class='line'>            println("Added \(totalSteps - oldValue) steps")
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>let stepCounter = StepCounter()
</span><span class='line'>stepCounter.totalSteps = 200
</span><span class='line'>// About to set totalSteps to 200
</span><span class='line'>// Added 200 steps
</span><span class='line'>stepCounter.totalSteps = 360
</span><span class='line'>// About to set totalSteps to 360
</span><span class='line'>// Added 160 steps
</span><span class='line'>stepCounter.totalSteps = 896
</span><span class='line'>// About to set totalSteps to 896
</span><span class='line'>// Added 536 steps</span></code></pre></td></tr></table></div></figure>


<p><code>æ³¨æ„</code>
If you assign a value to a property within its own didSet observer, the new value that you assign will replace the one that was just set</p>

<h4>å…¨å±€å’Œå±€éƒ¨å˜é‡</h4>

<p>The capabilities described above for computing and observing properties are also available to global variables and local variables.</p>

<p>The global and local variables you have encountered in previous chapters have all been stored variables. Stored variables, like stored properties, provide storage for a value of a certain type and allow that value to be set and retrieved.</p>

<p>However, you can also define computed variables and define observers for stored variables, in either a global or local scope. Computed variables calculate rather than store a value, and are written in the same way as computed properties.</p>

<p><code>æ³¨æ„</code>
Global constants and variables are always computed lazily, in a similar manner to Lazy Stored Properties. Unlike lazy stored properties, global constants and variables do not need to be marked with the @lazy attribute.</p>

<p>Local constants and variables are never computed lazily.</p>

<h4>Type Properties</h4>

<p>For value types (that is, structures and enumerations), you can define stored and computed type properties. For classes, you can define computed type properties only.</p>

<p>Stored type properties for value types can be variables or constants. Computed type properties are always declared as variable properties, in the same way as
computed instance properties.</p>

<p><code>æ³¨æ„</code>
Unlike stored instance properties, you must always give stored type properties a default value. This is because the type itself does not have an initializer that can assign a value to a stored type property at initialization time.</p>

<h5>Type propertyè¯­æ³•</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>struct SomeStructure {
</span><span class='line'>    static var storedTypeProperty = "Some value."
</span><span class='line'>    static var computedTypeProperty: Int {
</span><span class='line'>    // return an Int value here
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>enum SomeEnumeration {
</span><span class='line'>    static var storedTypeProperty = "Some value."
</span><span class='line'>    static var computedTypeProperty: Int {
</span><span class='line'>    // return an Int value here
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>class SomeClass {
</span><span class='line'>    class var computedTypeProperty: Int {
</span><span class='line'>    // return an Int value here
</span><span class='line'>    }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h5>Querying and Setting Type Properties</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>println(SomeClass.computedTypeProperty)
</span><span class='line'>// prints "42"
</span><span class='line'> 
</span><span class='line'>println(SomeStructure.storedTypeProperty)
</span><span class='line'>// prints "Some value."
</span><span class='line'>SomeStructure.storedTypeProperty = "Another value."
</span><span class='line'>println(SomeStructure.storedTypeProperty)
</span><span class='line'>// prints "Another value."</span></code></pre></td></tr></table></div></figure>


<p>å†æ¥çœ‹ä¸€ä¸ªä¾‹å­</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>struct AudioChannel {
</span><span class='line'>    static let thresholdLevel = 10
</span><span class='line'>    static var maxInputLevelForAllChannels = 0
</span><span class='line'>    var currentLevel: Int = 0 {
</span><span class='line'>    didSet {
</span><span class='line'>        if currentLevel &gt; AudioChannel.thresholdLevel {
</span><span class='line'>            // cap the new audio level to the threshold level
</span><span class='line'>            currentLevel = AudioChannel.thresholdLevel
</span><span class='line'>        }
</span><span class='line'>        if currentLevel &gt; AudioChannel.maxInputLevelForAllChannels {
</span><span class='line'>            // store this as the new overall maximum input level
</span><span class='line'>            AudioChannel.maxInputLevelForAllChannels = currentLevel
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>    }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p><code>æ³¨æ„</code>
In the first of these two checks, the didSet observer sets currentLevel to a different value. This does not, however, cause the observer to be called again.</p>

<h4>æ–¹æ³•</h4>

<p>ä¸Cä¸åŒ,Swiftä¸­çš„Structureå’Œenumerationsèƒ½å®šä¹‰æ–¹æ³•</p>

<h5>Instance Methods</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class Counter {
</span><span class='line'>    var count = 0
</span><span class='line'>    func increment() {
</span><span class='line'>        count++
</span><span class='line'>    }
</span><span class='line'>    func incrementBy(amount: Int) {
</span><span class='line'>        count += amount
</span><span class='line'>    }
</span><span class='line'>    func reset() {
</span><span class='line'>        count = 0
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>let counter = Counter()
</span><span class='line'>// the initial counter value is 0
</span><span class='line'>counter.increment()
</span><span class='line'>// the counter's value is now 1
</span><span class='line'>counter.incrementBy(5)
</span><span class='line'>// the counter's value is now 6
</span><span class='line'>counter.reset()
</span><span class='line'>// the counter's value is now 0</span></code></pre></td></tr></table></div></figure>


<h5>Local and External Parameter Names for Methods</h5>

<p>Function parameters can have both a local name (for use within the functionâ€™s body) and an external name (for use when calling the function)</p>

<p>The same is true for method parameters, because methods are just functions that are associated with a type. However, the default behavior of local names and external names is <code>different</code> for functions and methods.</p>

<p>Specifically, Swift gives the first parameter name in a method a local parameter name by default, and gives the second and subsequent parameter names both local and external parameter names by default.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class Counter {
</span><span class='line'>    var count: Int = 0
</span><span class='line'>    func incrementBy(amount: Int, numberOfTimes: Int) {
</span><span class='line'>        count += amount * numberOfTimes
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>let counter = Counter()
</span><span class='line'>counter.incrementBy(5, numberOfTimes: 3)
</span><span class='line'>// counter value is now 15</span></code></pre></td></tr></table></div></figure>


<p>This default behavior effectively treats the method as if you had written a hash symbol (#) before the numberOfTimes parameter:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func incrementBy(amount: Int, #numberOfTimes: Int) {
</span><span class='line'>    count += amount * numberOfTimes
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h5>Modifying External Parameter Name Behavior for Methods</h5>

<p>Sometimes itâ€™s useful to provide an external parameter name for a methodâ€™s first parameter, even though this is not the default behavior. You can either add an explicit external name yourself, or you can prefix the first parameterâ€™s name with a hash symbol to use the local name as an external name too.</p>

<p>Conversely, if you do not want to provide an external name for the second or subsequent parameter of a method, override the default behavior by using an underscore character (_) as an explicit external parameter name for that parameter.</p>

<h5>The self Property</h5>

<p>ä»¥ä¸Šçš„å¯ä»¥æ”¹æˆä»¥ä¸‹çš„</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>func increment() {
</span><span class='line'>    self.count++
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Swift assumes that you are referring to a property or method of the current instance whenever you use a known property or method name within a method.</p>

<p>The main exception to this rule occurs when a parameter name for an instance method has the same name as a property of that instance. In this situation, the parameter name takes precedence, and it becomes necessary to refer to the property in a more qualified way. You use the implicit self property to distinguish between the parameter name and the property name.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>struct Point {
</span><span class='line'>    var x = 0.0, y = 0.0
</span><span class='line'>    func isToTheRightOfX(x: Double) -&gt; Bool {
</span><span class='line'>        return self.x &gt; x
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>let somePoint = Point(x: 4.0, y: 5.0)
</span><span class='line'>if somePoint.isToTheRightOfX(1.0) {
</span><span class='line'>    println("This point is to the right of the line where x == 1.0")
</span><span class='line'>}
</span><span class='line'>// prints "This point is to the right of the line where x == 1.0â€</span></code></pre></td></tr></table></div></figure>


<h4>Modifying Value Types from Within Instance Methods</h4>

<p>Structures å’Œ enumerationséƒ½æ˜¯å€¼ç±»å‹,å€¼ç±»å‹çš„å±æ€§æ˜¯ä¸èƒ½åœ¨å®ƒçš„instanceæ–¹æ³•é‡Œä¿®æ”¹çš„,ä¸è¿‡ä½ å¯ä»¥åœ¨æ–¹æ³•åå‰åŠ mutatingæ¥å¯¹propertyè¿›è¡Œä¿®æ”¹</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>struct Point {
</span><span class='line'>    var x = 0.0, y = 0.0
</span><span class='line'>    mutating func moveByX(deltaX: Double, y deltaY: Double) {
</span><span class='line'>        x += deltaX
</span><span class='line'>        y += deltaY
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>var somePoint = Point(x: 1.0, y: 1.0)
</span><span class='line'>somePoint.moveByX(2.0, y: 3.0)
</span><span class='line'>println("The point is now at (\(somePoint.x), \(somePoint.y))")
</span><span class='line'>// prints "The point is now at (3.0, 4.0)â€</span></code></pre></td></tr></table></div></figure>


<p>The method can also assign a completely new instance to its implicit self property, and this new instance will replace the existing one when the method ends.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>struct Point {
</span><span class='line'>    var x = 0.0, y = 0.0
</span><span class='line'>    mutating func moveByX(deltaX: Double, y deltaY: Double) {
</span><span class='line'>        self = Point(x: x + deltaX, y: y + deltaY)
</span><span class='line'>    }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Mutating methods for enumerations can set the implicit self parameter to be a different member from the same enumeration:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>enum TriStateSwitch {
</span><span class='line'>    case Off, Low, High
</span><span class='line'>    mutating func next() {
</span><span class='line'>        switch self {
</span><span class='line'>        case Off:
</span><span class='line'>            self = Low
</span><span class='line'>        case Low:
</span><span class='line'>            self = High
</span><span class='line'>        case High:
</span><span class='line'>            self = Off
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>var ovenLight = TriStateSwitch.Low
</span><span class='line'>ovenLight.next()
</span><span class='line'>// ovenLight is now equal to .High
</span><span class='line'>ovenLight.next()
</span><span class='line'>// ovenLight is now equal to .Off</span></code></pre></td></tr></table></div></figure>


<h4>Type Methods</h4>

<p> å¯¹class,åœ¨æ–¹æ³•çš„funcå…³é”®å­—å‰åŠ class,å¯¹structureå’Œenumeration,åœ¨funcå‰åŠ static</p>

<p>  <code>æ³¨æ„</code>:In Objective-C, you can define type-level methods only for Objective-C classes. In Swift, you can define type-level methods for all classes, structures, and enumerations. Each type method is explicitly scoped to the type it supports.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>//å¯¹ç±»è€Œè¨€
</span><span class='line'>class SomeClass {
</span><span class='line'>    class func someTypeMethod() {
</span><span class='line'>        // type method implementation goes here
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>SomeClass.someTypeMethod()
</span><span class='line'>//å¯¹structureå’Œenumerationè€Œè¨€
</span></code></pre></td></tr></table></div></figure>


<p>åœ¨ä¸€ä¸ªtypeæ–¹æ³•çš„æ–¹æ³•ä½“é‡Œ,selfæŒ‡çš„æ˜¯typeæœ¬èº«</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>struct LevelTracker {
</span><span class='line'>    static var highestUnlockedLevel = 1
</span><span class='line'>    static func unlockLevel(level: Int) {
</span><span class='line'>        if level &gt; highestUnlockedLevel { highestUnlockedLevel = level }
</span><span class='line'>    }
</span><span class='line'>    static func levelIsUnlocked(level: Int) -&gt; Bool {
</span><span class='line'>        return level &lt;= highestUnlockedLevel
</span><span class='line'>    }
</span><span class='line'>    var currentLevel = 1
</span><span class='line'>    mutating func advanceToLevel(level: Int) -&gt; Bool {
</span><span class='line'>        if LevelTracker.levelIsUnlocked(level) {
</span><span class='line'>            currentLevel = level
</span><span class='line'>            return true
</span><span class='line'>        } else {
</span><span class='line'>            return false
</span><span class='line'>        }
</span><span class='line'>    }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>ä¸Playerç±»çš„ç»“åˆä½¿ç”¨</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class Player {
</span><span class='line'>    var tracker = LevelTracker()
</span><span class='line'>    let playerName: String
</span><span class='line'>    func completedLevel(level: Int) {
</span><span class='line'>        LevelTracker.unlockLevel(level + 1)
</span><span class='line'>        tracker.advanceToLevel(level + 1)
</span><span class='line'>    }
</span><span class='line'>    init(name: String) {
</span><span class='line'>        playerName = name
</span><span class='line'>    }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h4>Subscripts</h4>

<p>You can define multiple subscripts for a single type, and the appropriate subscript overload to use is selected based on the type of index value you pass to the subscript. Subscripts are not limited to a single dimension, and you can define subscripts with multiple input parameters to suit your custom typeâ€™s needs.</p>

<h5>Subscript Syntax</h5>

<p>ä¸åƒå…¶ä»–çš„instanceæ–¹æ³•,subscriptså¯ä»¥æ˜¯è¯»å†™çš„æˆ–æ˜¯åªè¯»çš„</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>subscript(index: Int) -&gt; Int {
</span><span class='line'>    get {
</span><span class='line'>        // return an appropriate subscript value here
</span><span class='line'>    }
</span><span class='line'>    set(newValue) {
</span><span class='line'>        // perform a suitable setting action here
</span><span class='line'>    }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>å¯¹äºåªè¯»çš„computed property,å¯¹åªè¯»çš„subscripts,æˆ‘ä»¬å¯ä»¥å»æ‰getå…³é”®å­—</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>subscript(index: Int) -&gt; Int {
</span><span class='line'>    // return an appropriate subscript value here
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>struct TimesTable {
</span><span class='line'>    let multiplier: Int
</span><span class='line'>    subscript(index: Int) -&gt; Int {
</span><span class='line'>        return multiplier * index
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>let threeTimesTable = TimesTable(multiplier: 3)
</span><span class='line'>println("six times three is \(threeTimesTable[6])")
</span><span class='line'>// prints "six times three is 18â€</span></code></pre></td></tr></table></div></figure>


<h5>Subscript Options</h5>

<p>Subscriptsèƒ½æ¥æ”¶ä»»æ„æ•°é‡çš„å‚æ•°ï¼Œå¹¶ä¸”è¿™äº›å‚æ•°å¯ä»¥æ˜¯ä»»æ„ç±»å‹çš„
Subscriptsèƒ½æ¥æ”¶variable å‚æ•° å’Œ variadic å‚æ•°,ä½†ä¸èƒ½ä½¿ç”¨in-outå‚æ•°æˆ–æ˜¯ä¸ºå‚æ•°æä¾›é»˜è®¤å€¼</p>

<p>A class or structure can provide as many subscript implementations as it needs, and the appropriate subscript to be used will be inferred based on the types of the value or values that are contained within the subscript braces at the point that the subscript is used. This definition of multiple subscripts is known as subscript overloading.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>struct Matrix {
</span><span class='line'>    let rows: Int, columns: Int
</span><span class='line'>    var grid: Double[]
</span><span class='line'>    init(rows: Int, columns: Int) {
</span><span class='line'>        self.rows = rows
</span><span class='line'>        self.columns = columns
</span><span class='line'>        grid = Array(count: rows * columns, repeatedValue: 0.0)
</span><span class='line'>    }
</span><span class='line'>    func indexIsValidForRow(row: Int, column: Int) -&gt; Bool {
</span><span class='line'>        return row &gt;= 0 && row &lt; rows && column &gt;= 0 && column &lt; columns
</span><span class='line'>    }
</span><span class='line'>    subscript(row: Int, column: Int) -&gt; Double {
</span><span class='line'>        get {
</span><span class='line'>            assert(indexIsValidForRow(row, column: column), "Index out of range")
</span><span class='line'>            return grid[(row * columns) + column]
</span><span class='line'>        }
</span><span class='line'>        set {
</span><span class='line'>            assert(indexIsValidForRow(row, column: column), "Index out of range")
</span><span class='line'>            grid[(row * columns) + column] = newValue
</span><span class='line'>        }
</span><span class='line'>     }
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>var matrix = Matrix(rows: 2, columns: 2)
</span><span class='line'>
</span><span class='line'>matrix[0, 1] = 1.5
</span><span class='line'>matrix[1, 0] = 3.2
</span><span class='line'>
</span><span class='line'>let someValue = matrix[2, 2]
</span><span class='line'>// this triggers an assert, because [2, 2] is outside of the matrix bounds
</span></code></pre></td></tr></table></div></figure>


<h4>ç»§æ‰¿</h4>

<p>åªæœ‰ç±»èƒ½ç»§æ‰¿
Classes can also add property observers to inherited properties in order to be notified when the value of a property changes. Property observers can be added to any property, regardless of whether it was originally defined as a stored or computed property.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class Vehicle {
</span><span class='line'>    var numberOfWheels: Int
</span><span class='line'>    var maxPassengers: Int
</span><span class='line'>    func description() -&gt; String {
</span><span class='line'>        return "\(numberOfWheels) wheels; up to \(maxPassengers) passengers"
</span><span class='line'>    }
</span><span class='line'>    init() {
</span><span class='line'>        numberOfWheels = 0
</span><span class='line'>        maxPassengers = 1
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>let someVehicle = Vehicle()
</span></code></pre></td></tr></table></div></figure>


<h5>Subclassing</h5>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class Bicycle: Vehicle {
</span><span class='line'>    init() {
</span><span class='line'>        super.init()
</span><span class='line'>        numberOfWheels = 2
</span><span class='line'>    }
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>let bicycle = Bicycle()
</span><span class='line'>println("Bicycle: \(bicycle.description())")
</span><span class='line'>// Bicycle: 2 wheels; up to 1 passengers</span></code></pre></td></tr></table></div></figure>


<p>The Bicycle class also defines an initializer to set up its tailored characteristics. The initializer for Bicycle calls super.init(), the initializer for the Bicycle classâ€™s superclass, Vehicle, and ensures that all of the inherited properties are initialized by Vehicle before Bicycle tries to modify them.
<code>æ³¨æ„</code>:initializers are not inherited by default in Swift. For more information</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Whats new in xcode6]]></title>
    <link href="http://xiekunRonaldo.github.io/blog/2014/08/03/whats-new-in-xcode6/"/>
    <updated>2014-08-03T15:35:28+08:00</updated>
    <id>http://xiekunRonaldo.github.io/blog/2014/08/03/whats-new-in-xcode6</id>
    <content type="html"><![CDATA[<p>Storyboardä¸­èƒ½å®æ—¶çœ‹åˆ°Custom Fonts</p>

<p><img src="http://xiekunRonaldo.github.io/images/2014/8/customfont.png"></p>

<p>swiftå¦‚éœ€ä½¿ç”¨ä¸åœ¨æŸæ–‡ä»¶ä¸­å®šä¹‰çš„ç±»ï¼Œä¸éœ€è¦import,ä¼šè‡ªåŠ¨importï¼Œä¸è¿‡ï¼Œä½ ä¾ç„¶éœ€è¦ä¸ºä½ ä¿¡èµ–çš„framework import modules,
åˆ›å»º.swiftæ–‡ä»¶æ—¶ï¼Œé»˜è®¤åˆ›å»ºäº†.hå¤´æ–‡ä»¶ï¼Œæ‰€ä»¥å¦‚æœåœ¨.mæ–‡ä»¶ä¸­å¼•ç”¨swiftæ–‡ä»¶ä¸­çš„ç±»ï¼Œå¯ä»¥ç”¨import .swiftå¯¹åº”çš„å¤´æ–‡ä»¶æ¥å¼•ç”¨
åœ¨ios8ä¸­ï¼Œå¯ä»¥@importç¬¬ä¸‰æ–¹çš„frameworkäº†!</p>

<h5>åœ¨IBä¸­åŠ¨æ€æ”¹å˜æ˜¾ç¤ºæ•ˆæœï¼Œå¦‚åŠ¨æ€æ”¹å˜åœ†è§’</h5>

<p>æ³¨æ„ä»¥ä¸‹å‡ ä¸ªæ–¹æ³•çš„ä½¿ç”¨
<code>class</code>å‰å†™@IBDesignable,å±æ€§å‰å†™@IBInspectable,è¿˜æœ‰overrideä»¥ä¸‹æ–¹æ³•</p>

<p>@override func prepareForInterfaceBuilder(){}</p>

<p><code>Size Classes</code></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Fibers Threads Processes]]></title>
    <link href="http://xiekunRonaldo.github.io/blog/2014/07/30/fibers-threads-processes/"/>
    <updated>2014-07-30T15:42:25+08:00</updated>
    <id>http://xiekunRonaldo.github.io/blog/2014/07/30/fibers-threads-processes</id>
    <content type="html"><![CDATA[<p>Ruby gives you two basic ways to organize your program so that you can run different parts of it apparently â€œat the same time.â€ Fibers let you suspend execution of one part of your program and run some other part. For more decoupled execution, you can split up cooper- ating tasks within the program, using multiple threads, or you can split up tasks between different programs, using multiple processes. Letâ€™s look at each in turn.####Fibers
Ruby 1.9å¼•å…¥äº†fibersçš„æ¦‚å¿µ,å°½ç®¡åå­—æ„å‘³ç€æŸç§è½»é‡çº§çš„çº¿ç¨‹ï¼Œå®é™…ä¸Šï¼Œfibersä»…ä»…æ˜¯ä¸€ç§éå¸¸ç®€å•çš„coroutineæœºåˆ¶ï¼Œå®ƒèƒ½è®©ä½ å†™ä¸€äº›çœ‹èµ·æ¥ç”¨äº†çº¿ç¨‹çš„ç¨‹åºï¼Œå®é™…ä¸Šæ²¡æœ‰å¼•å‘ä»»ä½•çº¿ç¨‹ä¸­å†…åœ¨çš„å¤æ‚æœºåˆ¶
è®¡ç®—ä¸€ä¸ªæ–‡ä»¶ä¸­å•è¯çš„å‡ºç°æ¬¡æ•°ï¼Œä¸ç”¨fibersç‰ˆæœ¬</p>

<pre><code>counts = Hash.new(0) 
File.foreach("testfile") do |line|
    line.scan(/\w+/) do |word| 
    word = word.downcase 
    counts[word] += 1
    end 
end
counts.keys.sort.each {|k| print "#{k}:#{counts[k]} "} 
produces:
and:1 is:3 line:3 on:1 one:1 so:1 this:3 three:1 two:1è¿™æ®µä»£ç éå¸¸çš„ugly,å®ƒæ··åˆäº†æŸ¥æ‰¾wordå’Œè®¡ç®—wordä¸¤ç§é€»è¾‘,æ¥çœ‹çœ‹ç”¨Fiberçš„æ–¹æ³•
words = Fiber.new do 
    File.foreach("testfile") do |line|          line.scan(/\w+/) do |word| 
        Fiber.yield word.downcase
        end 
    end     nil ï¿¼end
counts = Hash.new(0)
while word = words.resume 
    counts[word] += 1
end
counts.keys.sort.each {|k| print "#{k}:#{counts[k]} "} 
produces:
and:1 is:3 line:3 on:1 one:1 so:1 this:3 three:1 two:1
</code></pre>

<p>å†æ¥çœ‹ä¸€ä¸ªdemo</p>

<pre><code>twos = Fiber.new do 
    num = 2     loop do         Fiber.yield(num) unless num % 3 == 0 
        num += 2
        end 
    end 10.times { print twos.resume, " " } 
produces:
2 4 8 10 14 16 20 22 26 28
</code></pre>

<p>ä»¥ä¸Šä¹Ÿå¯ä»¥ç”¨ä¹‹å‰æåˆ°çš„lazy Enumberatorsä¸­å®ç°ç”±äºfibersä¹Ÿæ˜¯å¯¹è±¡ï¼Œä½ å¯ä»¥å°†å®ƒä»¬å­˜å‚¨åœ¨å˜é‡ä¸­ï¼Œå¹¶ä¸”fibersåªèƒ½åœ¨åˆ›å»ºå®ƒä»¬çš„çº¿ç¨‹ä¸­resume
fibers can yield control only back to the code that resumed them,ä¸è¿‡Rubyæä¾›äº†ä¸¤ç§æ ‡å‡†åº“æ¥æ‹“å±•è¿™ç§è¡Œä¸ºfiberåº“å’Œcontinuationåº“</p>

<h4>å¤šçº¿ç¨‹</h4>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Basic Input and Output]]></title>
    <link href="http://xiekunRonaldo.github.io/blog/2014/07/30/basic-input-and-output/"/>
    <updated>2014-07-30T14:27:07+08:00</updated>
    <id>http://xiekunRonaldo.github.io/blog/2014/07/30/basic-input-and-output</id>
    <content type="html"><![CDATA[<p>ä¸¤ä¸ªI/O routines
ç¬¬ä¸€ä¸ªæ˜¯åŸºæœ¬çš„äº¤äº’ç•Œé¢</p>

<pre><code>print "Enter your name: " 

name = gets
</code></pre>

<p>ä¸€ç³»åˆ—I/Oç›¸å…³çš„æ–¹æ³•åœ¨Kernel moduleé‡Œå®ç°gets, open, print, printf, putc, puts, readline, readlines, å’Œ test,è¿™äº›æ–¹æ³•é€šå¸¸éƒ½ä¸æ ‡å‡†è¾“å…¥ï¼Œæ ‡å‡†è¾“å‡ºæœ‰å…³
ç¬¬äºŒä¸ªåˆ™æ˜¯ä¸IOå¯¹è±¡äº¤äº’
IOç±»ï¼Œæœ‰ä¸¤ä¸ªå­ç±»Fileå’ŒBasicSocket</p>

<h5>å¼€å¤´æ–‡ä»¶</h5>

<pre><code>file = File.new("testfile", "r") 
# ... process the file 
file.close
</code></pre>

<p>Fileä¸Block</p>

<pre><code>File.open("testfile", "r") do |file| 
    # ... process the file
end # &lt;- file automatically closed hereä¸exceptionç»“åˆ
class File
    def File.open(*args)
        result = f = File.new(*args) 
            if block_given?
                begin
                    result = yield f
                ensure
                    f.close
                end 
            end
            result
            end 
end
</code></pre>

<h5>è¯»å†™æ–‡ä»¶</h5>

<p>æ¥çœ‹ä¸€æ®µcopy.rbä»£ç </p>

<pre><code>while line = gets 

    puts line
end
</code></pre>

<p>å¦‚æœè¿è¡Œç¨‹åºæœ¨æœ‰å‘½ä»¤è¡Œå‚æ•°ï¼Œåˆ™ä¸consoleäº¤äº’</p>

<pre><code>$ ruby copy.rb 

These are lines 

These are lines 

that I am typing 

that I am typing 

^D
</code></pre>

<p>å¦‚æœå¸¦æ–‡ä»¶åï¼Œåˆ™ä¸æ–‡ä»¶äº¤äº’</p>

<pre><code>$ ruby copy.rb testfile 

This is line one
This is line two
This is line three
And so on...
</code></pre>

<p>æˆ‘ä»¬å¯ä»¥ç”¨Fileç±»æ¥è¯»å†™æ–‡ä»¶</p>

<pre><code>File.open("testfile") do |file| 
    while line = file.gets          puts line       end 
end
    produces:
This is line one
This is line two
This is line three
And so on...
</code></pre>

<h5>Iterators for Reading</h5>

<p>ä½ å¯ä»¥ç”¨å„ç§iteratorsä¸IOæµäº¤äº’
O#each_byte invokes a block with the next 8-bit byte from the IO object,chråˆ™å°†integerè½¬åŒ–ä¸ºASCIIå­—ç¬¦</p>

<pre><code>File.open("testfile") do |file| 
    file.each_byte.with_index do |ch, index|
        print "#{ch.chr}:#{ch} "
        break if index &gt; 10 
    end
end
produces:
T:84 h:104 i:105 s:115  :32 i:105 s:115  :32 l:108 i:105 n:110 e:101
</code></pre>

<p>IO#each_line</p>

<pre><code>File.open("testfile") do |file|
    file.each_line {|line| puts "Got #{line.dump}" }
end
produces:
Got "This is line one\n"
Got "This is line two\n"
Got "This is line three\n"
Got "And so on...\n"
</code></pre>

<p>ä½ ä¹Ÿå¯ä»¥å°†ä¸€ä¸²å­—ç¬¦ä¼ ç»™each_lineæ¥ä½œä¸ºä¸€ä¸ªline separator,é»˜è®¤æ˜¯\n</p>

<pre><code>File.open("testfile") do |file|
    file.each_line("e") {|line| puts "Got #{ line.dump }" }
end
produces:
Got "This is line"
Got " one"
Got "\nThis is line"
Got " two\nThis is line"
Got " thre"
Got "e"
Got "\nAnd so on...\n"
</code></pre>

<p>combine iteratorå’Œautoclosing block,æˆ‘ä»¬å¾—åˆ°äº†IO.foreach,è¿™ä¸ªæ–¹æ³•æ‰“å¼€æ–‡ä»¶ï¼Œè°ƒç”¨iteratorä¸€æ¬¡ä¸€è¡Œï¼Œç„¶åè‡ªåŠ¨å…³é—­æ–‡ä»¶</p>

<pre><code>IO.foreach("testfile") {|line| puts line }å°†æ•´ä¸ªæ–‡ä»¶æ–‡ä»¶çš„å†…å®¹ä¿å­˜åœ¨ä¸€ä¸ªstringæˆ–æ¯è¡Œä¿å­˜åœ¨ä¸€ä¸ªæ•°ç»„é‡Œ
//ä¿å­˜åœ¨stringä¸­
# read into string
str = IO.read("testfile")
str.length # =&gt; 66
str[0, 30] # =&gt; "This is line one\nThis is line "

//ä¿å­˜åœ¨arrayä¸­

# read into an array    arr = IO.readlines("testfile") 
arr.length # =&gt; 4
arr[0] # =&gt; "This is line one\n"
</code></pre>

<h4>å†™å…¥æ–‡ä»¶</h4>

<pre><code># Note the "w", which opens the file for writing
File.open("output.txt", "w") do |file| 
file.puts "Hello"
file.puts "1 + 2 = #{1+2}"
end
# Now read the file in and print its contents to STDOUT
puts File.read("output.txt")
produces:
Hello 1+2=3
</code></pre>

<p>å¦‚æœå°†äºŒè¿›åˆ¶æ•°æ®è½¬ä¸ºstring,æœ‰ä»¥ä¸‹ä¸‰ç§æ–¹æ³•</p>

<pre><code>str1 = "\001\002\003" # =&gt; "\u0001\u0002\u0003" 

str2 = ""
str2 &lt;&lt; 1 &lt;&lt; 2 &lt;&lt; 3 # =&gt; "\u0001\u0002\u0003" 
[ 1, 2, 3 ].pack("c*") # =&gt; "\x01\x02\x03"
</code></pre>

<p>ä½ ä¹Ÿå¯ä»¥ç”¨&lt;&lt;å°†å¯¹è±¡æ·»åŠ åˆ°è¾“å‡ºæµä¸­</p>

<pre><code>endl = "\n"
STDOUT &lt;&lt; 99 &lt;&lt; " red balloons" &lt;&lt; endl
produces:
99 red balloons 
</code></pre>

<p>&lt;&lt;æ–¹æ³•åœ¨æ‰“å°å‰å°†ç”¨to_så°†å®ƒçš„å‚æ•°è½¬ä¸ºstring</p>

<h5>Doing I/O with StringsStringIOå¯¹è±¡ï¼Œå®ƒä»¬æ“ä½œèµ·æ¥å°±åƒI/Oå¯¹è±¡ï¼Œä½†å®ƒä»¬åªæ˜¯è¯»å†™stringsï¼Œè€Œä¸æ˜¯files</h5>

<pre><code>require 'stringio'
ip = StringIO.new("now is\nthe time\nto learn\nRuby!")
op = StringIO.new("", "w")
ip.each_line do |line| 
    op.puts line.reverse
end
op.string # =&gt; "\nsi won\n\nemit eht\n\nnrael ot\n!ybuR\n"
</code></pre>

<h4>Talking to Networkds</h4>

<p>socektåº“å°è£…äº†TCP,UDP,SOCKSå’ŒUnix domainsockes require &lsquo;socket&rsquo;    client = TCPSocket.open(&lsquo;127.0.0.1&rsquo;, &lsquo;www&rsquo;)</p>

<pre><code>client.send("OPTIONS /~dave/ HTTP/1.0\n\n", 0) 
puts client.readlines
client.close
produces:
# 0 means standard packet
HTTP/1.1 200 OK
Date: Mon, 27 May 2013 17:31:00 GMT
Server: Apache/2.2.22 (Unix) DAV/2 PHP/5.3.15 with Suhosin-Patch mod_ssl/2.2.22
OpenSSL/0.9.8r
Allow: GET,HEAD,POST,OPTIONS
Content-Length: 0
Connection: close
Content-Type: text/html
</code></pre>

<p>åœ¨é«˜å±‚,lib/net library modulesæä¾›äº†å¯¹é€šä¿¡åè®®çš„è®¸å¤šæ”¯æŒ(FTP, HTTP, POP, SMTP, and telnet)</p>

<pre><code>//ä»¥ä¸‹åªæ˜¯ä¸€éƒ¨åˆ†ä»£ç 
require 'net/http'
http = Net::HTTP.new('pragprog.com', 80)
response = http.get('/book/ruby3/programming-ruby-1-9')
if response.message == "OK"
puts response.body.scan(/&lt;img alt=".*?" src="(.*?)"/m).uniq[0,3]
end
produces:
       http://pragprog.com/assets/logo-c5c7f9c2f950df63a71871ba2f6bb115.gif
       http://pragprog.com/assets/drm-
       free80-9120ffac998173dc0ba7e5875d082f18.png
       http://imagery.pragprog.com/products/99/ruby3_xlargecover.jpg?
       1349967653open-urlåº“ä¸­çš„Object#openæ–¹æ³•èƒ½è¯†åˆ«æ–‡ä»¶ä¸­çš„http://å’Œftp://URLs,ä¹Ÿèƒ½è‡ªåŠ¨å¤„ç†é‡å®šå‘ 
require 'open-uri'
open('http://pragprog.com') do |f|
puts f.read.scan(/&lt;img alt=".*?" src="(.*?)"/m).uniq[0,3]
end
produces:
       http://pragprog.com/assets/logo-c5c7f9c2f950df63a71871ba2f6bb115.gif
       http://pragprog.com/assets/drm-free80-9120ffac998173dc0ba7e5875d082f18.png
       http://imagery.pragprog.com/products/353/jvrails2_xlargebeta.jpg?1368826914
</code></pre>

<h4>Parsing HTML</h4>

<pre><code>require 'open-uri'
page = open('http://pragprog.com/titles/ruby3/programming-ruby-1-9').read 
if page =~ %r{&lt;title&gt;(.*?)&lt;/title&gt;}m
    puts "Title is #{$1.inspect}" 
end
produces:
       Title is "The Pragmatic Bookshelf | Programming Ruby 1.9"
</code></pre>

<p>ä½†ç”¨æ­¤æ³•ä¸å¤ªå¦¥å½“ï¼Œå¯èƒ½titleå’Œå°–æ‹¬å·é—´å¤šä¸ªä¸ªç©ºæ ¼å¦‚ä½•æ˜¯å¥½ï¼Œå¯ä»¥ç”¨ç¬¬ä¸‰æ–¹åº“Nokogiri</p>

<pre><code>require 'open-uri' 
require 'nokogiri'
doc = Nokogiri::HTML(open("http://pragprog.com/"))
puts "Page title is " + doc.xpath("//title").inner_html
# Output the first paragraph in the div with an id="copyright" 
# (nokogiri supports both xpath and css-like selectors)
puts doc.css('div#copyright p')
# Output the second hyperlink in the site-links div using xpath and css
puts "\nSecond hyperlink is"
puts doc.xpath('id("site-links")//a[2]') puts doc.css('#site-links a:nth-of-type(2)')
produces:
Page title is The Pragmatic Bookshelf
&lt;p&gt;
    The &lt;em&gt;Pragmatic BookshelfTM&lt;/em&gt; is an imprint of
        &lt;a href="http://pragprog.com/"&gt;The Pragmatic Programmers, LLC&lt;/a&gt;.
    &lt;br&gt;
    Copyright Â© 1999â€“2013 The Pragmatic Programmers, LLC.
    All Rights Reserved.
&lt;/p&gt;
Second hyperlink is
&lt;a href="http://pragprog.com/about"&gt;About Us&lt;/a&gt;
&lt;a href="http://pragprog.com/about"&gt;About Us&lt;/a&gt;
</code></pre>

<p>Nokogiri can also update and create HTML and XML.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Exceptions-catch-throw]]></title>
    <link href="http://xiekunRonaldo.github.io/blog/2014/07/30/exceptions-catch-throw/"/>
    <updated>2014-07-30T11:52:27+08:00</updated>
    <id>http://xiekunRonaldo.github.io/blog/2014/07/30/exceptions-catch-throw</id>
    <content type="html"><![CDATA[<h4>The Exception Class</h4>

<p>å¼‚å¸¸çš„ä¿¡æ¯è¢«å°è£…è¿›äº†Exceptionç±»çš„å¯¹è±¡æˆ–è€…Exceptionç±»çš„å­ç±»å¯¹è±¡é‡Œ,Rubyé¢„å®šä¹‰äº†exceptionsçš„hierarchy,å¦‚ä¸‹</p>

<p><img src="http://xiekunRonaldo.github.io/images/2014/7/exception_hierarchy.png"></p>

<p>å¦‚æœä½ éœ€è¦æŠ›å‡ºå¼‚å¸¸,ä½ å¯ä»¥ç”¨å†…ç½®çš„Exceptionçš„ç±»,æˆ–è€…å¯ä»¥è‡ªå·±åˆ›å»ºä¸€ä¸ªï¼Œä¸è¿‡è¯·ç¡®ä¿ä½ åˆ›å»ºçš„Exception
å­ç±»ç»§æ‰¿è‡ªStandardErroræˆ–è€…å®ƒçš„å­ç±»,å¦åˆ™é»˜è®¤æƒ…å†µä¸‹å¼‚å¸¸æ˜¯ä¸ä¼šè¢«æ•æ‰çš„
æ¯ä¸€ä¸ªExceptionéƒ½æœ‰ä¸€ä¸ªæ¶ˆæ¯å’Œstack backtraceä¸ä¹‹å…³è”ï¼Œå¦‚æœä½ å®šä¹‰äº†è‡ªå·±çš„å¼‚å¸¸ï¼Œä½ å¯ä»¥æ·»åŠ é¢å¤–çš„ä¿¡æ¯
è¿™æ˜¯æœ‰ä¸€ä¸ªç”¨open-urlçš„åº“æ¥ä¸‹è½½ä¸€ä¸ªç½‘é¡µçš„å†…å®¹å¹¶å°†å®ƒå†™å…¥ä¸€ä¸ªæ–‡ä»¶ä¸­çš„demo</p>

<pre><code>require 'open-uri'
web_page = open("http://pragprog.com/podcasts") 
output = File.open("podcasts.html", "w")
while line = web_page.gets

output.puts line
end
output.close
</code></pre>

<p>å¦‚æœä¸­é€”å‡ºç°é”™è¯¯æ€ä¹ˆåŠï¼Œæˆ‘ä»¬å½“ç„¶ä¸æƒ³ä¿å­˜ä¸€å¼ ä¸å®Œæ•´çš„ç½‘é¡µ
æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å¤„ç†å¼‚å¸¸çš„ä»£ç ï¼Œæˆ‘ä»¬å°†å¯èƒ½å‘ç”Ÿå¼‚å¸¸çš„ä»£ç æ”¾åœ¨begin/endçš„blockä¸­ï¼Œç„¶åç”¨rescueè¯­å¥æ¥å‘Šè¯‰Rubyæˆ‘ä»¬æƒ³è¦æ•è·çš„å¼‚å¸¸ç±»å‹</p>

<pre><code>require 'open-uri'
page = "podcasts"
file_name = "#{page}.html"
web_page = open("http://pragprog.com/#{page}") output = File.open(file_name, "w")
begin
    while line = web_page.gets output.puts line
end
output.close 
rescue Exception
    STDERR.puts "Failed to download #{page}: #{$!}" output.close
        File.delete(file_name)
        raise
end 
</code></pre>

<p>When an exception is raised and independent of any subsequent exception handling, Ruby places a reference to the associated exception object into the global variable $! (the exclamation point presumably mirroring our surprise that any of our code could cause errors). In the previous example, we used the $! variable to format our error message.
å…³æ‰å¹¶åˆ é™¤æ–‡ä»¶åï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨æ— å‚çš„raiseï¼Œè¿™æ ·åˆåœ¨$!é‡Œé‡æ–°æŠ›å‡ºäº†å¼‚å¸¸ï¼ŒæŠ›åˆ°æ›´é«˜å±‚å»äº†
è¿˜å¯ä»¥ä¸ºæ•è·å–çš„å¼‚å¸¸æŒ‡å®šåˆ«å</p>

<pre><code>begin
    eval string
rescue SyntaxError, NameError =&gt; boom
    print "String doesn't compile: " + boom 
rescue StandardError =&gt; bang
    print "Error running script: " + bang 
end
</code></pre>

<h5>System ErrorsSystem errors are raised when a call to the operating system returns an error code,On POSIX systems, these errors have names such as EAGAIN and EPERM. (If youâ€™re on a Unix box, you could type man errno to get a list of these errors.)</h5>

<p>Rubyå°†è¿™äº›é”™è¯¯æ‰“åŒ…æˆä¸€ä¸ªå…·ä½“çš„exceptionçš„å¯¹è±¡,æ¯ä¸€ä¸ªæ˜¯SymstemCallErrorçš„å­ç±»ï¼Œå¹¶ä¸”éƒ½å®šä¹‰åœ¨Errno moduleä¸­,è¿™æ„å‘³ç€ä½ å°†çœ‹åˆ°Excetionçš„ç±»å¦å¦‚Errno::EAGAIN, Errno::EIO, å’ŒErrno::EPERM,å¦‚æœä½ æƒ³è¦è·å–system error code,æ¯ä¸ªError exceptionç±»éƒ½æœ‰ä¸€ä¸ªå«åšErrnoç±»å¸¸é‡</p>

<pre><code>Errno::EAGAIN::Errno # =&gt; 35 

Errno::EPERM::Errno # =&gt; 1 

Errno::EWOULDBLOCK::Errno # =&gt; 35
</code></pre>

<p>æ³¨æ„EWOULDBLOCK å’Œ EAGAINæœ‰åŒæ ·çš„error code,æ‰€ä»¥åœ¨rescueä¸­ï¼ŒRubyæŠŠå®ƒä»¬çœ‹ä½œä¸€æ ·çš„ï¼Œå¦‚æœä½ æƒ³rescueä¸€ä¸ªï¼Œä½ å†rescueä¸¤ä¸ªï¼Œä¸ºæ­¤ä½ å¯ä»¥é‡æ–°å®šä¹‰ SystemCallError#===,è¿™æ ·ï¼Œå¦‚æœä¸¤ä¸ªSystemCallErroræ¯”è¾ƒå°±ä¼šåŸºäºerror numberè€Œä¸æ˜¯å®ƒä»¬åœ¨å±‚æ¬¡ä¸­çš„ä½ç½®äº†</p>

<p>ensureç›¸å½“äºjavaä¸­çš„finally</p>

<pre><code>f = File.open("testfile") 

begin
# .. process
rescue
  # .. handle error
ensure
f.close
end
</code></pre>

<p>æ³¨æ„File.openä¸èƒ½æ”¾åœ¨beginé‡Œé¢ï¼Œå› ä¸ºopenå®ƒè‡ªå·±ä¹Ÿå¯èƒ½æŠ›å‡ºå¼‚å¸¸ï¼Œå¦‚æœå‘ç”Ÿäº†ï¼Œä½ åº”è¯¥ä¸æƒ³åœ¨ensureé‡Œæ¥æ‰§è¡Œç›¸åº”çš„ä»£ç ï¼Œå› ä¸ºæ²¡æœ‰æ–‡ä»¶è¦å»close</p>

<p>elseè¯­å¥</p>

<pre><code>f = File.open("testfile") 

begin
# .. process
rescue
  # .. handle error
else
puts "Congratulations-- no errors!" 
ensure
f.close
end
</code></pre>

<p>æ³¨æ„elseé‡Œçš„è¯­å¥åªæœ‰åœ¨æ— å¼‚å‘ç”Ÿæ—¶æ‰ä¼šè°ƒç”¨
æœ‰æ—¶ä½ èƒ½æ”¹æ­£æŠ›å‡ºå¼‚å¸¸çš„cause,æ­¤æ—¶å¯ä»¥ç”¨retryè¯­å¥æ¥é‡æ–°æ‰§è¡Œbegin/endçš„block</p>

<pre><code>@esmtp = true
begin
    # First try an extended login. If it fails, fall back to a normal login
    if @esmtp then @command.ehlo(helodom) 
                    else @command.helo(helodom)
        end
rescue ProtocolError
    if @esmtp then
            @esmtp = false
            retry 
        else
            raise
        end 
end
</code></pre>

<h5>Raising Exceptions</h5>

<p>ä½ å¯ä»¥ç”¨Object#raiseæ–¹æ³•æ¥æŠ›å‡ºå¼‚å¸¸</p>

<pre><code>raise   //æŠ›å‡ºå½“å‰çš„exception,å¦‚æœæ²¡æœ‰ï¼Œåˆ™æŠ›å‡ºRuntimeError
raise "bad mp3 encoding"    //åˆ›å»ºä¸€ä¸ªæ–°çš„RuntimeError,ç„¶åæŠ›åˆ°è°ƒç”¨æ ˆä¸Š

//åˆ›å»ºInterfaceExceptionï¼Œä¸ä¹‹ç›¸å…³çš„ä¿¡æ¯ï¼Œç„¶åæŠ›åˆ°stack traceä¸Š raise InterfaceException, "Keyboard failure", caller
</code></pre>

<p>stack traceé€šå¸¸ç”¨Object#caller
ä¹Ÿå¯ä»¥å°†ExceptionæŠ›ç»™call stackä¸€éƒ¨åˆ†çš„å­é›†
å‡è®¾æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªRetryExceptionç±»</p>

<pre><code>class RetryException &lt; RuntimeError
    attr :ok_to_retry
        def initialize(ok_to_retry)
                   @ok_to_retry = ok_to_retry
        end 
end
</code></pre>

<p>åœ¨ä»£ç çš„æŸä¸ªåœ°æ–¹ï¼Œä¸€ä¸ªé”™è¯¯å‘ç”Ÿäº†</p>

<pre><code>def read_data(socket) 

    data = socket.read(512) 

    if data.nil?
    raise RetryException.new(true), "transient read error" 
    end        # .. normal processing   endhigher up te call stack,æˆ‘ä»¬å¤„ç†å¼‚å¸¸
begin        stuff = read_data(socket)        # .. process stuff    rescue RetryException =&gt; detail 
    retry if detail.ok_to_retry 
    raise   end
</code></pre>

<h5>catch and throw</h5>

<pre><code>word_list = File.open("wordlist") 
word_in_error = catch(:done) do
        result = []
        while line = word_list.gets
    word = line.chomp
    throw(:done, word) unless word =~ /^\w+$/ 
        result &lt;&lt; word
    end
      puts result.reverse
end
if word_in_error
    puts "Failed: '#{word_in_error}' found, but a word was expected" 
end
</code></pre>

<p>throwä¸ä¸€å®šéè¦å‡ºç°åœ¨catchè¯­å¥é‡Œ</p>

<pre><code>def prompt_and_get(prompt)
    print prompt
    res = readline.chomp
    throw :quit_requested if res == "!" 
    res
end
catch :quit_requested do
    name = prompt_and_get("Name: ") 
    age = prompt_and_get("Age: ") 
    sex = prompt_and_get("Sex: ") 
    # ..
    # process information
end 
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Expressions]]></title>
    <link href="http://xiekunRonaldo.github.io/blog/2014/07/30/expressions/"/>
    <updated>2014-07-30T09:14:04+08:00</updated>
    <id>http://xiekunRonaldo.github.io/blog/2014/07/30/expressions</id>
    <content type="html"><![CDATA[<p>æ˜¾è€Œæ˜“è§çš„æ˜¯æˆ‘ä»¬å¯ä»¥chain statements</p>

<pre><code>a = b = c = 0 # =&gt; 0
[ 3, 1, 7, 0 ].sort.reverse # =&gt; [7, 3, 1, 0]
</code></pre>

<p>æ¯”å¦‚ä¸æ˜æ˜¾çš„æ˜¯ï¼Œåœ¨Cæˆ–Javaä¸­çš„è¯­å¥åœ¨Rubyä¸­é€šå¸¸æ˜¯expressions,æ¯”å¦‚ifå’Œcaseè¯­å¥éƒ½è¿”å›äº†æœ€åä¸€ä¸ªè¡¨è¾¾å¼</p>

<pre><code>song_type = if song.mp3_type == MP3::Jazz
                if song.written &lt; Date.new(1935, 1, 1)
                    Song::TradJazz
                else
                    Song::Jazz
                end 
            else
                Song::Other
            end
rating = case votes_cast
ï¿¼         when 0...10     then Rating::SkipThisOne
            when 10...50    then Rating::CouldDoBetter 
            else    Rating::Rave
         end
</code></pre>

<h5>Operator Expressions</h5>

<p>åœ¨Rubyä¸­ï¼Œè®¸å¤šoperationsæ˜¯ä»¥æ–¹æ³•è°ƒç”¨çš„å½¢å¼å®ç°çš„ï¼Œæ¯”å¦‚ï¼Œå½“ä½ å†™a*b+cæ—¶ï¼Œå®é™…ä¸Šä½ æ˜¯è°ƒç”¨äº†açš„æ–¹æ³•<code>*</code>ä¼ å…¥å‚æ•°b,ç„¶åa<code>*</code>bçš„ç»“æœè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬å†å¯¹å…¶æ‰§è¡Œ<code>+</code>çš„æ–¹æ³•,ç„¶åå°†cä½œä¸ºå‚æ•°ä¼ å…¥,å®é™…ä¸‹ç›¸å½“äºä»¥ä¸‹ä»£ç </p>

<pre><code>a, b, c = 1, 2, 3
a * b + c # =&gt; 5
 (a.*(b)).+(c) # =&gt; 5
</code></pre>

<p>æˆ‘ä»¬é—®é¢˜å¯ä»¥å®šä¹‰æœ€åŸºæœ¬çš„è¿ç®—ç¬¦æ“ä½œ</p>

<pre><code>class Fixnum
alias old_plus + # We can reference the original '+' as 'old_plus'
def +(other) # Redefine addition of Fixnums. This is a BAD IDEA! 
old_plus(other).succ
end end
1 + 2 # =&gt; 4 a=3
a+=4 #=&gt;8 
a + a + a # =&gt; 26    
</code></pre>

<h6>&lt;&lt;æ“ä½œç¬¦</h6>

<pre><code>a = [ 1, 2, 3 ]
    a&lt;&lt;4 #=&gt;[1,2,3,4]
</code></pre>

<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥å®šä¹‰&lt;&lt;æ“ä½œç¬¦æ–¹æ³•</p>

<pre><code>class ScoreKeeper 
    def initialize
               @total_score = @count = 0
        end
        def &lt;&lt;(score)
                   @total_score += score
                   @count += 1
                   self
        end
        def average
            fail "No scores" if @count.zero?
            Float(@total_score) / @count
        end 
end      
scores = ScoreKeeper.new
scores &lt;&lt; 10 &lt;&lt; 20 &lt;&lt; 40
puts "Average = #{scores.average}"
produces:
       Average = 23.333333333333332
</code></pre>

<p>æ³¨æ„&lt;&lt;æ–¹æ³•ä¸­è¿”å›äº†selfï¼Œè¿™æ ·å®ƒå°±å…è®¸<code>scores &lt;&lt; 10 &lt;&lt; 20 &lt;&lt; 40</code>è¿™æ ·çš„å½¢å¼
<code>[]</code>ä¹Ÿèƒ½è¢«å®šä¹‰ä¸ºä¸€ä¸ªæ–¹æ³•è°ƒç”¨ï¼Œä½ å¯ä»¥è¿™ä¹ˆå†™</p>

<pre><code>some_obj[1,2,3]
</code></pre>

<p>æˆ‘ä»¬å¯ä»¥è¿™æ ·å®šä¹‰</p>

<pre><code>class SomeClass
    def [](p1, p2, p3)
        # ...
        end
end
</code></pre>

<p>åŒæ ·åœ°ï¼Œä¹Ÿå¯ä»¥å®šä¹‰<code>[]=</code>æ–¹æ³•  class SomeClass</p>

<pre><code>    def []=(*params)
        value = params.pop
        puts "Indexed with #{params.join(', ')}" 
        puts "value = #{value.inspect}"
    end
end
s = SomeClass.new
s[1] = 2
s['cat', 'dog'] = 'enemies'
produces:
       Indexed with 1
       value = 2
       Indexed with cat, dog
       value = "enemies"
</code></pre>

<p>ä»ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>[]</code>é‡Œçš„å‚æ•°ä½œä¸ºparamsçš„å‰nä¸ªæ•°ï¼Œè€Œ=å³è¾¹çš„å€¼ä¸ºparamsçš„æœ€åä¸€ä¸ªå‚æ•°</p>

<h5>å„ç§å„æ ·çš„è¡¨è¾¾å¼</h5>

<ul>
<li>Command Expression
ä»¥&#8220;æ‹¬èµ·æ¥çš„å­—ç¬¦ä¸²æˆ–ä»¥%xå¼€å¤´çš„å­—ç¬¦ä¸²è¢«OSè§£æä¸ºä¸€æ¡bashå‘½ä»¤,æ³¨æ„æ¢è¡Œç¬¦è¿˜åœ¨
      <code>date</code> # => &ldquo;Mon May 27 12:30:56 CDT 2013\n&rdquo;
      <code>ls</code>.split[34] # => &ldquo;newfile&rdquo;
          %x{echo &ldquo;hello there&rdquo;} # => &ldquo;hello there\n&rdquo;
              for i in 0..3
          status = <code>dbmanager status id=#{i}</code> # &hellip;
      end
æˆ‘ä»¬å¯ä»¥é€šè¿‡å…¨å±€å˜é‡$?æ¥æŸ¥çœ‹å‘½ä»¤çš„exit status

<h4>é‡å®šä¹‰`</h4>

ä»¥ä¸Šæˆ‘ä»¬å¾—çŸ¥&#8220;é‡Œçš„å­—ç¬¦ä¸²é»˜è®¤è¢«å½“ä½œå‘½ä»¤æ¥æ‰§è¡Œï¼Œå®é™…ä¸Šï¼Œstringæ˜¯è¢«å½“ä½œå‚æ•°ä¼ ç»™äº†æ–¹æ³•Object#`,å¦‚æœä½ æƒ³ï¼Œå¯ä»¥é‡å†™å®ƒï¼Œ
  alias old_backquote <code>
      def</code>(cmd)
          result = old_backquote(cmd)
          if $? != 0
              puts &ldquo;<strong><em> Command #{cmd} failed: status = #{$?.exitstatus}&rdquo;
          end     result  end
  print <code>ls -l /etc/passwd</code>
  print <code>ls -l /etc/wibble</code>
  produces:
     -rw-r&mdash;r&mdash;  1 root  wheel  5086 Jul 20  2011 /etc/passwd
     ls: /etc/wibble: No such file or directory
     </em></strong> Command ls -l /etc/wibble failed: status = 1

<h4>èµ‹å€¼</h4>

<p>Rubyæœ‰ä¸¤ç§å½¢å¼çš„èµ‹å€¼ï¼Œç¬¬ä¸€ç§æ˜¯å°†å¯¹è±¡çš„å¼•ç”¨èµ‹äºˆä¸€ä¸ªå˜é‡æˆ–å¸¸é‡
      instrument = &ldquo;piano&rdquo;
  MIDDLE_A = 440
ç¬¬äºŒç§å½¢å¼æ¶‰åŠåˆ°<code>having an object attribute or element reference on the left side.</code>è¿™ç§å½¢å¼æ˜¯å¾ˆç‰¹åˆ«çš„ï¼Œå› ä¸ºå®ƒä»¬é€šè¿‡åœ¨å·¦å€¼ä¸­è°ƒç”¨æ–¹æ³•æ¥å®ç°ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ å¯ä»¥é‡å†™è¿™äº›æ–¹æ³•
   class ProjectList
       def initialize
          @projects = []
      end
      def projects=(list)
          @projects = list.map(&amp;:upcase) # store list of names in uppercase
      end
      def <a href="offset"></a>
          @projects[offset]
      end
  end
  list = ProjectList.new
  list.projects = %w{ strip sand prime sand paint sand paint rub paint }
  list[3] # => &ldquo;SAND&rdquo;
  list[4] # => &ldquo;PAINT&rdquo;
æ¥çœ‹ä¸€æ®µæœ‰æ„æ€çš„ä»£ç </p>

<p>  class Test
      def val=(val)
          @val = val
          return 99
      end
  end</p>

<p>  t = Test.new
      result = (t.val = 2)
  result
ä»¥ä¸Šçš„resultä¼šæ˜¯ä»€ä¹ˆå€¼?
åœ¨Rubyçš„è¿‡å»ç‰ˆæœ¬ä¸­ï¼Œèµ‹å€¼æ–¹æ³•çš„è¿”å›å€¼<code>æ€»é‡</code>returnçš„å€¼ï¼Œè€Œä»Ruby1.8å¼€å§‹,è¿”å›å€¼æ€»æ˜¯ä¼ å…¥çš„å‚æ•°å€¼
æ‰€ä»¥ä»¥ä¸Šçš„resultå€¼å¦‚æœåœ¨è¿‡å»çš„ç‰ˆæœ¬ä¸­ä¸º99ï¼Œä½†åœ¨1.8ç‰ˆæœ¬ååˆ™ä¸º2</p></li>
</ul>


<h6>Parallel Assignment</h6>

<pre><code>a,b=1,2 #a=1,b=2 

a,b=b,a #b=2,a=1
a=1,2,3,4 # a=[1,2,3,4] 
    b=[1,2,3,4] # b=[1,2,3,4]   
a,b=1,2,3,4 # a=1, b=2 
c,=1,2,3,4 # c=1
</code></pre>

<h5>Splats and Assignment</h5>

<pre><code>a, b, c, d, e = *(1..2), 3, *[4, 5] # a=1, b=2, c=3, d=4, e=5       a,*b=1,2,3 # a=1, b=[2,3] a,*b=1 # a=1, b=[]
*a,b=1,2,3,4        # a=[1,2,3], b=4
c,*d,e=1,2,3,4      # c=1, d=[2,3], e=4
f,*g,h,i,j=1,2,3,4  # f=1, g=[], h=2, i=3, j=4      first, *, last = 1,2,3,4,5,6 # first=1, last=6#####åµŒå¥—èµ‹å€¼
a, (b, c), d = 1,2,3,4          # a=1, b=2, c=nil, d=3
a, (b, c), d = [1,2,3,4]        # a=1, b=2, c=nil, d=3
a, (b, c), d = 1,[2,3],4        # a=1, b=2, c=3, d=4
a, (b, c), d = 1,[2,3,4],5      # a=1, b=2, c=3, d=5
a, (b,*c), d = 1,[2,3,4],5      # a=1, b=2, c=[3, 4], d=5Rubyä¸­æœ¨æœ‰++å’Œ--è¿ç®—ç¬¦
</code></pre>

<h4>Conditional Execution</h4>

<pre><code>var ||= "default value"
</code></pre>

<p>ç›¸å½“äº</p>

<pre><code>var = "default value" unless var 
</code></pre>

<h5>defined?</h5>

<pre><code>defined? 1          # =&gt; "expression"
defined? dummy      # =&gt; nil
defined? printf     # =&gt; "method"
defined? String     # =&gt; "contant"
defined? $_         # =&gt; "global-variable"
defined? Math::PI # =&gt; "constant"
defined? a = 1      # =&gt; "assignment"
defined? 42.abs     # =&gt; "method"
defined? nil        # =&gt; "nil"
</code></pre>

<h5>Comparing Objects</h5>

<p>é™¤äº†booleanè¿ç®—ç¬¦ï¼ŒRubyå¯¹è±¡æ”¯æŒç”¨æ–¹æ³•==ï¼Œ===ï¼Œ&lt;=>, =~,eql?å’Œequal?æ¥æ¯”è¾ƒ,&lt;=>å®šä¹‰åœ¨Objectç±»ä¸­,ä½†é€šå¸¸è¢«é‡å†™æ¥å®ç°ç±»å¸Œæœ›çš„è¯­ä¹‰,æ¯”å¦‚Arrayç±»é‡å®šä¹‰äº†==æ‰€ä»¥ä¸¤ä¸ªarrayå¯¹è±¡åªæœ‰åœ¨å®ƒä»¬çš„å…ƒç´ ä¸ªæ•°ä¸€æ ·ï¼Œå¹¶ä¸”ç›¸åº”çš„å…ƒç´ ä¹Ÿç›¸ç­‰çš„æƒ…å†µä¸‹æ‰çœŸæ­£çš„ç›¸ç­‰
==å’Œ=~éƒ½æœ‰ç›¸åº”åœ°å¦å®šå½¢å¼,!=å’Œ!~,å¦‚æœè°ƒç”¨!=æˆ–!~,Rubyé¦–å…ˆå¯»æ‰¾æ­¤ç±»çš„!=æˆ–!~,å¦‚æœå‘ç°å°±è°ƒç”¨å®ƒä»¬ï¼Œå¦‚æœä¸å‘ç°ï¼Œå°±è°ƒç”¨==æˆ–=~,ç„¶åå†å¯¹ç»“æœå–å</p>

<pre><code>class T
    def ==(other)
            puts "Comparing self == #{other}"
        other == "value" 
        end
end
t = T.new
p (t == "value") 
p (t != "value")
produces:
Comparing self == value
true
Comparing self == value
false
</code></pre>

<p>ä»¥ä¸Šè°ƒç”¨<code>t != "value"</code>æ—¶,é¦–å…ˆè°ƒç”¨t = &ldquo;value&rdquo;,ç„¶åå†å¯¹ç»“æœå–å
å„æ“ä½œç¬¦çš„æ„ä¹‰å¦‚ä¸‹</p>

<p><img src="http://xiekunRonaldo.github.io/images/2014/7/operator.png"></p>

<h5>if and unless Expressions</h5>

<p>if thenè¯­å¥</p>

<pre><code>if artist == "Gillespie" then handle = "Dizzy"
elsif artist == "Parker" then handle = "Bird"
else
handle = "unknown" 
end
</code></pre>

<p>å…³é”®å­—<code>then</code>æ˜¯optionalçš„ï¼Œå¦‚æœä½ æƒ³å°†è¯­å¥å¤šè¡Œæ’åˆ—çš„è¯</p>

<pre><code>if artist == "Gillespie" 
    handle = "Dizzy"
elsif artist == "Parker" 
    handle = "Bird"
else
handle = "unknown" 
end
</code></pre>

<p>ä¸è¿‡å¦‚æœä½ æƒ³å°†thenåå¯¹åº”çš„è¯­å¥ä¸ifè¯­å¥æ”¾åœ¨åŒä¸€è¡Œï¼Œthenæ˜¯å¿…ä¸å¯å°‘çš„!</p>

<pre><code>if artist == "Gillespie" then handle = "Dizzy" 
elsif artist == "Parker" then handle = "Bird" 
else handle = "unknown"
end
</code></pre>

<p>ä¸ifå¯¹åº”çš„æ˜¯unless</p>

<pre><code>unless duration &gt; 180 
    listen_intently
end
</code></pre>

<h5>if and unless Modifiers</h5>

<pre><code>mon, day, year = $1, $2, $3 if date =~ /(\d\d)-(\d\d)-(\d\d)/ 
puts "a = #{a}" if $DEBUG
print total unless total.zero?
File.foreach("/etc/passwd") do |line|
next if line =~ /^#/ # Skip comments 
parse(line) unless line =~ /^$/ # Don't parse empty lines
end
</code></pre>

<h5>case Expressions</h5>

<ul>
<li>ç¬¬ä¸€ç§å½¢å¼
      case
          when song.name == &ldquo;Misty&rdquo;
          puts &ldquo;Not again!&rdquo;
          when song.duration > 120
          puts &ldquo;Too long!&rdquo;
          when Time.now.hour > 21
          puts &ldquo;It&rsquo;s too late&rdquo;
          else
          song.play
          end

<ul>
<li>ç¬¬äºŒç§å½¢å¼           case command
  when &ldquo;debug&rdquo;
    dump_debug_info
    dump_symbols
  when /p\s+(\w+)/
  dump_variable($1)
  when &ldquo;quit&rdquo;, &ldquo;exit&rdquo;
  exit
  else
  print &ldquo;Illegal command: #{command}&rdquo;
  end</li>
</ul>
</li>
<li><p>ç¬¬ä¸‰ç§å½¢å¼
ä¸thenè¯­å¥ç»“åˆä½¿ç”¨</p>

<pre><code>  kind = case year
  when 1850..1889 then "Blues"
  when 1890..1909 then "Ragtime"
  when 1910..1929 then "New Orleans Jazz" when 1930..1939 then "Swing"
  else "Jazz"
  end
</code></pre>

caseçš„æ¯”è¾ƒæ˜¯ç”¨ <code>===</code>æ¥æ¯”è¾ƒçš„,æ‰€ä»¥ï¼Œåªè¦ç±»ä¸º<code>===</code>å®šä¹‰äº†æœ‰æ„ä¹‰çš„è¯­ä¹‰,æ­¤ç±»çš„å¯¹è±¡å°±èƒ½ç”¨åœ¨caseè¯­å¥ä¸­
éœ€è¦<code>æ³¨æ„</code>çš„æ˜¯,rubyçš„ç±»æ˜¯<code>Class</code>ç±»çš„å¯¹è±¡ï¼Œ===å·²ç»åœ¨Classç±»ä¸­å®šä¹‰äº†ï¼Œå¯ä»¥ç”¨æ¥æµ‹è¯•ç›¸åº”çš„argumentæ˜¯å¦æ˜¯receiverçš„instanceæˆ–å®ƒçš„superclassesä¹‹ä¸€ï¼Œæ‰€ä»¥ä½ å¯ä»¥æµ‹è¯•å¯¹è±¡çš„ç±»
  case shape
  when Square, Rectangle
  # &hellip;
  when Circle
  # &hellip;
  when Triangle
  # &hellip;
  else
  # &hellip;
  end

<h4>Loops</h4>

<p>whileä¸untilè¡¨è¾¾çš„æ„ä¹‰ç›¸å
  while line = gets # &hellip;
  end   <br/>
  until play_list.duration > 60</p>

<p>  play_list.add(song_list.pop)
  end
  a=1
  a*=2 whilea<100 a # => 128
  a &ndash;= 10 until a &lt; 100 a # => 98</p></li>
</ul>


<p>rangeç”¨ä½œæ¡ä»¶è¯­å¥</p>

<pre><code>file = File.open("ordinal") 
while line = file.gets
    puts(line) if line =~ /third/ .. line =~ /fifth/ 
end
produces:
third
fourth
fifth
</code></pre>

<p>rangeä¸­çš„èµ·å§‹ä½ç½®ä¹Ÿå¯ä»¥æ˜¯è¡¨è¾¾å¼</p>

<pre><code>File.foreach("ordinal") do |line|       if (($. == 1) || line =~ /eig/) .. (($. == 3) || line =~ /nin/)     print line      end 
end
produces:
first
second
third
eighth
ninthå¦‚æœä½ ç”¨`begin.....end`blockï¼Œåˆ™ä¸è®ºwhileçš„æ¡ä»¶è¯­å¥æ˜¯ä»€ä¹ˆï¼Œéƒ½ä¼š`è‡³å°‘`æ‰§è¡Œä¸€æ¬¡
print "Hello\n" while false 
begin
    print "Goodbye\n" 
end while false
produces:
Goodbye
</code></pre>

<h4>Iterators</h4>

<pre><code>3.times do

print "Ho! "
end
produces:
Ho! Ho! Ho!
</code></pre>

<p>uptoæœ‰ä½¿ç”¨</p>

<pre><code>0.upto(9) do |x|
print x, " "
end
produces:
0123456789step
0.step(12, 3) {|x| print x, " " } 
produces:
0 3 6 9 12
</code></pre>

<p>arrayçš„éå†</p>

<pre><code>[ 1, 1, 2, 3, 5 ].each {|val| print val, " " } 
produces:
11235
</code></pre>

<p>each</p>

<pre><code>File.open("ordinal").grep(/d$/) do |line| 

    puts line
end
produces:
second
third
</code></pre>

<p>loopçš„ä½¿ç”¨</p>

<pre><code>loop do     # block ... end
</code></pre>

<p>for&hellip;in</p>

<pre><code>for song in playlist

song.play
end
</code></pre>

<p>å¦‚æœæŒ‰ä»¥ä¸Šè¿™ä¹ˆå†™ï¼Œåˆ™Rubyä¼šå°†å®ƒç¿»è¯‘æˆ</p>

<pre><code>playlist.each do |song|

    song.play
endä½ å¯ä»¥å°†for....inç”¨åœ¨ä»»ä½•å®šä¹‰äº†eachçš„æ–¹æ³•çš„ç±»ä¸Š
for i in File.open("ordinal").find_all {|line| line =~ /d$/} 
    print i.chomp, " "
end

class Periods 
    def each
    yield "Classical" 
    yield "Jazz" 
    yield "Rock"
    end 
end
periods = Periods.new 
for genre in periods
print genre, " " end
produces:
Classical 
Jazz 
Rock
</code></pre>

<h5>break,redo,next</h5>

<p>breakå’Œnextåé¢å¯ä»¥è·Ÿä¸€ä¸ªvalue</p>

<pre><code>result = while line = gets
            break(line) if line =~ /answer/
         end process_answer(result) if result
</code></pre>

<h4>ä½œç”¨åŸŸ</h4>

<p>æ³¨æ„ä»¥ä¸‹ä»£ç ä¸­,açš„èµ‹å€¼è¯­å¥è™½ç„¶æ²¡æœ‰æ‰§è¡Œï¼Œä½†åœ¨ä¹‹åçš„è¯­å¥ä¸­aä»ç„¶å¯ç”¨</p>

<pre><code>a = "never used" if false 
[99].each do |i|
    a = i # this sets the variable in the outer scope 
end
a # =&gt; 99
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[More About Methods]]></title>
    <link href="http://xiekunRonaldo.github.io/blog/2014/07/29/more-about-methods/"/>
    <updated>2014-07-29T22:17:21+08:00</updated>
    <id>http://xiekunRonaldo.github.io/blog/2014/07/29/more-about-methods</id>
    <content type="html"><![CDATA[<h5>å®šä¹‰ä¸€ä¸ªæ–¹æ³•</h5>

<p>ä¸€ä¸ªæ–¹æ³•ç”¨å…³é”®å­—defæ¥å®šä¹‰ï¼Œæ–¹æ³•ååº”è¯¥ä»¥ä¸€ä¸ªå°å†™å­—æ¯æˆ–ä¸€ä¸ªä¸‹åˆ’çº¿å¼€å¤´ï¼Œç´§è·Ÿç€å­—æ¯ï¼Œæ•°å­—å’Œä¸‹åˆ’çº¿,æ–¹æ³•åä¹Ÿè®¸ä»¥ä¸€ä¸ª?,!æˆ–=å·ç»“å°¾ï¼Œä¸€ä¸ªè¿”å›boolå€¼çš„æ–¹æ³•é€šå¸¸ä»¥ä¸€ä¸ª?ç»“æœ</p>

<pre><code>1.even? # =&gt; false 

2.even? # =&gt; true 

1.instance_of?(Fixnum) # =&gt; true
</code></pre>

<p>å±é™©çš„æ–¹æ³•ï¼Œæˆ–æ˜¯ä¿®æ”¹è°ƒç”¨è€…çš„æ–¹æ³•ï¼Œå¯ä»¥ç”¨ä¸€ä¸ª!æ¥ç»“å°¾,æœ‰æ—¶è¿™äº›æ–¹æ³•å«åš<code>bang methods</code>,æ¯”å¦‚ï¼Œç±»Stringæä¾›äº†chopå’Œchopï¼ä¸¤ç§æ–¹æ³•ï¼Œå‰è€…è¿”å›äº†ä¸€ä¸ªä¿®æ”¹çš„stringï¼Œåè€…åˆ™ä¿®æ”¹äº†è°ƒç”¨æ­¤æ–¹æ³•çš„å­—ç¬¦ä¸²
èƒ½å‡ºç°åœ¨èµ‹å€¼è¿ç®—ç¬¦<code>=</code>å·¦è¾¹çš„æ–¹æ³•ä»¥ä¸€ä¸ª<code>=</code>ç»“å°¾,å¦‚</p>

<pre><code>class BookInStock
        attr_reader :isbn, :price
    def initialize(isbn, price) 
    @isbn = isbn
    @price = Float(price)
    end
    def price=(new_price) 
    @price = new_price
    end     # ...   end
book = BookInStock.new("isbn1", 33.80) 
book.price = book.price * 0.75
</code></pre>

<p>æœ‰å‚å’Œæ— å‚æ–¹æ³•å®šä¹‰å¦‚ä¸‹</p>

<pre><code>def my_new_method(arg1, arg2, arg3) # 3 arguments 

    # Code for the method would go here end
def my_other_new_method # No arguments 
    # Code for the method would go here     end
</code></pre>

<p>å¯ä»¥ä¸ºå‚æ•°æŒ‡å®šé»˜è®¤å€¼</p>

<pre><code>    def cool_dude(arg1="Miles", arg2="Coltrane", arg3="Roach") 
    "#{arg1}, #{arg2}, #{arg3}."
end

cool_dude                           # =&gt; "Miles, Coltrane, Roach."
            cool_dude("Bart")                   # =&gt; "Bart, Coltrane, Roach."
cool_dude("Bart", "Elwood")         # =&gt; "Bart, Elwood, Roach."
cool_dude("Bart", "Elwood", "Linus") # =&gt; "Bart, Coltrane, Linus."
</code></pre>

<p>åä¸€ä¸ªå‚æ•°çš„é»˜è®¤å€¼ä¹Ÿå¯ä»¥æŒ‡å®šä¸ºä¸å‰ä¸€ä¸ªå‚æ•°ç›¸å…³çš„è¡¨è¾¾å¼</p>

<pre><code>def surround(word, pad_width=word.length/2) 
    "[" * pad_width + word + "]" * pad_width
end
surround("elephant") # =&gt; "[[[[elephant]]]]" 
surround("fox") # =&gt; "[fox]"
surround("fox", 10) # =&gt; "[[[[[[[[[[fox]]]]]]]]]]"#####å¯å˜å‚æ•°
def varargs(arg1, *rest)
    "arg1=#{arg1}. rest=#{rest.inspect}"
end
varargs("one")                  # =&gt; arg1=one.  rest=[]
varargs("one", "two")           # =&gt; arg1=one.  rest=["two"]
varargs "one", "two", "three"   # =&gt; arg1=one.  rest=["two", "three"]   
</code></pre>

<p>æœ‰æ—¶æˆ‘ä»¬ç”¨*æ¥æŒ‡å®šä¸è¢«æ­¤ç±»æ–¹æ³•ä½†è¢«superclassä¸­çš„æ­¤åŒåæ–¹æ³•è°ƒç”¨çš„å‚æ•°,æ³¨æ„è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬ç›´æ¥è°ƒç”¨super(æ— ä»»ä½•å‚æ•°)ï¼Œè¿™ç§ç‰¹æ®Šçš„æƒ…å†µä¸‹æ„å‘³ç€&#8221;åœ¨superclassä¸­è°ƒç”¨æ­¤æ–¹æ³•ï¼Œæ­¤æ‰€æœ‰çš„å‚æ•°ä¼ åˆ°æ­¤ç±»superçš„åŒåæ–¹æ³•&#8221;</p>

<pre><code>class Child &lt; Parent
def do_something(*not_used)
    # our processing
super end
end
</code></pre>

<p>ä½ ä¹Ÿå¯ä»¥åªå†™ä¸€ä¸ª*</p>

<pre><code>class Child &lt; Parent 

    def do_something(*)
            # our processing
            super 
        end
end
</code></pre>

<p>ä½ å¯ä»¥å°†å¸¦*çš„å‚æ•°æ”¾åœ¨æ–¹æ³•å‚æ•°åˆ—è¡¨çš„ä»»æ„ä½ç½®</p>

<pre><code>def split_apart(first, *splat, last)
        puts "First: #{first.inspect}, splat: #{splat.inspect}, " +     "last: #{last.inspect}" 
end
split_apart(1,2)
split_apart(1,2,3)
split_apart(1,2,3,4)
produces:
First: 1, splat: [], last: 2
First: 1, splat: [2], last: 3
First: 1, splat: [2, 3], last: 4
ä½ ä¹Ÿå¯ä»¥åªå…³å¿ƒèµ·å§‹çš„å‚æ•°ï¼Œè¿™æ ·ï¼Œä½ å¯ä»¥åƒä»¥ä¸‹è¿™æ ·å®šä¹‰æ–¹æ³•
def split_apart(first, *, last)
</code></pre>

<h5>Methods and Blocks</h5>

<p>æ–¹æ³•å¯ä»¥ç”¨yieldæ¥è°ƒç”¨ä¸å®ƒç›¸å…³è”çš„block</p>

<pre><code>def double(p1) yield(p1*2)
end
double(3) {|val| "I got #{val}" } # =&gt; "I got 6" 
double("tom") {|val| "Then I got #{val}" } # =&gt; "Then I got tomtom"å¦‚æœä¸€ä¸ªæ–¹æ³•çš„æœ€åä¸€ä¸ªå‚æ•°ä»¥&amp;å¼€å¤´ï¼Œä»»ä½•ç›¸å…³çš„blockéƒ½èƒ½å½“ä½œå‚æ•°ä¼ å…¥æ–¹æ³•å¹¶è¢«è½¬åŒ–ä¸ºä¸€ä¸ªProcå¯¹è±¡
class TaxCalculator
    def initialize(name, &amp;block)
            @name, @block = name, block
        end
        def get_tax(amount)
            "#@name on #{amount} = #{ @block.call(amount) }" 
        end
end
tc = TaxCalculator.new("Sales tax") {|amt| amt * 0.075 } 
tc.get_tax(100) # =&gt; "Sales tax on 100 = 7.5"
tc.get_tax(250) # =&gt; "Sales tax on 250 = 18.75"
</code></pre>

<h5>è°ƒç”¨æ–¹æ³•</h5>

<pre><code>connection.download_mp3("jitterbug") {|p| show_progress(p) } //å¯¹è±¡

File.size("testfile") # =&gt; 66           //ç±»

Math.sin(Math::PI/4) # =&gt; 0.7071067811865475    //Module
</code></pre>

<p>å¦‚æœçœç•¥äº†receiver,é»˜è®¤æ˜¯self</p>

<pre><code>class InvoiceWriter
        def initialize(order)

        @order = order
                end
    def write_on(output)
        write_header_on(output)
        write_body_on(output)
        write_totals_on(output)
    end

private     def write_header_on(output)
    # ...
    end
    def write_body_on(output)
    # ...
    end
    def write_totals_on(output)
    # ...
    end 
end#####å°†å‚æ•°ä¼ ç»™æ–¹æ³•
</code></pre>

<p>åœ¨ä¸å¼•èµ·æ­§ä¹‰çš„æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥çœç•¥æ‹¬å·ï¼Œä¸è¿‡é€šå¸¸ä¸æ¨èè¿™ä¹ˆåš</p>

<pre><code># for some suitable value in 
obj: a = obj.hash # Same as
a = obj.hash() # this.
obj.some_method "Arg1", arg2, arg3 # Same thing as //1.8ä¹‹å‰
obj.some_method("Arg1", arg2, arg3) # with parentheses. å¦‚æœä½ å°†å¤šä¸ªå‚æ•°ä¼ ç»™returnè¯­å¥ï¼Œæ–¹æ³•å°†ä¼šä»¥æ•°ç»„çš„å½¢å¼è¿”å›è¿™äº›å‚æ•°
def meth_three 100.times do |num|
   square = num*num
return num, square if square &gt; 1000 end
end
meth_three # =&gt; [32, 1024]
</code></pre>

<p>ä½ å¯ä»¥æŒ‰ä»¥ä¸‹æ–¹å¼æ¥è·å–è¿”å›çš„å€¼</p>

<pre><code>num, square = meth_three 
num # =&gt; 32
square # =&gt; 1024    
</code></pre>

<h5>*!åœ¨æ–¹æ³•è°ƒç”¨ä¸­å±•å¼€Collections</h5>

<pre><code>def five(a, b, c, d, e)
    "I was passed #{a} #{b} #{c} #{d} #{e}"
end
five(1,2,3,4,5) #=&gt;"Iwaspassed12345" 
five(1, 2, 3, *['a', 'b']) # =&gt; "I was passed 1 2 3 a b" 
five(*['a', 'b'], 1, 2, 3) # =&gt; "I was passed a b 1 2 3" five(*(10..14)) 
#=&gt;"Iwaspassed1011121314" 
five(*[1,2], 3, *(4..5)) #=&gt;"Iwaspassed12345"
</code></pre>

<p>Ruby 1.9ä¸­ï¼Œ å¸¦*å‚æ•°å¯ä»¥å‡ºç°å‚æ•°åˆ—è¡¨ä¸­çš„ä»»æ„ä½ç½®</p>

<h5>Blockçš„å¦™ç”¨</h5>

<p>å…ˆæ¥çœ‹ä¸€æ®µä»£ç </p>

<pre><code>print "(t)imes or (p)lus: " operator = gets
print "number: "
number = Integer(gets)
if operator =~ /^t/
puts((1..10).collect {|n| n*number }.join(", "))
else
puts((1..10).collect {|n| n+number }.join(", ")) 
end
produces:
(t)imes or (p)lus: t
number: 2
2, 4, 6, 8, 10, 12, 14, 16, 18, 20
</code></pre>

<p>ä»¥ä¸Šçš„ä»£ç èƒ½å·¥ä½œï¼Œä½†æ˜¯å¾ˆä¸‘é™‹ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ifå’Œelseçš„è¯­å¥å‡ ä¹ä¸€æ ·ï¼Œå¯ä»¥ç”¨blockæ¥æ”¹è¿›å¦‚ä¸‹</p>

<pre><code>print "(t)imes or (p)lus: " 
operator = gets
print "number: "
number = Integer(gets)
if operator =~ /^t/
calc = lambda {|n| n*number }
else
  calc = lambda {|n| n+number }
end
puts((1..10).collect(&amp;calc).join(", "))
produces:
(t)imes or (p)lus: t
number: 2
2, 4, 6, 8, 10, 12, 14, 16, 18, 20
</code></pre>

<p>å¦‚æœæ–¹æ³•çš„æœ€åä¸€ä¸ªå‚æ•°æ˜¯ä»¥&amp;å¼€å¤´çš„ï¼Œåˆ™Rubyè®¤ä¸ºå®ƒæ˜¯ä¸€ä¸ªProcå¯¹è±¡ï¼Œæ–¹æ³•å°†å®ƒç§»é™¤å‡ºå‚æ•°åˆ—è¡¨ï¼Œç„¶åå°†Procå¯¹è±¡è½¬ä¸ºblockï¼Œå†ä¸æ–¹æ³•å…³è”</p>

<h5>Hash and Keyword Arguments</h5>

<p>å…ˆæ¥çœ‹ä¸€æ®µä»£ç </p>

<pre><code>class SongList
    def search(field, params)
        # ...
        end 
end
list = SongList.new
list.search(:titles, { genre: "jazz", duration_less_than: 270 })
</code></pre>

<p>å®é™…ä¸Šè¿™ç§æ–¹å¼ä¸å€¼å¾—æ¨èï¼Œ{}å¾ˆå®¹æ˜“è®©äººè¯¯è®¤ä¸ºæ˜¯ä¸€ä¸ªblockï¼Œæ‰€ä»¥Rubyæä¾›äº†ä¸€ä¸ªæ·å¾„ï¼Œåœ¨å‚æ•°åˆ—è¡¨ä¸­ä½ å¯ä»¥ä¼ å…¥key => valueè¿™ç§å½¢å¼,åªè¦å®ƒä»¬è·Ÿåœ¨æ­£å¸¸çš„å‚æ•°ä¹‹åï¼Œåœ¨ä»»ä½•çš„*å’Œblockå‚æ•°ä¹‹å‰ï¼Œæ‰€æœ‰çš„è¿™äº›é”®å€¼å¯¹éƒ½å°†è¢«ç»„è£…æˆä¸€ä¸ªhashå‚æ•°ä¼ å…¥æ–¹æ³•ä¸­,å¯ä»¥ç•¥å»{}</p>

<pre><code>list.search(:titles, genre: "jazz", duration_less_than: 270)
</code></pre>

<h5>Keyword Argument Lists</h5>

<p>æˆ‘ä»¬ä»”ç»†ç ”ç©¶ä¸€ä¸‹searchæ–¹æ³•ï¼Œå®ƒæ¥å—ä¸€ä¸ªfieldçš„åå­—å’Œä¸€ä¸ªoptions hash,ä¹Ÿè®¸æˆ‘ä»¬æƒ³è¦é»˜è®¤çš„durationä¸º120sï¼Œå¹¶ä¸”åŠ å…¥éªŒè¯æ–¹æ³•-éæ³•çš„éªŒè¯ä¸è®©å®ƒé€šè¿‡</p>

<p>Ruby 2.0ä¹‹å‰ï¼Œä»£ç æ˜¯è¿™ä¹ˆå†™çš„</p>

<pre><code>def search(field, options)
    options = { duration: 120 }.merge(options) 
    if options.has_key?(:duration)
        duration = options[:duration]
        options.delete(:duration)
    end
    if options.has_key?(:genre)
        genre = options[:genre]
        options.delete(:genre)
    end
    fail "Invalid options: #{options.keys.join(', ')}" unless options.empty? 
    # rest of method
end å¦‚æœæ˜¯Ruby 2.0ï¼Œå¯ä»¥ç®€åŒ–ä¸ºä»¥ä¸‹
def search(field, genre: nil, duration: 120) 
    p [field, genre, duration ]
end search(:title)
search(:title, duration: 432)
search(:title, duration: 432, genre: "jazz")
produces:
[:title, nil, 120]
[:title, nil, 432]
[:title, "jazz", 432]
</code></pre>

<p>å¦‚æœä¼ å…¥çš„æ˜¯ä¸€ä¸ªéæ³•é€‰é¡¹ï¼ŒRubyå°†ä¼šæŠ¥é”™</p>

<pre><code>search(:title, duraton: 432)
produces:
//æ˜¯durationï¼Œä¸æ˜¯duraton!  prog.rb:5:in `&lt;main&gt;': unknown keyword: duraton (ArgumentError)
</code></pre>

<p>ä½ ä¹Ÿå¯ä»¥å°†å¤šä¸ªhashå‚æ•°æ•´åˆä¸ºä¸€ä¸ªhashå‚æ•°ï¼Œåªè¦åœ¨æ–¹æ³•çš„å‚æ•°åˆ—è¡¨é‡Œåœ¨æŸå‚æ•°çš„å‰é¢åŠ <code>ä¸¤ä¸ª</code>æ˜Ÿå·</p>

<pre><code>def search(field, genre: nil, duration: 120, **rest) 
    p [field, genre, duration, rest ]
end
search(:title, duration: 432, stars: 3, genre: "jazz", tempo: "slow") 
produces:
[:title, "jazz", 432, {:stars=&gt;3, :tempo=&gt;"slow"}]
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Regular Expression]]></title>
    <link href="http://xiekunRonaldo.github.io/blog/2014/07/29/regular-expression/"/>
    <updated>2014-07-29T12:59:58+08:00</updated>
    <id>http://xiekunRonaldo.github.io/blog/2014/07/29/regular-expression</id>
    <content type="html"><![CDATA[<p>æ­£åˆ™è¡¨è¾¾å¼å¦‚ä¸‹</p>

<pre><code>/cat/

/123/
</code></pre>

<p>æ­£åˆ™è¡¨è¾¾å¼<code>/.../</code>é‡Œçš„å¸¸é‡å’ŒåŒå¼•å·çš„å­—ç¬¦ä¸²ç±»ä¼¼,å®é™…ä¸Šï¼Œä½ å¯ä»¥åœ¨æ­£åˆ™é‡Œï¼Œä½ ä¹Ÿå¯ä»¥ç”¨<code>#{...}</code>è¡¨è¾¾å¼çš„æ›¿æ¢å½¢å¼</p>

<h5>Matching Strings with Patterns</h5>

<pre><code>/cat/ =~ "dog and cat" # =&gt; 8 

/cat/ =~ "catch" # =&gt; 0 

/cat/ =~ "Cat" # =&gt; nil
</code></pre>

<p>å¦‚æœä½ å–œæ¬¢ä¹Ÿå¯ä»¥æŠŠå­—ç¬¦ä¸²æ”¾åœ¨å‰é¢</p>

<pre><code>"dog and cat" =~ /cat/ # =&gt; 8 

"catch" =~ /cat/ # =&gt; 0 

"Cat" =~ /cat/ # =&gt; nil
</code></pre>

<p>æ¨¡å¼åŒ¹é…å¦‚æœå¤±è´¥ï¼Œä¼šè¿”å›nilã€ï¼Œè€Œnilåœ¨æ¡ä»¶è¡¨è¾¾å¼ä¸­ç›¸å½“äºfalseï¼Œæ‰€ä»¥å¯ä»¥æŠŠæ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…ç»“æœä½œä¸ºifå’Œwhileçš„æ¡ä»¶è¯­å¥</p>

<pre><code>str = "cat and dog"
    if str =~ /cat/
puts "There's a cat here somewhere"
end
produces:
There's a cat here somewhere
</code></pre>

<p>ä»¥ä¸‹çš„ä»£ç æ‰“å°&#8221;testfile&#8221;æ–‡ä»¶ä¸­æœ‰&#8221;on&#8221;å­—ç¬¦ä¸²çš„è¡Œ</p>

<pre><code>File.foreach("testfile").with_index do |line, index| 

puts "#{index}: #{line}" if line =~ /on/
    end
produces:
0: This is line one
3: And so on...ä½ å¯ä»¥ç”¨!~æ¥æŸ¥æ‰¾`ä¸åŒ¹é…`çš„å­—ç¬¦ä¸²

File.foreach("testfile").with_index do |line, index| 

    puts "#{index}: #{line}" if line !~ /on/
        end
produces:
1: This is line two
2: This is line three
</code></pre>

<h5>Changing Strings with Patterns</h5>

<p>subæ–¹æ³•ç”¨æ¥æŸ¥æ‰¾å¹¶æ›¿æ¢åŒ¹é…çš„å­—ç¬¦ä¸²</p>

<pre><code>str = "Dog and Cat"
    new_str = str.sub(/Cat/, "Gerbil")
puts "Let's go to the #{new_str} for a pint."
produces:
Let's go to the Dog and Gerbil for a pint.
</code></pre>

<p>subåªæ˜¯æ›¿æ¢ç¬¬ä¸€ä¸ªåŒ¹é…çš„ï¼Œè¦æ›¿æ¢å…¨å±€åŒ¹é…çš„ï¼Œå°±ç”¨gsub</p>

<pre><code>str = "Dog and Cat"
    new_str1 = str.sub(/a/, "*") 
new_str2 = str.gsub(/a/, "*") 
puts "Using sub: #{new_str1}" 
puts "Using gsub: #{new_str2}"
produces:
Using sub: Dog *nd Cat
Using gsub: Dog *nd C*t 
</code></pre>

<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œsubå’Œgsubéƒ½è¿”å›ä¸€ä¸ªå…¨æ–°çš„string,ä¸è®ºæ˜¯å¦æ›¿æ¢ï¼å¦‚æœæ›¿æ¢ï¼Œä¹Ÿè¿”å›åŸstringçš„ä¸€ä¸ªcopy
å¦‚æœä½ æƒ³è¦ä¿®æ”¹åŸå§‹çš„stringï¼Œä½ å¯ä»¥ç”¨sub!å’Œgsub!çš„å½¢å¼</p>

<pre><code>str = "now is the time" 

str.sub!(/i/, "*") 

str.gsub!(/t/, "T") 

puts str
    produces:
now *s The Time
</code></pre>

<p>ä¸è¿‡ä¸åƒsubå’Œgsubï¼Œsub!å’Œgsub!åªæœ‰åœ¨åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼æ—¶æ‰è¿”å›stringï¼Œå¦‚æœä¸åŒ¹é…ï¼Œåˆ™è¿”å›nilï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥å°†å®ƒæ”¾åœ¨æ¡ä»¶è¯­å¥ä¸­</p>

<h5>Digging Deeper</h5>

<p>æœªå®Œå¾…ç»­&hellip;.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Standard Types]]></title>
    <link href="http://xiekunRonaldo.github.io/blog/2014/07/28/standard-types/"/>
    <updated>2014-07-28T08:10:44+08:00</updated>
    <id>http://xiekunRonaldo.github.io/blog/2014/07/28/standard-types</id>
    <content type="html"><![CDATA[<p> è¿™ä¸€ç« ä¸»è¦ä»‹ç»Rubyä¸­çš„å‡ ä¸ªæ ‡å‡†ç±»å‹:numbers,strings,ranges,regular expressions</p>

<h4>Numbers</h4>

<p>Integerså¯ä»¥æ˜¯ä»»ä½•é•¿åº¦(å†…å­˜æœ‰å¤šå¤§ï¼Œé•¿åº¦å°±æœ‰å¤šå¤§),åœ¨ä¸€å®šèŒƒå›´å†…(é€šå¸¸æ˜¯pow(-2,30)&hellip;pow(2,30)-1æˆ–æ˜¯pow(-2,62)&hellip;pow(2,62)-1)çš„Integersæ˜¯ç±»Fixnumçš„å¯¹è±¡,è¶…å‡ºæ­¤èŒƒå›´çš„åˆ™æ˜¯ç±»Bignumçš„å¯¹è±¡,è¿™ä¸ªè½¬åŒ–è¿‡ç¨‹ç”±Rubyè‡ªåŠ¨æ¥å¤„ç†</p>

<pre><code>num = 10001 4.times do
    puts "#{num.class}: #{num}" num *= num
end
    produces:
       Fixnum: 10001
       Fixnum: 100020001
       Fixnum: 10004000600040001
       Bignum: 100080028005600700056002800080001
</code></pre>

<p>æˆ‘ä»¬å¯ä»¥åœ¨æ•°å­—å‰æ·»åŠ 0x,0bç­‰å‰ç¼€,æˆ–æ˜¯ä¸‹åˆ’çº¿</p>

<pre><code>123456 =&gt; 123456    # Fixnum
0d123456 =&gt; 123456      # Fixnum
123_456 =&gt; 123456       # Fixnum - underscore ignored
-543 =&gt; -543            # Fixnum - negative number
0xaabb =&gt; 43707         # Fixnum - hexadecimal
0377 =&gt; 255             # Fixnum - octal
-0b10_1010 =&gt; -42       # Fixnum - binary (negated)
123_456_789_123_456_789 =&gt; 123456789123456789 # Bignum
</code></pre>

<p>Rubyæ”¯æŒrationalå’Œcomplex number,Rational numbersæ˜¯ä¸¤ä¸ªæ•´æ•°çš„æ¯”</p>

<pre><code>Rational(3, 4) * Rational(2, 3) # =&gt; (1/2) Rational("3/4") * Rational("2/3") # =&gt; (1/2)
Complex(1, 2) * Complex(3, 4) # =&gt; (-5+10i) Complex("1+2i") * Complex("3+4i") # =&gt; (-5+10i)
</code></pre>

<p>éœ€è¦æ³¨æ„çš„æ˜¯,ä¸åƒPerlï¼Œåœ¨è¡¨è¾¾å¼è®¡ç®—æ—¶ï¼ŒStringsä¸­çš„æ•°å­—å¹¶ä¸ä¼šè‡ªåŠ¨è½¬ä¸ºæ•°å­—
å‡è®¾æœ‰ä¸€ä¸ªæ–‡å­—å¦‚ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—æ¯è¡Œä¸¤ä¸ªæ•°å­—çš„å’Œ</p>

<pre><code>3   4 

5   6 

7   8
</code></pre>

<p>ä»¥ä¸‹çš„ä»£ç å¹¶ä¸å·¥ä½œ</p>

<pre><code>some_file.each do |line| 

v1, v2 = line.split         # split line on spaces

print v1 + v2, " "
    end
produces:
34 56 78
</code></pre>

<p>åº”è¯¥å…ˆæŠŠstringsè½¬ä¸ºintegers</p>

<pre><code>some_file.each do |line|
    v1, v2 = line.split
print Integer(v1) + Integer(v2), " "
end
produces:
7 11 15
</code></pre>

<h5>How Number interact</h5>

<pre><code>1 + 2                   # =&gt; 3
1 + 2.0                 # =&gt; 3.0
1.0+2                   # =&gt; 3.0

1.0 + Complex(1,2)      # =&gt; (2.0+2i)
1 + Rational(2,3)       # =&gt; (5/3)
1.0 + Rational(2,3)     # =&gt; 1.6666666666666665
</code></pre>

<p>å¦‚æœä½ éœ€è¦é™¤æ³•èƒ½è¿”å› ä¸€ä¸ªRational number,åˆ™éœ€å¼•å…¥mathnåº“,è¿™ä¸ªåº“èƒ½å¸®æˆ‘ä»¬ä»¥æœ€<code>è‡ªç„¶</code>çš„æ–¹å¼å±•ç¤ºä¸¤æ•°è¿ç®—çš„ç»“æœ</p>

<pre><code>22 / 7 # =&gt; 3

Complex::I * Complex::I # =&gt; (-1+0i)
require 'mathn' 22 / 7 # =&gt; (22/7) 
Complex::I * Complex::I # =&gt; -1
</code></pre>

<h5>Looping Using Numbers</h5>

<pre><code>3.times { print "X " } 

1.upto(5) {|i| print i, " " } 

99.downto(95) {|i| print i, " " } 

50.step(80, 5) {|i| print i, " " }

produces:
    X X X 1 2 3 4 5 99 98 97 96 95 50 55 60 65 70 75 80
</code></pre>

<p>åŒå…¶ä»–è¿­ä»£å™¨ä¸€æ ·ï¼Œå¦‚æœå…¶åæ²¡æœ‰blockï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ªEnumeratorå¯¹è±¡</p>

<pre><code>10.downto(7).with_index {|num, index| puts "#{index}: #{num}"}
produces:
   0: 10
   1: 9
   2: 8
   3: 7
</code></pre>

<h4>Strings</h4>

<p>Stringæœ‰ä¸¤ç§ç»„æˆæ–¹å¼ï¼Œå•å¼•å·å’ŒåŒå¼•å·ç»„æˆçš„string
å•å¼•å·</p>

<pre><code> 'escape using "\\"'   # =&gt; escape using "\"
      'That\'s right'       # =&gt; That's right
</code></pre>

<p>å¦‚æœæ˜¯åŒå¼•å·,ä½ å¯ä»¥ç”¨#{expr}æ¥æ›¿æ¢stringsé‡Œçš„å€¼,å¦‚æœexpræ˜¯ä¸ªå…¨å±€å˜é‡ï¼Œç±»å˜é‡ï¼Œæˆ–æ˜¯ä¸€ä¸ªç±»çš„å®ä¾‹,èŠ±æ‹¬å·å¯ä»¥çœç•¥</p>

<pre><code>"Seconds/day: #{24*60*60}" 

"#{'Ho! '*3}Merry Christmas!" "Safe level is #$SAFE"
    # =&gt; Seconds/day: 86400
# =&gt; Ho! Ho! Ho! Merry Christmas!
    # =&gt; Safe level is 0
</code></pre>

<p>{}é‡Œçš„ä»£ç ä¸ä¸€å®šåªæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä¹Ÿå¯ä»¥ç”±å¤šæ¡è¯­å¥æ„æˆ</p>

<pre><code>puts "now is #{ def the(a)
                 'the ' + a
                end
                the('time')
                } for all bad coders..."
produces:
now is the time for all bad coders...
</code></pre>

<p>ä½ è¿˜å¯ä»¥ç”¨å¦å¤–ä¸‰ç§æ–¹å¼æ¥æ„å»ºä¸€ä¸ªstringå¸¸é‡:%q,%Qä»¥åŠhere documents
ä½ å¯ä»¥æŠŠ%qçœ‹æˆæ˜¯å•å¼•å·,%Qçœ‹æˆæ˜¯åŒå¼•å·</p>

<pre><code>%q/general single-quoted string/        # =&gt; general single-quoted string

%Q!general double-quoted string!        # =&gt; general double-quoted string

%Q{Seconds/day: #{24*60*60}}            # =&gt; Seconds/day: 86400
</code></pre>

<p>å®é™…ä¸ŠQæ˜¯å¯æœ‰å¯æ— çš„</p>

<pre><code>%!general double-quoted string! # =&gt; general double-quoted string 

%{Seconds/day: #{24*60*60}} # =&gt; Seconds/day: 86400
</code></pre>

<p>å®é™…ä¸Šç´§è·Ÿåœ¨qæˆ–Qåçš„æ˜¯åˆ†éš”ç¬¦,åˆ†éš”ç¬¦å¯ä»¥ç”±ä»»ä½•<code>nonalphanumeric</code> æˆ– <code>nonmultibyte</code>å­—ç¬¦ç»„æˆ
æœ€å,æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ç”¨<code>here document</code>æ¥åˆ›å»ºstring</p>

<pre><code>string = &lt;&lt;END_OF_STRING
    The body of the string is the input lines up to     one starting with the same text that followed the '&lt;&lt;'  END_OF_STRING
</code></pre>

<p>é€šå¸¸terminatorä»ç¬¬ä¸€è¡Œå¼€å§‹ï¼Œä¸è¿‡ï¼Œå¦‚æœä½ æŠŠä¸€ä¸ªè´Ÿå·æ”¾åœ¨&lt;&lt;åï¼Œä½ å¯ä»¥å¯¹terminatorè¿›è¡Œç¼©è¿›ï¼Œåˆ›å»ºçš„stringä¹Ÿä¼šè¿›è¡Œç¼©è¿›</p>

<pre><code>string = &lt;&lt;-END_OF_STRING
    The body of the string is the input lines up to     one starting with the same text that followed the '&lt;&lt;'  END_OF_STRING
</code></pre>

<p>ä½ ä¹Ÿå¯ä»¥å°†å¤šä¸ªhere documentsæ”¾åœ¨åŒä¸€è¡Œä¸Šï¼Œæ¯ä¸€ä¸ªä»£è¡¨ä¸€ä¸ªå•ç‹¬çš„string,here documentçš„bodiesä»source linesä¸­ä¾æ¬¡è·å–</p>

<pre><code>print &lt;&lt;-STRING1, &lt;&lt;-STRING2 
Concat
STRING1
      enate
      STRING2
produces:
Concat 
    enate
</code></pre>

<p> æ³¨æ„åœ¨æ­¤æƒ…å†µä¸‹Rubyå¹¶ä¸ä¼šå°†enateå‰çš„ç©ºæ ¼ç»™å»æ‰</p>

<h4>Strings and Encodings</h4>

<p>æ¯ä¸€ä¸ªstringéƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„encoding,ä¸€ä¸ªstringçš„é»˜è®¤çš„encodingå–å†³äºåŒ…å«å®ƒçš„æºæ–‡ä»¶çš„encoding,å¦‚æœæ²¡æœ‰æŒ‡æ˜æ˜¾å¼çš„encoding,ä¸€ä¸ªæºæ–‡ä»¶(å’Œå®ƒçš„string)åœ¨Ruby 1.9ç”¨çš„æ˜¯US-ASCIIç¼–ç ï¼ŒRuby 2åˆ™æ˜¯UTF-8</p>

<pre><code>plain_string = "dog"
    puts RUBY_VERSION
puts "Encoding of #{plain_string.inspect} is #{plain_string.encoding}"

produces:
2.0.0
Encoding of "dog" is UTF-8
</code></pre>

<p>å¦‚æœä½ åœ¨æ–‡ä»¶çš„å¼€å¤´æŒ‡æ˜ç”¨äº†å“ªä¸ªencoding,æ–‡ä»¶ä¸­æ‰€æœ‰çš„stringéƒ½ ä¼šç”¨æ­¤encoding</p>

<pre><code>#encoding: utf-8
plain_string = "dog"
puts "Encoding of #{plain_string.inspect} is #{plain_string.encoding}" utf_string = "Î´og"
puts "Encoding of #{utf_string.inspect} is #{utf_string.encoding}"
produces:
Encoding of "dog" is UTF-8
Encoding of "Î´og" is UTF-8
</code></pre>

<h6>Working with Strings</h6>

<p>å‡è®¾ä¸€ä¸ªæ–‡ä»¶æœ‰ä»¥ä¸‹æ ¼å¼</p>

<pre><code>/jazz/j00132.mp3  | 3:45 | Fats     Waller     | Ain't Misbehavin'
/jazz/j00319.mp3  | 2:58 | Louis    Armstrong  | Wonderful World
/bgrass/bg0732.mp3| 4:09 | Strength in Numbers | Texas Red
</code></pre>

<p>ç°åœ¨æˆ‘ä»¬è¦åšä»¥ä¸‹ä¸‰ä»¶äº‹æƒ…</p>

<ol>
<li>å°†æ¯ä¸€è¡Œåˆ†è§£æˆfields</li>
<li>å°†æ—¶é—´ä»mm:ssè½¬ä¸ºç§’</li>
<li><p>ç§»é™¤artistä¸­åå­—ä¸­çš„ç©ºæ ¼
å…ˆæ¥çœ‹çœ‹ç¬¬ä¸€æ­¥</p>

<pre><code>  Song = Struct.new(:title, :name, :length)
  File.open("songdata") do |song_file| songs = []
  song_file.each do |line|
  file, length, name, title = line.chomp.split(/\s*\|\s*/) 

  name.squeeze!(" ")      songs &lt;&lt; Song.new(title, name, length)
  end
    puts songs[1]
  end
  produces:
  #&lt;struct Song title="Wonderful World", name="Louis Armstrong", length="2:58"&gt;
</code></pre>

<p>æ³¨æ„ä¸Šé¢çš„line.chomp,å› ä¸ºæ¯ä¸€è¡Œéƒ½æœ‰ä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œæ‰€ä»¥å¿…é¡»æŠŠå®ƒå»æ‰
æ¥çœ‹ä¸‹å¦‚ä½•å¤„ç†æ—¶é—´,ç”¨splitä¹Ÿå¯ä»¥ï¼Œä½†æˆ‘ä»¬ç”¨æ›´å¥½çš„æ–¹å¼scan</p>

<pre><code>  Song = Struct.new(:title, :name, :length) 

  File.open("songdata") do |song_file|
  songs = []
  song_file.each do |line|
  file, length, name, title = line.chomp.split(/\s*\|\s*/) 
  name.squeeze!(" ")
  mins, secs = length.scan(/\d+/)
  songs &lt;&lt; Song.new(title, name, mins.to_i*60 + secs.to_i)
  end
  puts songs[1]
  end
  produces:
  #&lt;struct Song title="Wonderful World", name="Louis Armstrong", length=178&gt;####Ranges
</code></pre>

<p>rangesä¸»è¦ç”¨åœ¨ä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢:sequences, conditionså’Œintervals</p></li>
</ol>


<p>1.Ranges as Sequences</p>

<pre><code>1..10
'a'..'z' 0..."cat".length
</code></pre>

<p>ä½ å¯ä»¥ç”¨to_aå°†ä¸€ä¸ªrangeè½¬ä¸ºä¸€ä¸ªæ•°ç»„,ç”¨to_enumå°†å®ƒè½¬ä¸ºä¸€ä¸ªEnumberator</p>

<pre><code>(1..10).to_a # =&gt; [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] 


('bar'..'bat').to_a # =&gt; ["bar", "bas", "bat"]
enum = ('bar'..'bat').to_enum
enum.next # =&gt; "bar"
enum.next # =&gt; "bas"
</code></pre>

<p>Rangesæœ‰å¾ˆå¤šæ–¹æ³•èƒ½è®©ä½ éå†å®ƒä»¬å¹¶ä¸”ç”¨å¾ˆå¤šæ–¹æ³•æµ‹è¯•å®ƒä»¬</p>

<pre><code>digits = 0..9
digits.include?(5) # =&gt; true
digits.max # =&gt; 9
digits.reject {|i| i &lt; 5 } # =&gt; [5, 6, 7, 8, 9] 
</code></pre>

<p>digits.inject(:+) # => 45
ç›®å‰æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†numberså’Œstringsçš„rangesï¼Œå®é™…ä¸Šï¼Œrangesä¹Ÿå¯ä»¥åŸºäºä½ å®šä¹‰çš„å¯¹è±¡æ¥åˆ›å»º,æƒŸä¸€çš„è¦æ±‚æ˜¯å¯¹è±¡å¿…é¡»å®šä¹‰succæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›äº†åºåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡è¿˜å¿…é¡»å®ç°<code>&lt;=&gt;</code>(æœ‰æ—¶ç§°ä¸º<code>spaceship operator</code>),å…è®¸å¯¹è±¡ä¹‹é—´çš„æ¯”è¾ƒ,è¿”å›-1,0, 1</p>

<pre><code>class PowerOfTwo 
    attr_reader :value 
    def initialize(value)
        @value = value
    end
    def &lt;=&gt;(other)
        @value &lt;=&gt; other.value
    end
    def succ
        PowerOfTwo.new(@value + @value)
    end
    def to_s
    @value.to_s
    end 

end
p1 = PowerOfTwo.new(4)
p2 = PowerOfTwo.new(32)
puts (p1..p2).to_a
produces:
4 
8 
16 
32
</code></pre>

<h5>Ranges as Conditions</h5>

<pre><code>while line = gets
    puts line if line =~ /start/ .. line =~ /end/
end
</code></pre>

<h5>Ranges as Intervals</h5>

<p>å¯ä»¥å€Ÿæ­¤æ¥æŸ¥çœ‹æŸäº›å€¼æ˜¯å¦åœ¨rangeé—´,æ³¨æ„å¿…é¡»ç”¨<code>===</code></p>

<pre><code>(1..10) === 5 # =&gt; true

(1..10) === 15 # =&gt; false 

(1..10) === 3.14159 # =&gt; true 

('a'..'j') === 'c' # =&gt; true 

('a'..'j') === 'z' # =&gt; falseè¿˜å¯ç”¨åœ¨caseä¸­
car_age = gets.to_f # let's assume it's 9.5 
case car_age
when 0...1
    puts "Mmm.. new car smell" 
when 1...3
puts "Nice and new" 
when 3...10
    puts "Reliable but slightly dinged" 
when 10...30
    puts "Clunker" 
else
    puts "Vintage gem" 

end
produces:
Reliable but slightly dinged
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Sharing Functionality: Inheritance]]></title>
    <link href="http://xiekunRonaldo.github.io/blog/2014/07/27/sharing-functionality-inheritance/"/>
    <updated>2014-07-27T15:03:31+08:00</updated>
    <id>http://xiekunRonaldo.github.io/blog/2014/07/27/sharing-functionality-inheritance</id>
    <content type="html"><![CDATA[<h4>ç»§æ‰¿å’Œæ¶ˆæ¯</h4>

<pre><code>class Parent 

    def say_hello   
    puts "Hello from #{self}" 
    end
end
p = Parent.new
p.say_hello
    class Child &lt; Parent # Subclass the parent...

end 
c = Child.new
c.say_hello
produces:
Hello from #&lt;Parent:0x007fb87110fd98&gt;
Hello from #&lt;Child:0x007fb87110fac8&gt;
</code></pre>

<p>superclassçš„æ–¹æ³•è¿”å›äº†ä¸€ä¸ªç±»çš„çˆ¶ç±»</p>

<pre><code>class Parent
end
class Child &lt; Parent
end
Child.superclass # =&gt; Parent
</code></pre>

<p>é‚£ä¹ˆï¼ŒParentçš„superclassæ˜¯ä»€ä¹ˆ</p>

<pre><code>class Parent
end
Parent.superclass # =&gt; Object
</code></pre>

<p>ç»§ç»­æ¢ç©¶</p>

<pre><code>Object.superclass # =&gt; BasicObject
BasicObject.superclass.inspect # =&gt; "nil"
</code></pre>

<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨ç»§æ‰¿ä½“ç³»ä¸­BasicObjectæ˜¯root class</p>

<h4>Modules</h4>

<p>Modulesæä¾›äº†ä¸€ç§å°†æ–¹æ³•ï¼Œç±»å’Œå¸¸é‡èšåˆåœ¨åŒä¸€ç©ºé—´åä¸‹çš„æ–¹å¼,Modulesæä¾›äº†ä¸¤å¤§ä¼˜åŠ¿</p>

<ol>
<li>Modulesæä¾›äº†ä¸€ä¸ªå‘½åç©ºé—´ï¼Œå¹¶ä¸”é˜²æ­¢äº†å‘½åå†²çª</li>
<li><p>Modulesæ”¯æŒmixinçš„åŠŸèƒ½</p>

<pre><code> //trig.rb
 module Trig
     PI = 3.141592654 

     def Trig.sin(x)
     # ..
     end
     def Trig.cos(x) 

         # ..
     end 
 end
 //moral.rb
 module Moral
     VERY_BAD = 0
     BAD =1
     def Moral.sin(badness)
     # ...
     end 
 end
</code></pre>

<p>æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨å®ƒä»¬</p>

<pre><code>  require_relative 'trig' 
  require_relative 'moral'
  y = Trig.sin(Trig::PI/4)
  wrongdoing = Moral.sin(Moral::VERY_BAD)
</code></pre>

<h4>Mixins</h4>

<p>Modulesè¿˜æœ‰å¦å¤–ä¸€ä¸ªå¾ˆå¥½ç”¨çš„åŠŸèƒ½ï¼Œå®ƒä»¬å¯ä»¥åœ¨å¾ˆå¤§ç¨‹åºä¸Šé¿å…ç»§æ‰¿çš„ä½¿ç”¨,è¿™ç§æ–¹å¼å«mixin.
ä»ä»¥ä¸Šçš„moduleçš„demoä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæˆ‘ä»¬å®šä¹‰modulesçš„æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•å‰é¢åŠ äº†moduleçš„åå­—,å¦‚æœä½ æƒ³åˆ°äº†ç±»æ–¹æ³•ï¼Œé‚£ä¹ˆä½ å¯èƒ½ä¼šæƒ³&#8221;æˆ‘æ˜¯å¦èƒ½åœ¨moduleé‡Œå®šä¹‰instanceæ–¹æ³•&#8221;!å¥½é—®é¢˜ï¼Œä¸€ä¸ªmoduleä¸èƒ½æœ‰instancesï¼Œå› ä¸ºmodulesä¸æ˜¯ç±»ï¼Œä¸è¿‡ä½ å¯ä»¥å°†ä¸€ä¸ªmoduleæ·»åŠ åˆ°ä¸€ä¸ªç±»çš„å®šä¹‰ä¸­ï¼Œè¿™æ ·ï¼Œæ‰€æœ‰çš„modulesçš„instanceæ–¹æ³•å°±åŒç±»ä¸­çš„instanceæ–¹æ³•ä¸€æ ·å¯ç”¨äº†ï¼Œå®ƒä»¬mixed inäº†ï¼Œå®é™…ä¸Š mixed-in æ¨¡å—æœ‰æ•ˆåœ°å……å½“äº†superclassçš„è§’è‰²
æ¥çœ‹ä¸‹demo</p>

<pre><code>  module Debug 

      def who_am_i?
          "#{self.class.name} (id: #{self.object_id}): #{self.name}"          end
  end
  class Phonograph 
      include Debug 
      attr_reader :name 
      def initialize(name)

      @name = name
  end
  # ...       end
  class EightTrack 
  include Debug 
      attr_reader :name 
      def initialize(name)
      @name = name
  end
  # ...
  end
  ph = Phonograph.new("West End Blues")
  et = EightTrack.new("Surrealistic Pillow")
  ph.who_am_i? # =&gt; "Phonograph (id: 70266478767560): West End Blues" 
  et.who_am_i? # =&gt; "EightTrack (id: 70266478767520): Surrealistic Pillow"
</code></pre></li>
</ol>


<p>mixinçš„çœŸæ­£å¨åŠ›åœ¨mixinçš„ä»£ç å¼€å§‹ä¸ä½¿ç”¨å®ƒçš„ç±»çš„ä»£ç è¿›è¡Œäº¤äº’æ—¶æ‰å¾—ä»¥ä½“ç°å‡ºç°,æˆ‘ä»¬ç”¨Rubyçš„Mixin Comparableæ¥ä½œä¸€ä¸ªä¾‹å­,Comparable mixinä¸ºç±»æ·»åŠ äº†æ¯”è¾ƒæ–¹æ³•(&lt;, &lt;=, ==, >=, å’Œ >)å’Œbetween?æ–¹æ³•ï¼Œä¸ºäº†è®©Comparableå·¥ä½œ,Comparableå‡è®¾æ‰€æœ‰ä½¿ç”¨å®ƒçš„ç±»å®šä¹‰äº†æ“ä½œç¬¦<code>&lt;=&gt;</code></p>

<pre><code>class Person
    include Comparable 
    attr_reader :name
        def initialize(name) 
            @name = name
        end
        def to_s
            "#{@name}" 
        end
        def &lt;=&gt;(other)
            self.name &lt;=&gt; other.name
        end 
    end
p1 = Person.new("Matz") 
p2 = Person.new("Guido")
    p3 = Person.new("Larry") # Compare a couple of names
if p1 &gt; p2
puts "#{p1.name}'s name &gt; #{p2.name}'s name"
end
# Sort an array of Person objects
puts "Sorted list:" 

puts [ p1, p2, p3].sort
</code></pre>

<p>produces:</p>

<pre><code>Matz's name &gt; Guido's name
Sorted list:
Guido
Larry
Matz
</code></pre>

<h4>Iterators and the Enumerable Module</h4>

<p>Rubyçš„collectionsç±»(Array, Hashç­‰)æ”¯æŒè®¸å¤šé’ˆå¯¹collectionsçš„æ“ä½œ:éå†ï¼Œæ’åºç­‰ï¼Œä½ å¯èƒ½ä¼šæƒ³:&ldquo;å¦‚æœæˆ‘çš„ç±»ä¹Ÿæ”¯æŒè¿™äº›æ“ä½œè¯¥å¤šå¥½&rdquo;</p>

<p>å¥½æ¶ˆæ¯æ˜¯ï¼Œç”±äºmixinså’Œmodule Enumberableçš„å­˜åœ¨,ä½ çš„ç±»èƒ½æ”¯æŒæ‰€æœ‰çš„è¿™äº›ç‰¹æ€§ï¼Œä½ éœ€è¦åšçš„åªæ˜¯å†™ä¸€ä¸ªeachçš„è¿­ä»£å™¨ï¼Œä¾æ¬¡è¿”å›ä½ çš„collectioné‡Œçš„å…ƒç´ ï¼Œç„¶åinclude Enumerable,è¿™æ ·ä½ çš„ç±»å°±æ”¯æŒmap,include?,find_all?è¿™äº›æ–¹æ³•äº†ï¼Œå¦‚æœåœ¨ä½ çš„collectioné‡Œçš„å¯¹è±¡ç”¨<code>&lt;=&gt;</code>æ¥å®ç°äº†ä¸€äº›æœ‰æ„ä¹‰çš„æ’åºç›¸å…³çš„æ–¹æ³•ï¼Œä½ ä¹Ÿèƒ½ä½¿ç”¨å¦‚min,max,sortç­‰çš„æ–¹æ³•</p>

<h4>Composing Modules</h4>

<p>Enumerableæ˜¯ä¸€ä¸ªæ ‡å‡†çš„mixin,å®ç°äº†é’ˆå¯¹host classä¸­çš„eachç›¸å…³çš„è®¸å¤šæ–¹æ³•,å…¶ä¸­ä¸€ä¸ªæ˜¯æˆ‘ä»¬ä¹‹å‰æåˆ°çš„injectæ–¹æ³•ï¼Œç”±äºè¦ç”¨injectå°±å¾—include Enumerableï¼Œæˆ‘ä»¬èƒ½å°†å®ƒç”¨åœ¨ä»»ä½•include Enumerableå¹¶ä¸”å®ç°äº†eachæ–¹æ³•çš„ç±»é‡Œ
æ¥çœ‹çœ‹è®¸å¤šå†…ç½®ç±»å¯¹å®ƒçš„ä½¿ç”¨</p>

<pre><code>[ 1, 2, 3, 4, 5 ].inject(:+) # =&gt; 15
( 'a'..'m').inject(:+) # =&gt; "abcdefghijklm"
</code></pre>

<p>æ¥çœ‹çœ‹å¦‚ä½•å®šä¹‰æˆ‘ä»¬è‡ªå·±çš„ç±»æ¥ä½¿ç”¨Enumerableä¸­çš„inject</p>

<pre><code>//vowel_finder.rb
class VowelFinder 
    include Enumerable
    def initialize(string)
     @string = string
    end
    def each
        @string.scan(/[aeiou]/) do |vowel| 
        yield vowel
        end 

    end
end vf = VowelFinder.new("the quick brown fox jumped")  vf.inject(:+) # =&gt; "euiooue"
</code></pre>

<p>æˆ‘ä»¬è¿˜èƒ½å°†injectçš„æ–¹æ³•å°è£…åœ¨moduleçš„æ–¹æ³•ä¸­ï¼Œå¦‚ä¸‹</p>

<pre><code>module Summable 
    def sum         inject(:+)      end end class Array         include Summable    end class Range         include Summable    end
    require_relative "vowel_finder" 
class VowelFinder
  include Summable
end
[1,2,3,4,5].sum #=&gt;15 

('a'..'m').sum # =&gt; "abcdefghijklm"
vf = VowelFinder.new("the quick brown fox jumped") 

vf.sum # =&gt; "euiooue"#### Instance Variables in Mixins
</code></pre>

<p>ä»C++è½¬è¿‡æ¥çš„ç¨‹åºå‘˜é€šå¸¸ä¼šé—®&#8221;åœ¨mixiné‡Œçš„instance variableæ˜¯å¦‚ä½•å¤„ç†çš„&#8221;
åœ¨Rubyä¸­instace variablesæ˜¯è¿™ä¹ˆå·¥ä½œçš„
ä»¥@å¼€å¤´çš„å˜é‡åœ¨å½“å‰çš„å¯¹è±¡(self)é‡Œåˆ›å»ºinstace variable
å¯¹ä¸€ä¸ªmixinè€Œè¨€,å¦‚æœä½ åœ¨ä¸€ä¸ªç±»ä¸­includeäº†module,ä½ çš„ç±»å¯¹è±¡å°†åˆ›å»ºmoduleé‡Œçš„instance variableå¹¶ä¸”å¯ä»¥ç”¨attr_readerå’Œfriendsæ¥å®šä¹‰accessors,æ¯”å¦‚,ä»¥ä¸‹ä¾‹å­ä¸­çš„Observable moduleä¸ºæ¯ä¸€ä¸ªincludeå®ƒçš„ç±»éƒ½æ·»åŠ äº†@observer_listçš„instance variable</p>

<pre><code>//observer_impl.rb

module Observable 

    def observers

        @observer_list ||= []
    end
    def add_observer(obj)
        observers &lt;&lt; obj
    end
    def notify_observers
        observers.each {|o| o.update }
    end 

end
</code></pre>

<p>ç„¶è€Œè¿™ç§æ–¹å¼å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›ä¸å¯é¢„çŸ¥çš„é”™è¯¯,ä¸€ä¸ªmixinçš„instance variableså¯èƒ½ä¼šä¸incldeå®ƒçš„host classå®šä¹‰çš„instance variablesç›¸å†²çª,ä»¥ä¸‹çš„ä¾‹å­æ˜¾ç¤ºäº†ä¸€ä¸ªä½¿ç”¨æˆ‘ä»¬çš„Observer moduleçš„ç±»çš„ä¾‹å­ï¼Œå¾ˆä¸å¹¸çš„æ˜¯ï¼Œå®ƒä¹Ÿå®šä¹‰äº†ä¸€ä¸ªå«åš@observer_listçš„instance variable,åœ¨è¿è¡Œæ—¶ï¼Œè¿™ä¸ªç¨‹åºå¯èƒ½ä¼šå¯¼è‡´æŸäº›éš¾ä»¥è°ƒè¯•çš„é”™è¯¯</p>

<pre><code>require_relative 'observer_impl' 
class TelescopeScheduler
    # other classes can register to get notifications # when the schedule changes
    include Observable
    def initialize
    @observer_list = [] # folks with telescope time
    end
    def add_viewer(viewer)
        @observer_list &lt;&lt; viewer
    end
    # ...
end
</code></pre>

<p>æ‰€ä»¥ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹,mixin moduleså¹¶ä¸ç›´æ¥ä½¿ç”¨instance variables,å®ƒä»¬ç”¨accessorsæ¥ä»clientå¯¹è±¡è·å–ä¿¡æ¯,ä¸è¿‡å¦‚æœä½ éœ€è¦åˆ›å»ºä¸€ä¸ªæœ‰å®ƒè‡ªå·±çŠ¶æ€çš„mixin,ä½ éœ€è¦ç¡®ä¿è¿™äº›instance variables<code>å¿…é¡»</code>è¦æœ‰æƒŸä¸€çš„åå­—ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªmodule-levelçš„hashï¼Œ(keyç”¨å½“å‰å¯¹è±¡çš„IDè¡¨ç¤º)æ¥å­˜å‚¨instance-specificçš„data</p>

<pre><code>module Test
    State = {}
    def state=(value)
        State[object_id] = value
    ï¿¼ï¿¼end

    def state State[object_id]
    end 
end
class Client 
    include Test
end
c1 = Client.new
c2 = Client.new 
c1.state = 'cat' 
c2.state = 'dog' 
c1.state # =&gt; "cat" 
c2.state # =&gt; "dog"
</code></pre>

<p>ä½¿ç”¨è¿™ç§æ–¹æ³•çš„åå¤„å°±æ˜¯ï¼Œå’ŒæŸä¸ªç‰¹åˆ«çš„å¯¹è±¡å…³è”çš„æ•°æ®åœ¨æ­¤å¯¹è±¡è¢«åˆ åå¹¶ä¸ä¼šé©¬ä¸Šé‡Šæ”¾ï¼Œé€šå¸¸æ¥è¯´ï¼Œä¸€ä¸ªéœ€è¦ç»´æŠ¤å®ƒè‡ªå·±çŠ¶æ€çš„mixinä¸åº”è¯¥æ˜¯ä¸ªmixinï¼Œå®ƒåº”è¯¥è¢«å†™æˆä¸€ä¸ªç±»</p>

<h4>Resolving Ambiguous Method Names</h4>

<p>å¦‚æœå¤šä¸ªè¢«includeçš„mixinsï¼Œæ­¤ç±»ï¼Œæ­¤ç±»çš„çˆ¶ç±»ä¸­æœ‰ç›¸åŒçš„æ–¹æ³•è¯¥å¦‚ä½•å¤„ç†
Rubyä¼šé¦–é€‰æŸ¥çœ‹ä¸€ä¸ªå¯¹è±¡çš„ç±»ä¸­çš„æ–¹æ³•ï¼Œç„¶åæ˜¯è¢«includeåˆ°mixins,ç„¶åæ˜¯superclassä»¥åŠå…¶ä¸­çš„mixins,å¦‚æœä¸€ä¸ªä¸ºç±»includeäº†å¤šä¸ªmixins,æœ€åè¢«includeçš„mixiné¦–å…ˆè¢«æœç´¢åˆ°</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[å®¹å™¨-å—-è¿­ä»£å™¨]]></title>
    <link href="http://xiekunRonaldo.github.io/blog/2014/07/26/rong-qi-kuai-die-dai-qi/"/>
    <updated>2014-07-26T08:51:21+08:00</updated>
    <id>http://xiekunRonaldo.github.io/blog/2014/07/26/rong-qi-kuai-die-dai-qi</id>
    <content type="html"><![CDATA[<h4>æ•°ç»„</h4>

<p>æ¥çœ‹çœ‹æ•°ç»„æ˜¯æ€ä¹ˆç”¨çš„</p>

<pre><code>a = [ 3.14159, "pie", 99 ] 
a.class # =&gt; Array 
a.length # =&gt; 3
a[0] # =&gt; 3.14159
a[1] # =&gt; "pie"
a[2] #=&gt;99
a[3] #=&gt;nil
b = Array.new 
b.class # =&gt; Array 

b.length # =&gt; 0 
b[0] = "second"
b[1] = "array"
ï¿¼b
a = [ 1, 3, 5, 7, 9 ]
a[-1] # =&gt; 9
a[-2] # =&gt; 7
a[-99] # =&gt; nil
a = [ 1, 3, 5, 7, 9 ] 
a[1,3] #=&gt;[3,5,7] 
a[3, 1] # =&gt; [7] 
a[-3,2] #=&gt;[5,7]
a = [ 1, 3, 5, 7, 9 ] 
a[1..3] #=&gt;[3,5,7] 
a[1...3] # =&gt; [3, 5] 
a[3..3] #=&gt;[7] 

a[-3..-1] # =&gt; [5, 7, 9]

a=[1,3,5,7,9]       #=&gt;[1,3,5,7,9]
a[1] = 'bat'        #=&gt; [1, "bat", 5, 7, 9]
a[-3] = 'cat'       #=&gt; [1, "bat", "cat", 7, 9]
a[3] =[9,8]         #=&gt; [1, "bat", "cat", [9, 8], 9]
a[6] = 99           #=&gt; [1, "bat", "cat", [9, 8], 9, nil, 99]

a = [ 1, 3, 5, 7, 9 ]       #=&gt;[1,3,5,7,9]
a[2, 2] = 'cat'             #=&gt; [1, 3, "cat", 9]
a[2, 0] = 'dog'             #=&gt; [1, 3, "dog", "cat", 9] 
a[1,1]=[9,8, 7]             #=&gt;[1,9,8,7,"dog","cat",9]
a[0..3] = []                #=&gt; ["dog", "cat", 9]
a[5..6] = 99, 98            #=&gt; ["dog", "cat", 9, nil, nil, 99, 98]
</code></pre>

<p>æ•°ç»„æœ‰è®¸å¤šæœ‰ç”¨çš„æ–¹æ³•ï¼Œä½¿ç”¨å®ƒä»¬ï¼Œä½ èƒ½å°†æ•°ç»„ä½œä¸ºæ ˆ(stacks),é›†å’Œ(sets),é˜Ÿåˆ—(queues),<a href="http://en.wikipedia.org/wiki/Double-ended_queue">dequeues</a>,å…ˆè¿›å…ˆå‡ºçš„queues
æ¯”å¦‚,pushå’Œpopæ–¹æ³•ä»æ•°ç»„çš„æœ«ç«¯æ·»åŠ å’Œåˆ é™¤å…ƒç´ ï¼Œæ‰€ä»¥ä½ èƒ½å°†æ•°ç»„ä½œä¸ºæ ˆæ¥ä½¿ç”¨</p>

<pre><code>stack = []
stack.push "red"
stack.push "green"
stack.push "blue"
stack # =&gt; ["red", "green", "blue"]

stack.pop # =&gt; "blue" 
stack.pop # =&gt; "green" 
stack.pop # =&gt; "red" 
stack #=&gt;[]
</code></pre>

<p>åŒæ ·åœ°,unshiftå’Œshiftä»æ•°ç»„çš„èµ·å§‹ä½ç½®æ·»åŠ å’Œåˆ é™¤å…ƒç´ ,ç»“åˆshiftå’Œpushï¼Œä½ èƒ½æ„å»ºä¸€ä¸ªFIFOçš„é˜Ÿåˆ—</p>

<pre><code>queue = []
queue.push "red" 
queue.push "green" 
queue.shift # =&gt; "red" 
queue.shift # =&gt; "green"
</code></pre>

<p>firstå’Œlastæ–¹æ³•è¿”å›ä¸€ä¸ªæ•°ç»„çš„å¤´éƒ¨å’Œå°¾éƒ¨çš„nä¸ªå…ƒç´ </p>

<pre><code>array = [ 1, 2, 3, 4, 5, 6, 7 ] 
array.first(4) # =&gt; [1, 2, 3, 4] 
array.last(4) # =&gt; [4, 5, 6, 7]
</code></pre>

<h4>å“ˆå¸Œ(å­—å…¸)åŒæ•°ç»„ä¸€æ ·,å“ˆå¸Œä¹Ÿæ˜¯é’ˆå¯¹æ•°ç»„å¼•ç”¨çš„ä»¥ç´¢å¼•æŸ¥è¯¢çš„é›†åˆ,ä¸è¿‡ä¸æ•°ç»„ä¸åŒçš„æ˜¯ï¼Œæ•°ç»„çš„ä¸‹æ ‡åªèƒ½ä¸ºæ•´å½¢ï¼Œè€Œå“ˆå¸Œçš„keyåˆ™å¯ä¸ºsymbols,strings,regular expressionç­‰</h4>

<pre><code>h = { 'dog' =&gt; 'canine', 'cat' =&gt; 'feline', 'donkey' =&gt; 'asinine' }
h.length # =&gt; 3
h['dog'] # =&gt; "canine"
h['cow'] = 'bovine'
h[12] = 'dodecine'
h['cat'] = 99
h           # =&gt; {"dog"=&gt;"canine", "cat"=&gt;99, "donkey"=&gt;"asinine", "cow"=&gt;"bovine",             # .. 12=&gt;"dodecine"}
</code></pre>

<p>ä»Ruby 1.9å¼€å§‹,å¦‚æœkeyæ˜¯symbols,ä½ å¯ä»¥ç”¨ä»¥ä¸‹æ–¹å¼åˆ›å»ºhash</p>

<pre><code>h = { :dog =&gt; 'canine', :cat =&gt; 'feline', :donkey =&gt; 'asinine' }
</code></pre>

<p>ä¹Ÿå¯ä»¥è¿™ä¹ˆå†™</p>

<pre><code>h = { dog: 'canine', cat: 'feline', donkey: 'asinine' }####ç”¨å“ˆå¸Œå’Œæ•°ç»„æ¥å®Œæˆå•è¯çš„è®¡æ•°
</code></pre>

<p>ç°åœ¨æˆ‘ä»¬è¦å®Œæˆä¸€ä¸ªdemo,ç»™å®šä¸€æ®µæ–‡å­—ï¼Œä»ä¸­è®¡ç®—å‡ºæ¯ä¸ªå•è¯å‡ºç°çš„é¢‘ç‡
æˆ‘ä»¬å°†é—®é¢˜åˆ†æˆä¸¤æ­¥</p>

<ol>
<li><p>å°†è¿™ä¸€æ®µæ–‡å­—ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶åè¿”å›æ­¤å­—ç¬¦ä¸²é‡Œçš„å•è¯(ä¿å­˜åœ¨æ•°ç»„ä¸­)</p>

<pre><code> def words_from_string(string) 
     string.downcase.scan(/[\w']+/)
 end
 p words_from_string("But I didn't inhale, he said (emphatically)")
 ç»“æœ:
 ["but", "i", "didn't", "inhale", "he", "said", "emphatically"]
</code></pre></li>
<li><p>ä¸ºæ¯ä¸€ä¸ªä¸åŒçš„å•è¯éƒ½å¼„ä¸€ä¸ªè®¡æ•°ï¼Œè¿™ä¸ªå°±ç”¨hashæ¥å®ç°</p>

<pre><code>     def count_frequency(word_list) 
     counts = Hash.new(0)
     for word in word_list
         counts[word] += 1
     end
     counts
 end
 p count_frequency(["sparky", "the", "cat", "sat", "on", "the", "mat"]) 
 produces:
 {"sparky"=&gt;1, "the"=&gt;2, "cat"=&gt;1, "sat"=&gt;1, "on"=&gt;1, "mat"=&gt;1}
</code></pre>

<p>æœ€åï¼Œè®¡ç®—å¥½äº†hashåï¼Œæˆ‘ä»¬è¦æ‰“å°å‡ºæ¥ï¼Œè¿™é‡Œæˆ‘ä»¬æ‰“ç®—æŒ‰å­—æ•°å‡ºç°é¢‘ç‡çš„å‡åºé¡ºåºæ¥æ‰“å°</p>

<pre><code>  sorted = counts.sort_by {|word, count| count}
</code></pre>

<p>ç»¼ä¸Šï¼Œæˆ‘ä»¬çš„ç¨‹åºå¦‚ä¸‹</p>

<pre><code>  require_relative "words_from_string.rb" 
  require_relative "count_frequency.rb"
  raw_text = %{The problem breaks down into two parts. First, given some text as a string, return a list of words. That sounds like an array. Then, build a count for each distinct word. That sounds like a use for a hash---we can index it with the word and use the corresponding entry to keep a count.}
  word_list = words_from_string(raw_text)
  counts    = count_frequency(word_list)
  sorted    = counts.sort_by {|word, count| count}
  top_five  = sorted.last(5)
</code></pre></li>
</ol>


<p><code>top_five  = sorted.last(5)</code>æ˜¯ä¸€ä¸ªæ•°ç»„,æ¯ä¸€ä¸ªå…ƒç´ å¯¹åº”ç€ä¸€ä¸ªkey/valueçš„pair,æ¥çœ‹çœ‹å¦‚ä½•éå†å®ƒ</p>

<pre><code>for i in 0...5 # (this is ugly code--read on 
    word = top_five[i][0] # for a better version) 
    count = top_five[i][1]
puts "#{word}: #{count}"
end
produces:
that:  2
sounds:  2
like:  2
the:  3
a: 6####å•å…ƒæµ‹è¯•
</code></pre>

<p>è¡¨é¢ä¸Šæˆ‘ä»¬å¯¹ä»¥ä¸Šçš„æ–¹æ³•è¿›è¡Œå•å…ƒæµ‹è¯•
é¦–å…ˆæ˜¯å¯¹<code>words_from_string</code></p>

<pre><code>    require_relative 'words_from_string'
    require 'test/unit'
    class TestWordsFromString &lt; Test::Unit::TestCase
        def test_empty_string
            assert_equal([], words_from_string("")) assert_equal([], words_from_string(" "))
        end
        def test_single_word
            assert_equal(["cat"], words_from_string("cat")) 
            assert_equal(["cat"], words_from_string(" cat "))
        end
        def test_many_words
            assert_equal(["the", "cat", "sat", "on", "the", "mat"],
            words_from_string("the cat sat on the mat")) 
        end

        def test_ignores_punctuation 
            assert_equal(["the", "cat's", "mat"],
            words_from_string("&lt;the!&gt; cat's, -mat-")) 

        end
    end
    produces:
    Run options:
    # Running tests:
    ....
    Finished tests in 0.006458s, 619.3868 tests/s, 929.0802 assertions/s.       4 tests, 6 assertions, 0 failures, 0 errors, 0 skips
</code></pre>

<p>åœ¨æµ‹è¯•æ¡†æ¶ä¸­ï¼Œæ‰€æœ‰ä»¥testå¼€å¤´çš„æ–¹æ³•éƒ½ä¼šè‡ªåŠ¨è¿è¡Œæˆ‘ä»¬ä¹Ÿèƒ½æµ‹è¯•è®¡ç®—å•è¯å‡ºç°æ¬¡æ•°çš„æ–¹æ³•</p>

<pre><code>    require_relative 'count_frequency' 
    require 'test/unit'
    class TestCountFrequency &lt; Test::Unit::TestCase 
        def test_empty_list
            assert_equal({}, count_frequency([]))
        end

            def test_single_word
            assert_equal({"cat" =&gt; 1}, count_frequency(["cat"])) 
        end
        def test_two_different_words
            assert_equal({"cat" =&gt; 1, "sat" =&gt; 1}, count_frequency(["cat", "sat"]))
        end
        def test_two_words_with_adjacent_repeat
            assert_equal({"cat" =&gt; 2, "sat" =&gt; 1}, count_frequency(["cat", "cat", "sat"])) 
        end
        def test_two_words_with_non_adjacent_repeat
            assert_equal({"cat" =&gt; 2, "sat" =&gt; 1}, count_frequency(["cat", "sat", "cat"]))
        end 
    end
    produces:
    Run options:
    # Running tests:
    .....
    Finished tests in 0.006327s, 790.2639 tests/s, 790.2639 assertions/s.       5 tests, 5 assertions, 0 failures, 0 errors, 0 skips
</code></pre>

<h4>å—å’Œè¿­ä»£å™¨</h4>

<p>è¿˜è®°å¾—ä¹‹å‰éå†top_fiveçš„è¯­å¥å—,å®é™…ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼æ¥éå†æ•°ç»„</p>

<pre><code>top_five.each do |word, count| 
    puts "#{word}: #{count}"
end
</code></pre>

<p>eachæ–¹æ³•å°±æ˜¯ä¸€ä¸ªè¿­ä»£å™¨-ä¸€ä¸ªä¸æ–­è°ƒç”¨å—çš„æ–¹æ³•,å®é™…ä¸Šç›¸è¾ƒäºä»¥ä¸Šçš„æ–¹æ³•ï¼Œå¾ˆå¤šç¨‹åºå‘˜æ›´æ„¿æ„å†™æˆå¦‚ä¸‹å½¢å¼</p>

<pre><code>puts top_five.map { |word, count| "#{word}: #{count}" }
</code></pre>

<p>å‡è®¾æœ‰ä»¥ä¸‹ç¨‹åº</p>

<pre><code>square = Shape.new(sides: 4) # å‡è®¾ Shape ç±»åœ¨å…¶ä»–åœ°æ–¹å®šä¹‰äº† # .. lots of code
sum = 0
[1, 2, 3, 4].each do |value| 
    square = value * value
    sum += square
end
puts sumç°åœ¨æˆ‘ä»¬è°ƒç”¨
square.draw     //æŠ¥é”™
</code></pre>

<p>å› ä¸ºåœ¨blocké‡Œsquareçš„å€¼è¢«æ”¹å˜äº†</p>

<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†ä»…ä½œç”¨åŸŸä»…åœ¨å—å†…éƒ¨çš„å˜é‡æ”¾åœ¨å—çš„å‚æ•°åˆ—è¡¨åé¢(é€šè¿‡;æ¥åˆ†éš”)æ¥é¿å…æ­¤ç±»ç°è±¡çš„å‘ç”Ÿ,å¦‚ä¸‹</p>

<pre><code>[1, 2, 3, 4].each do |value; square| 
    square = value * value
    sum += square
end
</code></pre>

<h5>yieldçš„ä½¿ç”¨</h5>

<pre><code>def fib_up_to(max) 

    i1, i2 = 1, 1 

    while i1 &lt;= max
    yield i1
        i1, i2 = i2, i1+i2
    end 
end # parallel assignment (i1 = 1 and i2 = 1)

fib_up_to(1000) {|f| print f, " " }
puts
produces:
1 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987
</code></pre>

<p>æ³¨æ„ä»¥ä¸‹è¿™è¡Œçš„ä½¿ç”¨</p>

<pre><code>print f, " "
</code></pre>

<p>ä¸€ä¸ªå—ä¹Ÿèƒ½è¿”å›ä¸€ä¸ªå€¼ï¼Œå—æœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ä¸ºyieldæ‰§è¡Œåçš„å€¼
è¿™å°±æ˜¯Arrayä¸­çš„findæ–¹æ³•å·¥ä½œçš„åŸç†</p>

<pre><code>class Array 

    def find
        each do |value|
            return value if yield(value)
        end
    nil
    end 
end [1, 3, 5, 7, 9].find {|v| v*v &gt; 30 } # =&gt; 7
</code></pre>

<p>è¿­ä»£å™¨collectçš„ä½¿ç”¨</p>

<pre><code>["H", "A", "L"].collect {|x| x.succ } # =&gt; ["I", "B", "M"]
</code></pre>

<p>è¿­ä»£å™¨å¹¶ä¸é™äºè®¿é—®arrayå’Œhashä¸­å·²å­˜åœ¨çš„å…ƒç´ ï¼Œå¦‚æˆ‘ä»¬ä¹‹å‰åœ¨Fibonacciä¸­çœ‹åˆ°çš„,ä¸€ä¸ªè¿­ä»£å™¨èƒ½è¿”å›æ¨å¯¼åçš„å€¼,</p>

<pre><code>    yield i1
        i1, i2 = i2, i1+i2
    end 
</code></pre>

<p> åŒæ ·çš„ï¼Œè¿™ç§ç‰¹æ€§ä¹Ÿè¢«Rubyç”¨åœ¨è¾“å…¥è¾“å‡ºç±»ä¸­,è¿™äº›ç±»è¿”å›äº†ä¸€ä¸ªè¿­ä»£å™¨æ¥å£ï¼Œè¿™äº›æ¥å£åœ¨I/Oæµä¸­è¿”å›äº†è¿ç»­çš„è¡Œ(æˆ–bytes),å¦‚ä¸‹</p>

<pre><code>f = File.open("testfile") 

f.each do |line|
    puts "The line is: #{line}" end
f.close

produces:
The line is: This is line one
The line is: This is line two
The line is: This is line three
The line is: And so on...
</code></pre>

<p>æœ‰æ—¶ä½ æƒ³è·Ÿè¸ªblockè¢«è°ƒç”¨äº†å¤šå°‘æ¬¡ï¼Œè¿™æ—¶ä½ å¯ä»¥è¯•è¯•with_indexæ–¹æ³•,æ­¤æ–¹æ³•ä¸€èˆ¬æ˜¯è·Ÿåœ¨ä¸€ä¸ªè¿­ä»£å™¨(å¦‚eachä¹‹å)</p>

<pre><code>f = File.open("testfile") 

f.each.with_index do |line, index|
    puts "Line #{index} is: #{line}" 

end
f.close
produces:
Line 0 is: This is line one
Line 1 is: This is line two
</code></pre>

<p>å†çœ‹ä¸€ä¸ªæœ‰ç”¨çš„è¿­ä»£å™¨</p>

<pre><code>[1,3,5,7].inject(0) {|sum, element| sum+element} # =&gt; 16 
[1,3,5,7].inject(1) {|product, element| product*element} # =&gt; 105
</code></pre>

<p>ç­‰ä»·äº</p>

<pre><code>[1,3,5,7].inject {|sum, element| sum+element} # =&gt; 16 
[1,3,5,7].inject {|product, element| product*element} # =&gt; 105
</code></pre>

<p>ç­‰ä»·äº</p>

<pre><code>[1,3,5,7].inject(:+) # =&gt; 16 
[1,3,5,7].inject(:*) # =&gt; 105####Enumberators-å¤–åœ¨è¿­ä»£å™¨
</code></pre>

<p>å°½ç®¡ä»¥ä¸Šçš„è¿­ä»£å™¨æœ‰è®¸å¤šå¥½å¤„,ä¸è¿‡å¦‚æœé‡åˆ°ä»¥ä¸‹æƒ…å†µï¼Œä½ ä¼šå‘ç°å†…éƒ¨è¿­ä»£å™¨å¸®ä¸ä¸Šä»€ä¹ˆå¿™</p>

<ol>
<li>å¦‚æœä½ è¦å°†è¿­ä»£å™¨å½“ä½œä¸€ä¸ªå¯¹è±¡æ—¶(æ¯”å¦‚ä»£è¦å°†è¿­ä»£å™¨ä¼ ç»™ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•éœ€è¦è®¿é—®è¿™ä¸ªè¿­ä»£å™¨é‡Œçš„æ¯ä¸ªå…ƒç´ )</li>
<li><p>åŒæ—¶è®¿é—®ä¸¤ä¸ªCollectionsçš„å…ƒç´ 
å¹¸è¿çš„æ˜¯ï¼ŒRubyä¸­æœ‰ä¸€ä¸ªå†…ç½®çš„Enumeratorç±»ï¼Œå®ç°äº†å¤–åœ¨çš„è¿­ä»£å™¨ï¼Œå¯ä»¥å¤„ç†ä»¥ä¸Šè¯´çš„ä¸¤ç§æƒ…å†µ
ä½ å¯ä»¥å¯¹arrayæˆ–hashæ¥è°ƒç”¨to_enumæ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªEnumberatorå¯¹è±¡</p>

<pre><code>  a = [ 1, 3, "cat" ]
  h = { dog: "canine", fox: "vulpine" }

  # Create Enumerators
  enum_a = a.to_enum
  enum_h = h.to_enum
  enum_a.next # =&gt; 1
  enum_h.next # =&gt; [:dog, "canine"] 

  enum_a.next # =&gt; 3
  enum_h.next # =&gt; [:fox, "vulpine"]
</code></pre></li>
</ol>


<p>è®¸å¤šå†…åœ¨è¿­ä»£å™¨æ–¹æ³•(äº§ç”Ÿè¿æ¥çš„å€¼ä¼ ç»™blockï¼Œå¦‚each) å¦‚æœä¸ç»“åˆblockä½¿ç”¨çš„è¯å°†è¿”å›ä¸€ä¸ªEnumeratorå¯¹è±¡</p>

<pre><code>    a = [ 1, 3, "cat" ]
    enum_a = a.each # create an Enumerator using an internal iterator
    enum_a.next # =&gt; 1 enum_a.next # =&gt; 3
</code></pre>

<p>Rubyæœ‰ä¸€ä¸ªå«åšloopçš„æ–¹æ³•ï¼Œä¸åšä»»ä½•äº‹æƒ…,ä¸»è¦å·¥ä½œå°±æ˜¯ä¸æ–­åœ°è°ƒç”¨block,é€šå¸¸æ¥è¯´ï¼Œå¦‚æœæŸäº›æ¡ä»¶å‘ç”Ÿäº†ï¼Œblockä¸­çš„ä»£ç å°†è·³å‡ºå¾ªç¯,ä½†æ˜¯å½“ä½ ç”¨Enumeratoræ—¶ï¼Œloopå¯ä»¥è¶³å¤Ÿèªæ˜åœ°åˆ†è¾¨å‡ºä¸€ä¸ªenumeratorå¯¹è±¡æ˜¯å¦éå†äº†æ‰€æœ‰çš„å€¼ï¼Œå¦‚æœéå†å®Œäº†ï¼Œloopå°†ç»ˆæ­¢</p>

<pre><code>short_enum = [1, 2, 3].to_enum 
long_enum = ('a'..'z').to_enum
loop do
    puts "#{short_enum.next} - #{long_enum.next}"
end
produces:
1-a 2-b 3-c
</code></pre>

<h4>Enumeratorsæ˜¯å¯¹è±¡</h4>

<p>Enumberatorså°†æŸäº›å¯æ‰§è¡Œçš„ä»£ç (è¿­ä»£çš„è¡Œä¸º)è½¬åŒ–æˆä¸€ä¸ªå¯¹è±¡ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥ç”¨enumeratoræ¥åšä¸€äº›æ™®é€šçš„å¾ªç¯æ— æ³•è½»æ˜“åšåˆ°çš„äº‹æƒ…,æ¯”å¦‚Enumerableæ¨¡å—å®šä¹‰äº†ä¸€ä¸ªeach_with_indexæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•è§¦å‘äº†åŸå…ˆçš„eachæ–¹æ³•ï¼ŒåŒæ—¶ä¹Ÿè¿”å›äº†ä¸€ä¸ªindex</p>

<pre><code>result = []
[ 'a', 'b', 'c' ].each_with_index {|item, index| result &lt;&lt; [item, index] }  result # =&gt; [["a", 0], ["b", 1], ["c", 2]]
</code></pre>

<p>å¦‚æœä½ æƒ³è¿­ä»£å¹¶è·å–indexä½†åˆä¸æƒ³ç”¨eachè€Œæƒ³ç”¨å…¶ä»–æ–¹æ³•æ¥æ§åˆ¶è¿­ä»£åˆè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿæ¯”å¦‚ä½ æƒ³å¾ªç¯stringé‡Œçš„æ¯ä¸ªcharacter,Enumeratoræ´¾ä¸Šç”¨åœºäº†,å¦‚æœä½ ä¸ç»™stringçš„each_charæ–¹æ³•ä¸€ä¸ªblock,å®ƒä¼šè¿”å›ä¸€ä¸ªenumerator,ç„¶åå†è°ƒç”¨enumetorçš„each_with_indexæ–¹æ³•</p>

<pre><code>result = []
"cat".each_char.each_with_index {|item, index| result &lt;&lt; [item, index] } 

result # =&gt; [["c", 0], ["a", 1], ["t", 2]]
</code></pre>

<p>å®é™…ä¸Šè¿™æ˜¯ä¸€ä¸ªå¾ˆæ™®éçš„æ–¹æ³•ï¼Œæ‰€ä»¥Matsç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæ–¹æ³•with_index</p>

<pre><code>result = []
"cat".each_char.with_index {|item, index| result &lt;&lt; [item, index] } 

result # =&gt; [["c", 0], ["a", 1], ["t", 2]]
</code></pre>

<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥æ˜¾å¼åœ°åˆ›å»ºEnumeratorå¯¹è±¡ï¼Œè¿™é‡Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨stringçš„each_charæ–¹æ³•æ¥åˆ›å»ºï¼Œç„¶åæˆ‘ä»¬å¯¹enumeratoræ¥è°ƒç”¨to_séå†å®ƒ</p>

<pre><code>enum = "cat".enum_for(:each_char) enum.to_a # =&gt; ["c", "a", "t"]
</code></pre>

<p>å¦‚æœæˆ‘ä»¬ç”¨æ¥æ„å»ºenumeratorçš„æ–¹æ³•ä¸­æœ‰å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬ä¼ å…¥enum_for</p>

<pre><code>enum_in_threes = (1..10).enum_for(:each_slice, 3) 
enum_in_threes.to_a # =&gt; [[1, 2, 3], [4, 5, 6], [7, 8, 9], [10]]
</code></pre>

<p>Enumeratorå¯¹è±¡ä¹Ÿæ˜¯å¯enumerableçš„(ä¹Ÿå°±æ˜¯è¯´ï¼Œé€‚åº”äºå¯enumerableå¯¹è±¡çš„æ–¹æ³•ä¹Ÿæ˜¯é€‚ç”¨äºenumeratorçš„),æ¯”å¦‚æˆ‘ä»¬å¯ä»¥ç”¨Enumerableçš„firstæ–¹æ³•</p>

<pre><code>    triangular_numbers = Enumerator.new do |yielder| 


        number = 0
        count = 1
        loop do
            number += count
            count  += 1
            yielder.yield number
        end 
    end
    p triangular_numbers.first(5)
    produces:
    [1, 3, 6, 10, 15]####Enumberators Are Generators and Filters
</code></pre>

<p>Generators</p>

<pre><code>triangular_numbers = Enumerator.new do |yielder| number = 0
    count = 1
            loop do
                number += count
                count += 1
                yielder.yield number
            end

end
5.times { print triangular_numbers.next, " " } 

puts
produces:
1 3 6 10 15
</code></pre>

<p>Filters</p>

<pre><code>triangular_numbers = Enumerator.new do |yielder| # ...
# as before...
# ...
end
def infinite_select(enum, &amp;block) 

Enumerator.new do |yielder|
enum.each do |value|
yielder.yield(value) if block.call(value)
end

end
end
p infinite_select(triangular_numbers) {|val| val % 10 == 0}.first(5)
produces:
[10, 120, 190, 210, 300]
</code></pre>

<p>ç­‰ä»·äº</p>

<pre><code>triangular_numbers = Enumerator.new do |yielder|
     # ... as before
end
class Enumerator
    def infinite_select(&amp;block)
        Enumerator.new do |yielder| 

            self.each do |value|
                    yielder.yield(value) if block.call(value) 
            end
        end 

    end
end
p triangular_numbers
   .infinite_select {|val| val % 10 == 0}
   .infinite_select {|val| val.to_s =~ /3/ }
   .first(5)
produces:   [300, 630, 1830, 3160, 3240]####Blockså¯ä»¥æ˜¯å¯¹è±¡
</code></pre>

<p>blockè¢«è½¬åŒ–æˆäº†Procç±»çš„å¯¹è±¡å¹¶å°†å®ƒå­˜å‚¨åœ¨ç±»çš„å±æ€§ä¸­</p>

<pre><code>class ProcExample
def pass_in_block(&amp;action)
    @stored_proc = action
end
def use_proc(parameter)
    @stored_proc.call(parameter)
end 

end

eg = ProcExample.new    eg.pass_in_block { |param| puts "The parameter is #{param}" } 
eg.use_proc(99)
</code></pre>

<p>å¦‚æœä¸€ä¸ªæ–¹æ³•è¿”å›äº†ä¸€ä¸ªblockå¯¹è±¡åˆå¦‚ä½•è°ƒç”¨?</p>

<pre><code>def create_block_object(&amp;block) 

block
end

bo = create_block_object { |param| puts "You called me with #{param}" } 
bo.call 99  bo.call "cat"   produces:   You called me with 99   You called me with cat
</code></pre>

<p>å®é™…ä¸Šè¿™ç§æ–¹å¼æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œæ‰€ä»¥Rubyæä¾›äº†ä¸¤ä¸ªæ–¹æ³•å°†ä¸€ä¸ªblockè½¬åŒ–ä¸ºä¸€ä¸ªå¯¹è±¡,lambdaå’ŒProc.newéƒ½æ¥å—äº†ä¸€ä¸ªblockæ¥åˆ›å»ºä¸€ä¸ªProcç±»çš„å¯¹è±¡</p>

<pre><code>bo = lambda { |param| puts "You called me with #{param}" } 

bo.call 99  bo.call "cat"
produces:
You called me with 99
You called me with cat
</code></pre>

<h4>Blocks Can Be Closures</h4>

<pre><code>def n_times(thing) 

    lambda {|n| thing * n }

end
p1 = n_times(23)
p1.call(3) # =&gt; 69
p1.call(4) # =&gt; 92
p2 = n_times("Hello ")
p2.call(3) # =&gt; "Hello Hello Hello "
Blocks and Iterators â€¢ 65
</code></pre>

<p>n_timesæ–¹æ³•è¿”å›äº†ä¸€ä¸ªProcå¯¹è±¡å¹¶ä¸”å¼•ç”¨äº†æ–¹æ³•çš„å‚æ•°ï¼Œthing,å°½ç®¡åˆ°blockè¢«è°ƒç”¨æ—¶ï¼Œå‚æ•°å·²ç»è¶…å‡ºèŒƒå›´äº†ï¼Œå‚æ•°ä»ç„¶èƒ½è¢«blockè®¿é—®ï¼Œè¿™å«åšclosure(ä¸Šä¸‹æ–‡çš„å‚æ•°åœ¨blockæˆ–Procçš„ç”Ÿå‘½å‘¨æœŸä¸­ä»èƒ½è¢«è®¿é—®)ï¼Œä¸¤çœ‹å¦å¤–ä¸€ä¸ªä¾‹å­</p>

<pre><code>def power_proc_generator 
    value = 1       lambda { value += value }   end power_proc = power_proc_generator   puts power_proc.call    puts power_proc.call    puts power_proc.call    produces:   2 4 8
</code></pre>

<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°vaueå€¼æ˜¯ä¸€ç›´å˜åŒ–çš„</p>

<h4>å¦ä¸€ç§åˆ›å»ºProcå¯¹è±¡çš„æ–¹å¼</h4>

<p>ä¹‹å‰æˆ‘ä»¬ç”¨ä»¥ä¸‹æ–¹å¼æ¥åˆ›å»ºProc</p>

<pre><code>lambda { |params| ... }
</code></pre>

<p>ä½ ä¹Ÿå¯ä»¥ç”¨ä»¥ä¸‹æ–¹å¼æ¥åˆ›å»º</p>

<pre><code>-&gt; params { ... }


proc1 = -&gt; arg { puts "In proc1 with #{arg}" }
proc2 = -&gt; arg1, arg2 { puts "In proc2 with #{arg1} and #{arg2}" } 

proc3 = -&gt;(arg1, arg2) { puts "In proc3 with #{arg1} and #{arg2}" }
proc1.call "ant" 

proc2.call "bee", "cat" 

proc3.call "dog", "elk"
    produces:
In proc1 with ant
In proc2 with bee and cat
In proc3 with dog and elk
</code></pre>

<p>æ¯”èµ·lambda,&ndash;>çš„å½¢å¼çœ‹ç´§å‡‘ï¼Œç‰¹åˆ«æ˜¯å½“ä½ è¦ä¼ å¤šä¸ªProcå¯¹è±¡ç»™ä¸€ä¸ªæ–¹æ³•çš„æ—¶å€™</p>

<pre><code>def my_if(condition, then_clause, else_clause) 

    if condition
        then_clause.call
    else
        else_clause.call
    end 
end
5.times do |val| 
    my_if val &lt; 2,

          -&gt; { puts "#{val} is small" }, 

          -&gt; { puts "#{val} is big" }
end
produces:
0 is small
1 is small
2 is big
3 is big
4 is big
</code></pre>

<h4>Block Parameter Lists</h4>

<pre><code>proc1 = lambda do |a, *b, &amp;block| 
    puts "a = #{a.inspect}"     
    puts "b = #{b.inspect}" 
    block.call  end proc1.call(1, 2, 3, 4) { puts "in block1" } produces:   a=1 b = [2, 3, 4] 

in block1
</code></pre>

<p>å¦ä¸€ç§å½¢å¼</p>

<pre><code>proc2 = -&gt; a, *b, &amp;block do 

    puts "a = #{a.inspect}" 

    puts "b = #{b.inspect}" 

    block.call
end
proc2.call(1, 2, 3, 4) { puts "in block2" }
produces:
a=1
b = [2, 3, 4] in block2
ï¿¼
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ç±»-å¯¹è±¡-å˜é‡]]></title>
    <link href="http://xiekunRonaldo.github.io/blog/2014/07/23/lei-dui-xiang-bian-liang/"/>
    <updated>2014-07-23T21:41:14+08:00</updated>
    <id>http://xiekunRonaldo.github.io/blog/2014/07/23/lei-dui-xiang-bian-liang</id>
    <content type="html"><![CDATA[<p>å‡è®¾æœ‰ä»¥ä¸‹æ–‡ä»¶</p>

<pre><code>        //data.csv

        "Date","ISBN","Price"
        "2013-04-12","978-1-9343561-0-4",39.45
        "2013-04-13","978-1-9343561-6-6",45.67
        "2013-04-14","978-1-9343560-7-4",36.95
</code></pre>

<p>ç°åœ¨æˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯ä»è¿™ä¸ªCSVæ–‡ä»¶ä¸­è®¡ç®—å‡ºæœ‰ç›¸åŒtitleçš„ä¹¦å„æœ‰å¤šå°‘æœ¬ï¼Œä»¥åŠä¹¦çš„æ€»ä»·
æˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªBookInStockçš„ç±»</p>

<pre><code>class BookInStock

end
</code></pre>

<p>ç”¨newæ¥åˆ›å»ºå¯¹è±¡</p>

<pre><code>a_book = BookInStock.new
</code></pre>

<p>ä»¥æ­¤åˆ›å»ºçš„ç±»æ— ä»»ä½•ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæ­¤ç±»æä¾›ä¸€ä¸ªinitializeçš„æ–¹æ³•ï¼Œæ­¤æ–¹æ³•èƒ½è®©æˆ‘ä»¬åœ¨æ¯ä¸ªå¯¹è±¡éƒ½åˆ›å»ºå¥½åå°±è®¾ç½®å¯¹è±¡çš„çŠ¶æ€ï¼Œæˆ‘ä»¬å°†æ­¤çŠ¶æ€å­˜å‚¨åœ¨å®ä¾‹å˜é‡ä¸­(ä»¥@å¼€å¤´),ç°åœ¨æˆ‘ä»¬æ›´æ–°å¦‚ä¸‹</p>

<pre><code>class BookInStock
    def initialize(isbn, price)
        @isbn = isbn
        @price = Float(price)
    end 
end
</code></pre>

<p>initializeæ˜¯ä¸€ä¸ªç‰¹åˆ«çš„æ–¹æ³•ï¼Œå½“ä½ è°ƒç”¨BookInStore.newå»åˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™,Rubyåˆ†é…äº†ä¸€äº›å†…å­˜ç»™æ­¤æœªåˆå§‹åŒ–çš„å¯¹è±¡ï¼Œç„¶åè°ƒç”¨äº†initializeçš„æ–¹æ³•ï¼Œä¼ é€’äº†ä»»ä½•ä¼ é€’ç»™newæ–¹æ³•çš„å‚æ•°ï¼Œè¿™æ ·å°±ç»™äº†ä½ ä¸€æ¬¡è®¾ç½®å¯¹è±¡çŠ¶æ€çš„æœºä¼š</p>

<pre><code>    b1 = BookInStock.new("isbn1", 3) 
p b1

produces:
    #&lt;BookInStock:0x007fac4910f3e0 @isbn="isbn1", @price=3.0&gt;
</code></pre>

<p>pæ–¹æ³•èƒ½æ‰“å°å‡ºä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºå½¢å¼(å¦‚@isbn, @price)è€Œputsæ–¹æ³•åªæ˜¯ç®€å•åœ°å°†å­—ç¬¦ä¸²è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºä¸Šï¼Œå½“ä½ å°†ä¸€ä¸ªå¯¹è±¡ä¼ ç»™putsæ—¶ï¼Œç”±äºputsä¸çŸ¥é“å¦‚ä½•å¤„ç†ï¼Œæ‰€ä»¥å®ƒä½œäº†ä¸€ä¸ªç®€å•åœ°å¤„ç†:å¯¹è±¡ç±»çš„åå­—+:+å¯¹è±¡çš„å†…å­˜åœ°å€,æˆ‘ä»¬å¯ä»¥æ”¹å˜putsçš„è¿™ç§è¾“å‡ºå½¢å¼ï¼Œåªè¦é‡å†™to_så³å¯</p>

<pre><code>class BookInStock
    def initialize(isbn, price)
            @isbn = isbn
            @price = Float(price)
    end
        def to_s
    "ISBN: #{@isbn}, price: #{@price}" 
    end
end
        b1 = BookInStock.new("isbn1", 3)
puts b1
</code></pre>

<p>ç»“æœ  ISBN: isbn1, price: 3.0</p>

<h5>å¯¹è±¡å’Œå±æ€§</h5>

<p>ä»¥ä¸Šçš„@isbn, @priceä¸èƒ½è®¿é—®ï¼Œæ— ä»»ä½•æ„ä¹‰ï¼Œå¯ä»¥ä¸ºå®ƒæ·»åŠ getæ–¹æ³•</p>

<pre><code>class BookInStock
    def initialize(isbn, price)
        @isbn = isbn
        @price = Float(price)
    end
    def isbn
        @isbn
    end

    def price 
        @price
    end
# ..
end
book = BookInStock.new("isbn1", 12.34) 

puts "ISBN = #{book.isbn}"
puts "Price = #{book.price}"
</code></pre>

<p>ç»“æœ</p>

<pre><code>    ISBN   = isbn1
Price  = 12.34
</code></pre>

<p>ç”±äºgetæ–¹æ³•çš„ä½¿ç”¨æ˜¯å¦‚æ­¤é¢‘ç¹,Rubyæä¾›äº†ä¸€ä¸ªç®€ä¾¿çš„æ–¹æ³•ï¼Œattr_readerèƒ½ä¸ºä½ åˆ›å»ºè¿™äº›å±æ€§çš„getæ–¹æ³•</p>

<pre><code>class BookInStock   
  attr_reader :isbn, :price
    def initialize(isbn, price) 
        @isbn = isbn
        @price = Float(price)
    end     # ..    end book = BookInStock.new("isbn1", 12.34) 

puts "ISBN = #{book.isbn}"
    puts "Price = #{book.price}"
</code></pre>

<p>ç»“æœ: ISBN   = isbn1  Price  = 12.34å¯¹åº”,attr_readeråé¢è·Ÿçš„æ˜¯symbols
è¿™é‡Œé€šå¸¸æœ‰ä¸€ä¸ªè¯¯è§£ï¼Œç‰¹åˆ«æ˜¯é‚£äº›å­¦è¿‡Javaå’ŒC#çš„äºº,ä»–ä»¬è®¤ä¸ºattr_readeråœ¨æŸç§ç¨‹åºä¸Šå£°æ˜äº†å®ä¾‹å˜é‡ï¼Œå®é™…ä¸Šæ˜¯æ²¡æœ‰çš„ï¼Œå®ƒåªæ˜¯ç”Ÿæˆäº†è®¿é—®æ–¹æ³•ï¼Œä½†æ— å£°æ˜ä»»ä½•å˜é‡ï¼Œè¿™äº›å˜é‡åªæœ‰åœ¨ä½ ä½¿ç”¨å®ƒä»¬çš„æ—¶å€™æ‰å‡ºç°ï¼ŒRubyæ˜¯å®Œå…¨è®©å®ä¾‹å˜é‡ä¸è®¿é—®æ–¹æ³•è§£è—•çš„</p>

<h4>å¯å†™å±æ€§</h4>

<p>ä»¥ä¸Šæˆ‘ä»¬åªæ˜¯è®¾ç½®äº†åªè¯»æ–¹æ³•,ç°åœ¨æˆ‘çœ‹çœ‹å¦‚ä½•è®¾ç½®å¯å†™æ–¹æ³•</p>

<pre><code>class BookInStock
    attr_writer :isbn, :price
    def initialize(isbn, price) 

        @isbn = isbn
        @price = Float(price)
    end
    def price=(new_price) 
        @price = new_price
    end
# ...
end

book = BookInStock.new("isbn1", 33.80) 
puts "ISBN = #{book.isbn}"
puts "Price = #{book.price}" 
book.price = book.price * 0.75
puts "New price = #{book.price}"
</code></pre>

<p>ç»“æœ:</p>

<pre><code>ISBN      = isbn1
Price     = 33.8
New price = 25.349999999999998
</code></pre>

<p>åŒæ ·çš„,Rubyä¹Ÿæä¾›äº†ä¸€ä¸ªåˆ›å»ºå±æ€§è®¾ç½®æ–¹æ³•çš„æ·å¾„ï¼Œå¦‚æœä½ æƒ³æœ‰ä¸€ä¸ªåªå†™ä¸å¯è¯»çš„æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨attr_writer,ä¸è¿‡è¿™ç§æƒ…å†µæå…¶ç½•è§ï¼Œå¦‚æœä½ æƒ³ä¸ºæŸä¸ªå±æ€§è®¾ç½®å¯è¯»å¯å†™çš„æ–¹æ³•ï¼Œä½ å¯ä»¥ç”¨attr_accessor</p>

<pre><code>    class BookInStock 
    attr_reader :isbn 
    attr_accessor :price
    def initialize(isbn, price) 
        @isbn = isbn
        @price = Float(price)
    end
# ...   end
book = BookInStock.new("isbn1", 33.80) 
puts "ISBN = #{book.isbn}"
puts "Price = #{book.price}" 
book.price = book.price * 0.75
puts "New price = #{book.price}"
ç»“æœ: ISBN      = isbn1
Price     = 33.8
New price = 25.349999999999998
</code></pre>

<h4>è™šå±æ€§</h4>

<pre><code>class BookInStock 

    attr_reader :isbn
    attr_accessor :price
    def initialize(isbn, price) 

        @isbn = isbn
        @price = Float(price)
    end
    def price_in_cents 
        Integer(price*100 + 0.5)
    end
# ...
end
</code></pre>

<p>æˆ‘ä»¬çœ‹çœ‹ä»¥ä¸‹ä¼šè¾“å‡ºä»€ä¹ˆ</p>

<pre><code>puts "Price in cents = #{book.price_in_cents}"
</code></pre>

<p>ç»“æœ</p>

<pre><code>rice in cents = 3380
</code></pre>

<p><code>book.price_in_cents</code>è¡¨ç¤ºçš„å°±æ˜¯è™šå±æ€§ï¼Œç”±äº<code>price_in_cents</code>ä¸å¯¹åº”ä»»ä½•å¯¹è±¡çš„å±æ€§ï¼Œä½†æˆ‘ä»¬å´æä¾›äº†è®¿é—®æ–¹æ³•ï¼Œä¾ç„¶å¯ä»¥é€šè¿‡.çš„å½¢å¼è®¿é—®å®ƒ,åŒæ ·çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æä¾›ä¸€ä¸ªå®ƒçš„å†™æ–¹æ³•</p>

<pre><code>def price_in_cents=(cents) 

    @price = cents / 100.0  end

book = BookInStock.new("isbn1", 33.80)
puts "Price = #{book.price}"
puts "Price in cents = #{book.price_in_cents}" 


book.price_in_cents = 1234
puts "Price = #{book.price}"
puts "Price in cents = #{book.price_in_cents}"
produces:
Price          = 33.8
Price in cents = 3380
Price          = 12.34
Price in cents = 1234
</code></pre>

<h4>ç±»ä¸å…¶ä»–ç±»çš„ååŒå·¥ä½œ</h4>

<p>å·²çŸ¥BookInStockå®šä¹‰å¦‚ä¸Š,ç°åœ¨ä¸å°‘csvæ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦å°†csvæ–‡ä»¶çš„æ¯ä¸€è¡Œè½¬ä¸ºä¸€ä¸ªBookInStock,å¹¶å°†æ¯ä¸€ä¸ªBookInStockä¿å­˜åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œç„¶åè®¡ç®—æ‰€æœ‰ä¹¦çš„æ€»ä»·,æ‰€è®¡ç®—çš„å‡ ä¸ªcsvæ–‡ä»¶æˆ‘ä»¬é€šè¿‡å‘½ä»¤è¡Œä¼ å…¥,ç°åœ¨æˆ‘ä»¬å°†è¿™ä¸ªç¨‹åºåˆ†æˆä¸‰ä¸ªrbæ–‡ä»¶æ¥æ“ä½œ(å‡è®¾è¿™ä¸‰ä¸ªæ–‡ä»¶åœ¨åŒä¸€ç›®å½•ä¸‹)</p>

<ol>
<li><p>book_in_stock.rb</p>

<pre><code> class BookInStock 

     attr_reader :isbn, :price
     def initialize(isbn, price) 
         @isbn = isbn
         @price = Float(price)
     end 
 end
</code></pre></li>
</ol>


<p>2.csv_reader.rb
æ­¤æ–‡ä»¶æœ‰ä¸¤ä¸ªå¤–éƒ¨ä¿¡èµ–ï¼Œå®ƒéœ€è¦æ ‡å‡†çš„CSVçš„åº“ï¼Œä¹Ÿéœ€è¦å­˜å‚¨åœ¨book_in_stock.rbä¸­çš„BookInStockçš„ç±»,æˆ‘ä»¬ç”¨requireæ¥åŠ è½½Rubyçš„CSVåº“ï¼Œç”¨require_relativeæ¥åŠ è½½book_in_stockæ–‡ä»¶</p>

<pre><code>require 'csv'
require_relative 'book_in_stock'

class CsvReader 

    def initialize
        @books_in_stock = []
    end
    def read_in_csv_data(csv_file_name) 
        CSV.foreach(csv_file_name, headers: true) do |row|
            @books_in_stock &lt;&lt; BookInStock.new(row["ISBN"], row["Price"]) 
        end
    end 
end
</code></pre>

<p>3.stock_stats.rb
è¿™æ˜¯æˆ‘ä»¬çš„ä¸»ç¨‹åº</p>

<pre><code>require_relative 'csv_reader'   reader = CsvReader.new
ARGV.each do |csv_file_name|        STDERR.puts "Processing #{csv_file_name}" 
    reader.read_in_csv_data(csv_file_name)  end
ï¿¼ï¿¼ï¿¼puts "Total value = #{reader.total_value_in_stock}"
</code></pre>

<p>è¿è¡Œç¨‹åºå¦‚ä¸‹</p>

<pre><code>$ ruby stock_stats.rb data.csv
Processing data.csv
Total value = 122.07000000000001
</code></pre>

<h5>è®¿é—®æ§åˆ¶</h5>

<p>Rubyç»™ä½ ä¸‰ç§è®¿é—®æ§åˆ¶æƒé™</p>

<ul>
<li>Public</li>
<li>Protected</li>
<li>Private
ä¸‰ç§è®¿é—®æ§åˆ¶æƒé™ä¸å…¶ä»–è¯­è¨€çš„ä¸€æ ·ï¼Œä¸è¿‡æœ‰ä¸€ç‚¹ä¸å…¶ä»–é¢å‘å¯¹è±¡çš„è¯­è¨€å¾ˆä¸ä¸€æ ·ï¼Œé‚£å°±æ˜¯ï¼ŒRubyä¸­çš„è®¿é—®æ§åˆ¶æ˜¯ç¨‹åºè¿è¡Œåæ‰è¢«ç¡®å®šçš„ï¼Œæ˜¯åŠ¨æ€çš„ï¼Œè€Œä¸æ˜¯é™æ€çš„ï¼Œåªæœ‰å½“ä»£ç æ‰§è¡Œäº†è®¿é—®å—é™çš„ä»£ç æ‰èƒ½çŸ¥é“æ˜¯å¦æœ‰è®¿é—®ä¸åˆæ³•çš„é”™è¯¯å‘ç”Ÿ

<h6>å¦‚ä½•æŒ‡å®šè®¿é—®æ§åˆ¶</h6>

<p>æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ³•</p>

<pre><code>  class MyClass

      def method1     # é»˜è®¤æ˜¯ 'public'

      #...

      end

  protected

      def method2

      #....

      end

  private 

      def method3

      #...

      end

  end
</code></pre></li>
</ul>


<p>æˆ–</p>

<pre><code>    class MyClass 

        def method1 

        end         def method2             end
# ... and so on       public    :method1, :method4        protected :method2          private   :method3    end
</code></pre>

<h4>å˜é‡</h4>

<pre><code>    person = "Tim"
    puts "The object in 'person' is a #{person.class}" 
    puts "The object has an id of #{person.object_id}" 
    puts "and a value of '#{person}'"
    produces:
       The object in 'person' is a String
       The object has an id of 70230663692980
       and a value of 'Tim'
</code></pre>

<p>é‚£ä¹ˆï¼Œå˜é‡æ˜¯å¦æ˜¯ä¸€ä¸ªå¯¹è±¡å‘¢ï¼Œç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œä¸€ä¸ªå˜é‡åªæ˜¯ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨,æ¥çœ‹ä»¥ä¸‹ä¾‹å­ï¼Œä¸€ç›®äº†ç„¶</p>

<pre><code>    person1 = "Tim"

    person2 = person1 

    person1[0] = 'J'
    puts "person1 is #{person1}" 
    puts "person2 is #{person2}"        produces:                      person1 is Jim              person2 is Jim
</code></pre>

<p>ä½ å¯ä»¥ç”¨Stringçš„
dupæ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡</p>

<pre><code>    person1 = "Tim"     person2 = person1.dup person1[0] = "J"      puts "person1 is #{person1}" puts "person2 is #{person2}"       produces:       person1 is Jim      person2 is Timæˆ‘ä»¬ä¹Ÿå¯ä»¥å†»ç»“ä¸€ä¸ªå¯¹è±¡æ¥é¿å…å¯¹å®ƒä½œå‡ºä¿®æ”¹
    person1 = "Tim"
    person2 = person1
    person1.freeze # prevent modifications to the object person2[0] = "J"
    produces:
            from prog.rb:4:in `&lt;main&gt;'
    prog.rb:4:in `[]=': can't modify frozen String (RuntimeError)
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby-new]]></title>
    <link href="http://xiekunRonaldo.github.io/blog/2014/07/23/ruby-new/"/>
    <updated>2014-07-23T20:11:08+08:00</updated>
    <id>http://xiekunRonaldo.github.io/blog/2014/07/23/ruby-new</id>
    <content type="html"><![CDATA[<h4>Rubyä¸­ä¸€åˆ‡çš†å¯¹è±¡</h4>

<p>åˆ›å»ºå¯¹è±¡ï¼Œå‡è®¾æœ‰ä¸€ä¸ªSongçš„ç±»ï¼ŒæŒ‰å¦‚ä¸‹æ–¹å¼åˆ›å»ºå®ä¾‹</p>

<pre><code>song1 = Song.new("Ruby Tuesday")
song2 = Song.new("Enveloped in Python")
</code></pre>

<p>å¦‚ä½•ç†è§£ä¸€åˆ‡çš†å¯¹è±¡ï¼Œçœ‹ä»¥ä¸‹demo</p>

<pre><code>puts "gin joint".length 
puts "Rick".index("c") 
puts 42.even?           //42æ˜¯å¦æ˜¯å¶æ•°
puts sam.play(song)
</code></pre>

<p>åœ¨javaä¸­ï¼Œå¦‚æœè¦ç®—ä¸€ä¸ªå€¼çš„ç»å¯¹å€¼ï¼Œå¯æŒ‰å¦‚ä¸‹æ–¹å¼</p>

<pre><code>num = Math.abs(num)
</code></pre>

<p>ä½†åœ¨Rubyä¸­ï¼Œç”±äºä¸€åˆ‡çš†å¯¹è±¡ï¼Œå¯æŒ‰å¦‚ä¸‹æ–¹å¼</p>

<pre><code>um = -1234          # =&gt; -1234 
positive = num.abs  # =&gt; 1234
</code></pre>

<p>åŒæ ·çš„è§„åˆ™é€‚ç”¨äºæ‰€æœ‰çš„Rubyå¯¹è±¡ï¼Œåœ¨Cä¸­ï¼Œä½ å¯ä»¥å†™strlen(name)ï¼Œä½†åœ¨rubyä¸­ï¼Œä½ å¯ä»¥å†™name.length,æ— æ¯”è½»æ¾</p>

<h5>Rubyä¸­çš„æ–¹æ³•</h5>

<p>å½¢å¼å¦‚ä¸‹</p>

<pre><code>def say_goodnight(name)
    result = "Good night, " + name
    return result
end

    # Time for bed...
puts say_goodnight("John-Boy") 
puts say_goodnight("Mary-Ellen")
</code></pre>

<p>æ— éœ€åˆ†å·è¡¨ç¤ºæ¯ä¸ªè¯­å¥çš„ç»“å°¾ï¼Œåªè¦ä½ æŠŠæ¯ä¸€æ¡è¯­å¥éƒ½æ”¾åœ¨ä¸€å•ç‹¬çš„è¡Œä¸Š    puts say_goodnight(&ldquo;Mary-Ellen&rdquo;)
ç›¸å½“äº</p>

<pre><code>puts(say_goodnight("Mary-Ellen"))
</code></pre>

<h5>å­—ç¬¦ä¸²</h5>

<p>åˆ›å»ºå­—ç¬¦ä¸²æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€ç§æ˜¯å•å¼•å·æ‹¬èµ·æ¥çš„ï¼Œä¸€ç§æ˜¯åŒå¼•å·æ‹¬èµ·æ¥çš„,åŒå¼•å·æ‹¬èµ·æ¥çš„å­—ç¬¦ä¸²ï¼Œrubyéœ€è¦åšæ›´å¤šçš„å·¥ä½œï¼Œé¦–å…ˆï¼Œrubyä¼šå¯»æ‰¾ä»¥åæ–œæ å¼€å¤´çš„åºåˆ—ï¼Œå¹¶å°†å®ƒæ›¿æ¢ä¸ºä¸€ä¸ªäºŒè¿›åˆ¶çš„å€¼,å¦‚&#8221;\n&#8221;,å¦å¤–ï¼ŒåŒå¼•å·å½¢å¼çš„å­—ç¬¦ä¸²è¿˜éœ€è¦åšçš„å°†#{expression}åºåˆ—æ›¿æ¢æˆexpressionçš„å€¼,æˆ‘ä»¬èƒ½ç”¨å®ƒæ¥æ›¿æ¢ä¹‹å‰æˆ‘ä»¬å†™çš„ç¨‹åº</p>

<pre><code>def say_goodnight(name)
    result = "Good night, #{name}" 
    return result
end
puts say_goodnight('Pa') 
produces:   Good night, Pa
</code></pre>

<p>ä»»æ„çš„å¤æ‚çš„è¡¨è¾¾å¼éƒ½èƒ½æ”¾åœ¨#{&hellip;}é‡Œï¼Œå¦‚ä¸‹</p>

<pre><code>def say_goodnight(name)
    result = "Good night, #{name.capitalize}" 
    return result
end
puts say_goodnight('uncle') 
produces:
Good night, Uncle
</code></pre>

<p>æˆ‘ä»¬è¿˜èƒ½å¯¹ä»¥ä¸Šæ–¹æ³•è¿›è¡Œç®€åŒ–ï¼Œrubyæ–¹æ³•è¿”å›çš„å€¼æ˜¯æœ€ä¸€ä¸ªè¡¨è¾¾å¼å¯¹åº”çš„å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¸å¿…å†™ä¸´æ—¶å˜é‡å’Œreturnè¯­å¥</p>

<pre><code>    def say_goodnight(name)
    "Good night, #{name.capitalize}"
end
puts say_goodnight('ma') 
produces:
Good night, Ma
</code></pre>

<h4>Rubyçš„åå­—</h4>

<p>rubyçš„å‘½åéµå¾ªä»¥ä¸‹æƒ¯ä¾‹,ç¬¬ä¸€ä¸ªåå­—çš„é¦–å­—ç¬¦è¡¨ç¤ºè¿™ä¸ªåå­—çš„ä½¿ç”¨åœºåˆ</p>

<ul>
<li>å±€éƒ¨å˜é‡ï¼Œæ–¹æ³•å‚æ•°ï¼Œæ–¹æ³•åéƒ½ ä»¥ä¸€ä¸ªå°å†™å­—æ¯æˆ–ä¸‹åˆ’çº¿å¼€å¤´</li>
<li>å…¨å±€å˜é‡ä»¥ä¸€ä¸ª$ç¬¦å¼€å¤´ï¼Œå¯¹è±¡å®ä¾‹å˜é‡ä»¥@å¼€å¤´</li>
<li>ç±»å˜é‡ä»¥ä¸¤ä¸ª@@å¼€å¤´</li>
<li><p>ç±»åï¼Œæ¨¡å—åï¼Œå¸¸é‡å¿…é¡»ä»¥å¤§å†™å­—æ¯å¼€å¤´
ä½¿ç”¨çš„demoå¦‚ä¸‹</p>

<pre><code>  Local Variable:     name fish_and_chips x_axis thx1138 _x _26
  Instance Variable:  @name @point_1 @X @_ @plan9
  Class Variable:     @@total @@symtab @@N @@x_pos @@SINGLE
  Global Variable:   $debug $CUSTOMER $_ $plan9 $Global
  Class Name:         String ActiveRecord MyClass     Constant Name:      FEET_PER_MILE DEBUG
</code></pre>

<h4>æ•°ç»„å’Œå“ˆå¸Œå­—å…¸</h4>

<p>æ•°ç»„</p>

<pre><code>  a = [ 1, 'cat', 3.14 ] # array with three elements 
  puts "The first element is #{a[0]}"
  # set the third element
  a[2] = nil
  puts "The array is now #{a.inspect}"
  produces:
  The first element is 1
  The array is now [1, "cat", nil]
</code></pre>

<p>ç®€ä¾¿åœ°åˆ›å»ºæ•°ç»„çš„æ–¹æ³•</p>

<pre><code>  a = %w{ ant bee cat dog elk } 
  a[0] # =&gt; "ant"
  a[3] # =&gt; "dog"
</code></pre>

<p>å“ˆå¸Œå­—å…¸</p>

<pre><code>  inst_section = {
  'cello' =&gt; 'string', 
  'clarinet' =&gt; 'woodwind', 
  'drum' =&gt; 'percussion', 
  'oboe' =&gt; 'woodwind', 
  'trumpet' =&gt; 'brass', 
  'violin' =&gt; 'string'    }
</code></pre>

<p><code>=&gt;</code>ç¬¦å·çš„å·¦ä¸ºkeyï¼Œå³ä¸ºvalue
åœ¨æ§åˆ¶å°ä¸Šæˆ‘ä»¬ç”¨pè€Œä¸æ˜¯putsï¼Œå› ä¸ºpå¯ä»¥æ›´æ˜¾å¼åœ°æ‰“å°nilå€¼</p>

<pre><code>  p inst_section['oboe']
  p inst_section['cello']
  p inst_section['bassoon']
</code></pre></li>
</ul>


<p>produces:</p>

<pre><code>    "woodwind"
    "string"
    nil
</code></pre>

<p>é»˜è®¤æƒ…å†µä¸‹hashçš„keyå¦‚æœå¯¹åº”çš„valueä¸å­˜åœ¨ï¼Œåˆ™valueçš„å€¼ä¸ºnilï¼Œæˆ‘ä»¬å¯ä»¥æ”¹å˜è¿™ä¸ªé»˜è®¤å‚</p>

<pre><code>histogram = Hash.new(0)
histogram['ruby'] # =&gt; 0
histogram['ruby'] = histogram['ruby'] + 1 
histogram['ruby'] # =&gt; 1
</code></pre>

<h4>ç¬¦å·(Symbols)</h4>

<p>é€šå¸¸åœ¨ç¼–ç¨‹çš„æ—¶å€™ï¼Œä½ éœ€è¦ä¸ºæŸäº›é‡è¦çš„ä¸œè¥¿æŒ‡å®šä¸€ä¸ªåå­—ï¼Œæ¯”å¦‚ï¼Œä½ ä¹Ÿè®¸æƒ³è¦ç”¨åå­—æ¥æŒ‡ç¤ºæŒ‡å—é’ˆçš„æ–¹å‘ï¼Œæ‰€ä»¥ï¼Œä½ å¯ä»¥åƒä»¥ä¸‹è¿™ä¹ˆå†™</p>

<pre><code>NORTH = 1 
EAST =2 
SOUTH = 3 
WEST =4
</code></pre>

<p>å®šä¹‰å¥½ä¹‹åï¼Œä½ å°±å¯ä»¥ç”¨è¿™äº›åå­—è€Œä¸æ˜¯æ•°å­—äº†</p>

<pre><code>walk(NORTH)
look(EAST)
</code></pre>

<p>ç„¶è€Œï¼Œå¾ˆå¤šæ—¶å€™ï¼Œè¿™äº›åå­—å¯¹åº”çš„æ•°å€¼æ˜¯ä¸ç›¸å…³çš„(åªè¦å®ƒä»¬æ˜¯å”¯ä¸€çš„)ä½ æ‰€è¦åšçš„åªæ˜¯åŒºåˆ†è¿™å››ä¸ªæ–¹å‘è€Œå·²
Rubyæä¾›äº†ä¸€ä¸ªå¾ˆç®€å•çš„æ›¿ä»£æ–¹æ¡ˆ:ç¬¦å·(Symbols).Symbolsåªæ˜¯å¸¸é‡åå­—ï¼Œä¸è¿‡ä½ æ— éœ€å®šä¹‰å®ƒï¼Œå¹¶ä¸”å®ƒä»¬ä¹Ÿä¿è¯æ˜¯å”¯ä¸€çš„ï¼Œä¸€ä¸ªç¬¦å·å¸¸é‡ä»¥:å¼€å¤´ï¼Œç´§è·Ÿç€å­—ç¬¦ä¸²
walk(:north)
look(:east)
æ— é¡»ä¸ºä¸€ä¸ªsymbolèµ‹ä»»ä½•å€¼,Rubyå·²ç»ä¸ºä½ è€ƒè™‘å¥½äº†.Rubyä¿è¯ä¸ç®¡ç¬¦å·å‡ºç°åœ¨ä½ ï¼Œä¸€ä¸ªç‰¹å®šå’Œç¬¦å·æ€»é‡æœ‰ç›¸åŒçš„å€¼ï¼Œå› æ­¤ï¼Œä½ å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼ä½¿ç”¨symbol</p>

<pre><code>def walk(direction)
    if direction == :north
    # ...
    end
 end
</code></pre>

<p>symbolsé€šå¸¸è¢«ç”¨æ¥å½“ä½œhashçš„keyï¼Œæˆ‘ä»¬å¯ä»¥å°†æˆ‘ä»¬ä¹‹å‰å†™çš„hashå†™ä¸ºä»¥ä¸‹å½¢å¼</p>

<pre><code>    inst_section = {
    :cello =&gt; 'string', 
    :clarinet =&gt; 'woodwind', 
    :drum =&gt; 'percussion', 
    :oboe =&gt; 'woodwind', 
    :trumpet =&gt; 'brass', 
    :violin =&gt; 'string'
}
</code></pre>

<p>äº‹å®ä¸Šï¼Œsymbolsæ˜¯å¦‚æ­¤é¢‘ç¹åœ°è¢«å½“ä½œhashçš„é”®ï¼Œrubyæä¾›äº†ä¸€ä¸ªæ›´ç®€æ´çš„è¯­æ³•ï¼Œä½ å¯ä»¥ç”¨name:valueçš„å½¢å¼æ¥åˆ›å»ºhashï¼Œå¦‚æœkeyæ˜¯symbolsçš„è¯</p>

<pre><code>inst_section = {
    cello: 'string', 
    clarinet: 'woodwind', 
    drum: 'percussion', 
    oboe: 'woodwind', 
    trumpet: 'brass', 
    violin: 'string'
}
puts "An oboe is a #{inst_section[:oboe]} instrument"
produces:
An oboe is a woodwind instrument
</code></pre>

<h4>æ¡ä»¶è¯­å¥</h4>

<p>ifè¯­å¥</p>

<pre><code>today = Time.now
if today.saturday?
    puts "Do chores around the house"
elsif today.sunday?
     puts "Relax"
else
     puts "Go to work" 
end
</code></pre>

<p>produces:</p>

<pre><code>Go to work
</code></pre>

<p>è¾ƒçŸ­çš„ifè¯­å¥ä¹Ÿå¯ä»¥è¿™ä¹ˆå†™</p>

<pre><code>puts "Danger, Will Robinson" if radiation &gt; 3000
</code></pre>

<p>whileè¯­å¥</p>

<pre><code>while weight &lt; 100 and num_pallets &lt;= 5
         pallet  = next_pallet()
         weight += pallet.weight
         num_pallets += 1
end
</code></pre>

<p>è¾ƒçŸ­çš„whileè¯­å¥ä¹Ÿå¯ä»¥è¿™ä¹ˆå†™</p>

<pre><code>    square = 4
    square = square*square while square &lt; 1000
</code></pre>

<p>rubyä¸­çš„è®¸å¤šè¯­å¥è¿”å›ä¸€ä¸ªå€¼ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥ç”¨å®ƒä»¬ä½œä¸ºæ¡ä»¶åˆ¤æ–­ï¼Œæ¯”å¦‚,å†…æ ¸æ–¹æ³•getsä»æ ‡å‡†è¾“å…¥æµä¸­è¿”å›ä¸‹ä¸€è¡Œæˆ–è€…å½“åˆ°è¾¾æ–‡ä»¶çš„æœ«å°¾æ—¶ä¼šè¿”å›nilï¼Œç”±äºRubyæœ‰æ¡ä»¶è¯­å¥ä¸­å°†nilè§†ä¸ºå‡çš„ï¼Œä½ å¯ä»¥ç”¨ä»¥ä¸‹ä»£ç æ¥å¤„ç†æ–‡ä»¶å¯¹åº”çš„è¡Œ</p>

<pre><code>while line = gets 
    puts line.downcase
end
</code></pre>

<h4>æ­£åˆ™è¡¨è¾¾å¼</h4>

<pre><code>/\d\d:\d\d:\d\d/    # a time such as 12:34:56
/Perl.*Python/      # Perl, zero or more other chars, then Python
/Perl Python/       # Perl, a space, and Python
/Perl *Python/     # Perl, zero or more spaces, and Python
/Perl +Python/     # Perl, one or more spaces, and Python
/Perl\s+Python/   # Perl, whitespace characters, then Python
/Ruby (Perl|Python)/ # Ruby, a space, and either Perl or Python
</code></pre>

<p>ç»“æœifè¯­å¥ä½¿ç”¨</p>

<pre><code>line = gets
if line =~ /Perl|Python/
    puts "Scripting language mentioned: #{line}" 
end
</code></pre>

<p>æ­£åˆ™è¡¨è¾¾å¼çš„æ›¿ä»£æ–¹æ³•</p>

<pre><code>line = gets
newline = line.sub(/Perl/, 'Ruby') # replace first 'Perl' with 'Ruby'   newerline =     newline.gsub(/Python/, 'Ruby') # replace every 'Python' with 'Ruby'
</code></pre>

<h4>Blockså’Œè¿­ä»£å™¨</h4>

<p>æˆ‘ä»¬é¦–å…ˆçœ‹çœ‹ä»£ç å—(code blocks),code blocksæ˜¯ä¸€ä¸²ä»£ç ï¼Œä½ èƒ½å°†å®ƒä¸æ–¹æ³•è°ƒç”¨ç»“åˆèµ·æ¥,å°±å½“å®ƒä»¬æ˜¯å‚æ•°ä¸€æ ·,è¿™æ˜¯éš¾ä»¥ç½®ä¿¡çš„å¼ºå¤§ç‰¹æ€§
ä½ ç”¨ä»£ç å—æ¥å®ç°å›è°ƒ(ä½†æ¯”javaä¸­çš„åŒ¿åå†…éƒ¨ç±»ç®€å•),æŠŠå®ƒä»¬åƒCä¸­çš„å‡½æ•°æŒ‡é’ˆé‚£æ ·æ¥ä¼ é€’(æ¯”Cå‡½æ•°æŒ‡é’ˆæ›´ç®€å•)ï¼Œæˆ–è€…å®ç°è¿­ä»£å™¨çš„åŠŸèƒ½
ä»£ç å—çš„å½¢å¼å¦‚ä¸‹</p>

<pre><code>{ puts "Hello" }
</code></pre>

<p>æˆ–</p>

<pre><code>do
  club.enroll(person)
  person.socialize
end
</code></pre>

<p>&ldquo;{}&#8221;blockä¸»è¦ç”¨åœ¨å•è¡Œä¸­,&#8221;do&hellip;.end&#8221;ä¸»è¦ç”¨åœ¨å¤šè¡Œä¸­
ä½ å¯ä»¥å°†blockæ”¾åœ¨ä¸€ä¸ªè°ƒç”¨æ–¹æ³•çš„å°¾éƒ¨</p>

<pre><code>greet { puts "Hi" } //greetæ˜¯æ–¹æ³•
</code></pre>

<p>å¦‚æœæ–¹æ³•æœ‰å‚æ•°ï¼Œåˆ™å°†blockæ”¾åœ¨è¿™äº›å‚æ•°çš„æœ€å</p>

<pre><code>verbose_greet("Dave", "loyal customer") { puts "Hi" }
</code></pre>

<p>æ–¹æ³•å¯ä»¥ç”¨Rubyæä¾›çš„yieldæ¥è°ƒç”¨blockå¤šæ¬¡</p>

<pre><code>def call_block

    puts "Start of method" 
    yield
    yield
    puts "End of method"
end

    call_block { puts "In the block" }
</code></pre>

<p>æ‰“å°ç»“æœ</p>

<pre><code>    Start of method
    In the block
    In the block
    End of method
</code></pre>

<p>è°ƒç”¨yieldçš„æ—¶å€™å¯ä»¥å¸¦å‚æ•°,è¿™äº›å‚æ•°å°†è¢«ä¼ åˆ°blockä¸­å»ï¼Œåœ¨blockä¸­ï¼Œä½ å°†è¿™äº›è¢«æ¥æ”¶çš„å‚æ•°ç”¨|params&hellip;|çš„å½¢å¼åˆ—å‡ºæ¥,å¦‚ä¸‹</p>

<pre><code>def who_says_what yield("Dave", "hello") 
    yield("Andy", "goodbye")

end
who_says_what {|person, phrase| puts "#{person} says #{phrase}"}
</code></pre>

<p>æ‰“å°ç»“æœ</p>

<pre><code>Dave says hello Andy says goodbye
</code></pre>

<p>Code blockså¹¿æ³›ç”¨åœ¨rubyçš„åº“ä¸­ç”¨æ¥å®ç°è¿­ä»£å™¨</p>

<pre><code>    animals = %w( ant bee cat dog ) # create an array
animals.each {|animal| puts animal }    # iterate over the contents
</code></pre>

<p>produces:</p>

<pre><code>ant
bee
cat
dog
</code></pre>

<p>å†æ¥çœ‹å‡ ä¸ªä¾‹å­</p>

<pre><code>    [ 'cat', 'dog', 'horse' ].each {|name| print name, " " } 
5.times { print "*" }
3.upto(6) {|i| print i }
('a'..'e').each {|char| print char }
puts
</code></pre>

<p>produces:</p>

<pre><code>cat dog horse *****3456abcde####è¯»å†™

printf("Number: %5.2f,\nString: %s\n", 1.23, "hello")
</code></pre>

<p>produces:    Number:  1.23,    String: helloæœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥å°†è¾“å…¥è¯»å…¥ç¨‹åºä¸­ï¼Œæœ€å¸¸è§çš„getsæ–¹æ³•ï¼Œå®ƒè¿”å›æ ‡å‡†è¾“å…¥æµçš„ä¸‹ä¸€è¡Œ</p>

<pre><code>line = gets print line
</code></pre>

<h4>å‘½ä»¤è¡Œå‚æ•°</h4>

<p>å½“ä½ ä»å‘½ä»¤è¡Œè¿è¡Œä¸€ä¸ªRubyç¨‹åºæ—¶ï¼Œä½ èƒ½ä¼ é€ä¸€äº›å‚æ•°ç»™å®ƒï¼Œä½ èƒ½ç”¨ä¸¤ç§ä¸åŒçš„å‚æ•°æ¥è®¿é—®è¿™äº›å‚æ•°
é¦–å…ˆï¼ŒARGVå°±æ˜¯è¿™äº›å‚æ•°ç»„æˆçš„æ•°ç»„ï¼Œå‡è®¾æœ‰ä¸€ä¸ªå«cmd_line.rbçš„ç¨‹åºå¦‚ä¸‹</p>

<pre><code>puts "You gave #{ARGV.size} arguments" 
p ARGV
</code></pre>

<p>å½“æˆ‘ä»¬å‘æ­¤ç¨‹åºä¼ å…¥è¿™äº›å‚æ•°æ—¶ï¼Œæˆ‘ä»¬å‚çœ‹åˆ°è¾“å‡ºç»“æœ</p>

<pre><code>$ ruby cmd_line.rb ant bee cat dog 
You gave 4 arguments
["ant", "bee", "cat", "dog"]
</code></pre>

<p>é€šå¸¸ï¼Œä¼ å…¥çš„å‚æ•°æ˜¯ä½ è¦å¤„ç†çš„æ–‡ä»¶çš„åå­—ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œä½ åº”è¯¥ç”¨ç¬¬äºŒç§æŠ€å·§,<code>ARGF</code>,å®ƒæ˜¯ä¸€ç§ç‰¹åˆ«çš„I/Oå¯¹è±¡ï¼Œä»£è¡¨äº†é€šè¿‡å‘½ä»¤è¡Œä¼ å…¥çš„æ–‡ä»¶åçš„æ‰€æœ‰å†…å®¹, æˆ‘ä»¬ä¹‹åå†å­¦ä¹ å®ƒ</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[åˆè¯†Ruby]]></title>
    <link href="http://xiekunRonaldo.github.io/blog/2014/07/21/chu-shi-ruby/"/>
    <updated>2014-07-21T22:23:15+08:00</updated>
    <id>http://xiekunRonaldo.github.io/blog/2014/07/21/chu-shi-ruby</id>
    <content type="html"><![CDATA[<p>åœ¨ç»ˆç«¯ä¸­è¾“å…¥irbä¸rubyäº¤äº’</p>

<pre><code>    2.1.2 :002 &gt; def sum(n1, n2)
    2.1.2 :003?&gt;   n1+n2
    2.1.2 :004?&gt;   end
     =&gt; :sum
    2.1.2 :005 &gt; sum(3, 4)
     =&gt; 7
</code></pre>

<p>é€šå¸¸æˆ‘ä»¬å°†rubyç¨‹åºå†™åœ¨æ–‡ä»¶é‡Œï¼Œå‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªmyprog.rbçš„ç¨‹åºå¦‚ä¸‹</p>

<pre><code>    gettingstarted/myprog.rb        puts "Hello, Ruby Programmer"       puts "It is now #{Time.now}"
</code></pre>

<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥æ•²å…¥ä»¥ä¸‹å‘½ä»¤æ¥è¿è¡Œç¨‹åº</p>

<pre><code>    $ ruby myprog.rb        Hello, Ruby Programmer)     It is noew 2014-07-21 22:27:47 +0800
</code></pre>

<p>åœ¨Unixä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç¨‹åºçš„ç¬¬ä¸€è¡Œæ·»åŠ &#8221;shebang&#8221;çš„ç¬¦å·ï¼Œå¦‚ä¸‹</p>

<pre><code>    #! /usr/bin/ruby
    puts "Hello, Ruby Programmer" 
    puts "It is now #{Time.now}"
</code></pre>

<p>å¦‚æœä½ ç”¨<code>chmod+x myprog.rb</code>å‘½ä»¤è®©æ­¤æ–‡ä»¶æˆä¸ºå¯æ‰§è¡Œç¨‹åºï¼ŒUnixèƒ½è®©ä½ å°†æ­¤æ–‡ä»¶ä½œä¸ºä¸€ä¸ªç¨‹åºæ¥è¿è¡Œ</p>

<pre><code>    $ ./myprog.rb       Hello, Ruby Programmer      It is now 2013-05-27 12:30:36 -0500####Rubyæ–‡æ¡£:RDocå’Œri
</code></pre>

<p>Rubyåº“è¶Šæ¥è¶Šå¤§ï¼Œå·²ç»ä¸å¯èƒ½å°†æœ‰å…³å®ƒä»¬çš„æ–‡æ¡£å†™è¿›ä¸€æœ¬ä¹¦ä¸­äº†ï¼Œrubyçš„æ ‡å‡†åº“æœ‰9000å¤šä¸ªï¼å¹¸è¿çš„æ˜¯ï¼Œä¸€ç§ä¸ºè¿™äº›æ–¹æ³•(ç±»ï¼Œæ¨¡å—)æä¾›æ–‡æ¡£çš„æ–¹æ³•æ˜¯å­˜åœ¨çš„ï¼Œè®¸å¤šåœ¨å®ƒä»¬å†…éƒ¨å†™æ–‡æ¡£çš„æ–¹æ³•æ˜¯é‡‡ç”¨ä¸€ä¸ªRDocçš„å·¥å…·
å¦‚æœä¸€ä¸ªæºæ–‡ä»¶ç”¨RDocæ¥æ–‡æ¡£æ³¨é‡Šï¼Œé‚£ä¹ˆå®ƒçš„æ–‡æ¡£æ˜¯å¯ä»¥è¢«æå–å‡ºæ¥å¹¶è¢«è½¬åŒ–æˆHTMLå’Œriçš„å½¢å¼çš„
riæ˜¯ä¸€ä¸ªæµè§ˆæœ¬åœ°RDocçš„ï¼Œå‘½ä»¤è¡Œæµè§ˆå™¨ï¼Œè®¸å¤šrubyçš„å‘è¡Œç‰ˆç°åœ¨ç”¨riç¨‹åºæ¥å®‰è£…æ–‡æ¡£èµ„æº
è¦å‘ç°é’ˆå¯¹æŸä¸ªç±»çš„æ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å‘½ä»¤è¡Œæ•²å…¥<code>ri ClassName</code>çš„å½¢å¼æ¥æŸ¥çœ‹,å¦‚ä»¥ä¸‹</p>

<pre><code>$ ri GC
----------------------------------------------------------------------------------- 
The GC module provides an interface to Ruby's garbage collection mechanism. Some of the underlying  methods are also available via the ObjectSpace module.           You may obtain information about the operation of the GC through GC::Profiler.    -----------------------------------------------------------------------------------    Class methods:      count, disable, enable, malloc_allocated_size, malloc_allocations,      start, stat, stress, stress=    Instance methods:      garbage_collect
</code></pre>

<p>æŸ¥çœ‹æŸä¸ªæŒ‡å®šç±»çš„æ–¹æ³•</p>

<pre><code>ri GC::enable
--------------------------------------------------------------- GC::enable GC.enable =&gt; true or false   --------------------------------------------------------------------------- Enables garbage collection, returning true if garbage collection was    disabled.   GC.disable  GC.enable   GC.enable   #=&gt; false   #=&gt; true    #=&gt; false   
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Head First Cç¬¬å…«ç« -é™æ€åº“å’ŒåŠ¨æ€åº“]]></title>
    <link href="http://xiekunRonaldo.github.io/blog/2014/07/16/head-first-cdi-ba-zhang-jing-tai-ku-he-dong-tai-ku/"/>
    <updated>2014-07-16T21:54:55+08:00</updated>
    <id>http://xiekunRonaldo.github.io/blog/2014/07/16/head-first-cdi-ba-zhang-jing-tai-ku-he-dong-tai-ku</id>
    <content type="html"><![CDATA[<p>è¿™ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•åˆ›å»ºè‡ªå·±çš„åŠ¨æ€åº“ï¼Œå¹¶åœ¨å¤šä¸ªç¨‹åºä¸­ç”¨åˆ°åŒæ ·çš„ä»£ç 
æ¥çœ‹ä¸‹ä»¥ä¸‹ä»£ç 
åŠ å¯†ä»£ç </p>

<pre><code>//encyrpt.h
void encrypt(char *message)

//encrypt.c
#include "encrypt.h"    void encrypt(char *message) {       while (*message) {          *message = *message ^ 31; message++;        }    }
</code></pre>

<p>æ ¡éªŒä»£ç </p>

<pre><code>//checksum.h
int checksum(char *message);

//checksum.c
#include "checksum.h"   int checksum(char *message) {       int c = 0;      while (*message) {      c += c ^ (int)(*message);       message++; }        return c; 
}
</code></pre>

<p>åŠ å¯†å’Œæ ¡éªŒä¸¤æ®µä»£ç æ„æˆäº†æˆ‘ä»¬æ¥ä¸‹æ¥å°†è¦è¿›è¡Œçš„å¯†ç åº“çš„åŸºç¡€
å‡è®¾æˆ‘ä»¬å·²ç»å°†ä»¥ä¸Šçš„ä»£ç ç¼–è¯‘æˆäº†ç›®æ ‡ä»£ç </p>

<pre><code>gcc -c encrypt.c -o encrypt.o
gcc -c checksum.c -o checksum.o
</code></pre>

<p>ç°åœ¨æˆ‘ä»¬å†™ä¸€æ®µæµ‹è¯•ç¨‹åº</p>

<pre><code>#include &lt;stdio.h&gt; 
#include &lt;encrypt.h&gt; 
#include &lt;checksum.h&gt;   int main() {        char s[] = "Speak friend and enter"; encrypt(s);        printf("Encrypted to '%s'\n", s); printf("Checksum is %i\n", checksum(s)); encrypt(s);      printf("Decrypted back to '%s'\n", s); printf("Checksum is %i\n", checksum(s));     return 0;   }
</code></pre>

<p>å½“æˆ‘ä»¬ç¼–è¯‘æ—¶ï¼Œä¼šå‡ºç°ä»¥ä¸‹é”™è¯¯</p>

<pre><code>gcc test_code.c encrypt.o checksum.o -o test_code 
test_code.c:2:21: error: encrypt.h: No such file or directory 
test_code.c:3:22: error: checksum.h: No such file or directory
</code></pre>

<p>é”™è¯¯åœ¨ä»¥ä¸‹ä¸¤è¡Œ</p>

<pre><code>#include &lt;encrypt.h&gt; 
#include &lt;checksum.h&gt;
</code></pre>

<p>å°–æ‹¬å·å°†åœ¨æ ‡å‡†å¤´æ–‡ä»¶ç›®å½•ä¸­å¯»æ‰¾ï¼Œåœ¨Macæˆ–Linuxç³»ç»Ÿä¸­ï¼Œç¼–è¯‘å™¨åœ¨ä»¥ä¸‹ç›®å½•ä¸­å¯»æ‰¾è¿™äº›æ–‡ä»¶</p>

<pre><code>/user/local/include     //æ­¤ç›®å½•ä¸‹é€šå¸¸å­˜æ”¾ä¸€äº›ç¬¬ä¸‰æ–¹åº“
/user/include           //æ­¤ç›®å½•é€šå¸¸å­˜æ”¾ä¸€äº›æ“ä½œç³»ç»Ÿç›¸å…³çš„å¤´æ–‡ä»¶
</code></pre>

<h4>è¯¥å¦‚ä½•å…±äº«ä»£ç </h4>

<p>æœ‰æ—¶ä½ æƒ³å†™ä¸€äº›ä»£ç ç”¨åœ¨å¾ˆå¤šç¨‹åºä¸­ï¼Œæ— è®ºå®ƒä»¬æ˜¯åœ¨ä¸åŒçš„æ–‡ä»¶å¤¹ä¸‹ï¼Œè¿˜æ˜¯åœ¨æ•´ä¸ªç”µè„‘ä¸­ï¼Œä½ è¯¥å¦‚ä½•åšå‘¢?
ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬æƒ³åœ¨å¤šä¸ªç¨‹åºä¸­å…±äº«ä¸¤ç§æ–‡ä»¶,å¤´æ–‡ä»¶(.h)å’Œç›®æ ‡æ–‡ä»¶(.o),è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•æ“ä½œ</p>

<h5>å…±äº«.hå¤´æ–‡ä»¶,æœ‰ä»¥ä¸‹å‡ ç§æ–‡ä»¶</h5>

<ol>
<li><p>å°†å®ƒä»¬å­˜å‚¨åœ¨æ ‡å‡†ç›®å½•ä¸­
å¦‚æœä½ å°†ä½ çš„å¤´æ–‡ä»¶æ‹·è´åˆ°æ ‡å‡†ç›®æ ‡å¦‚/usr/local/includeä¸­ï¼Œä½ å¯ä»¥ç”¨å°–æ‹¬å·æ¥å¼•ç”¨å®ƒä»¬</p>

<pre><code>  #include&lt;encrypt.h&gt;
</code></pre></li>
<li><p>åœ¨includeä¸­å†™ä¸‹æ­¤æ–‡ä»¶æ‰€åœ¨çš„å®Œæ•´è·¯å¾„
å‡è®¾ä½ çš„æ–‡ä»¶å­˜å‚¨åœ¨/my_header_filesç›®å½•ä¸‹,ä½ å¯ä»¥æŒ‰ä»¥ä¸‹æ–¹å¼æ¥å¼•ç”¨ä»£ç </p>

<pre><code>  #include "/my_header_files/encrypt.h"
</code></pre></li>
<li><p>ä½ å¯ä»¥å‘Šè¯‰ç¼–è¯‘å™¨å»å“ªæ¥æœå¯»å®ƒä»¬
ç”¨gccç¼–è¯‘æ—¶åŠ ä¸Š-Ié€‰é¡¹</p>

<pre><code>  gcc -I /my_header_files test_code.c ... -o test_code
</code></pre>

-Ié€‰é¡¹å‘Šè¯‰gccç¼–è¯‘å™¨åœ¨/my_header_filesè¿™ä¸ªç›®å½•ä¸‹ä½ èƒ½æ‰¾åˆ°æ‰€éœ€è¦çš„å¤´æ–‡ä»¶ï¼Œ<code>æ³¨æ„</code>ï¼Œgccä»å°†åœ¨æ ‡å‡†ç›®å½•ä¸­å¯»æ‰¾å¤´æ–‡ä»¶ï¼Œä½†æ˜¯<code>é¦–å…ˆ</code>å®ƒå°†åœ¨-Ié€‰é¡¹å¯¹åº”çš„ç›®å½•ä¸­å¯»æ‰¾æ­¤æ–‡ä»¶

<h5>é€šè¿‡å†™å®Œæ•´è·¯å¾„çš„æ–¹å¼æ¥å…±äº«.oç›®æ ‡æ–‡ä»¶</h5>

<pre><code>  gcc -I/my_header_files test_code.c /my_object_files/encrypt.o /my_object_files/checksum.o -o test_code
</code></pre>

/my_object_filesç›®å½•å°±åƒæ˜¯å­˜å‚¨ç›®æ ‡æ–‡ä»¶çš„ä¸­æ¢,ç”¨ç›®æ ‡æ–‡ä»¶çš„å®Œæ•´è·¯å¾„æ„å‘³ç€ä½ ä¸éœ€è¦ä¸ºæ¯ä¸€ä¸ªç¨‹åºæ‹·è´ä¸€ä»½å•ç‹¬çš„ç›®æ ‡æ–‡ä»¶
å¦‚æœåªæœ‰ä¸€ä¸¤ä¸ªéœ€è¦å…±äº«çš„ç›®æ ‡æ–‡ä»¶è¿˜å¥½ï¼Œå¦‚æœæœ‰è®¸å¤šç›®æ ‡æ–‡ä»¶å‘¢ï¼Œä¸æ˜¯è¦åœ¨æ‰€æœ‰çš„ç›®æ ‡æ–‡ä»¶å‰éƒ½åŠ ä¸Šå®ƒä»¬çš„å®Œæ•´è·¯å¾„äº†?
<code>è§£å†³æ–¹æ³•</code>:ä½ å¯ä»¥å°†è®¸å¤šç›®æ ‡æ–‡ä»¶æ‰“åŒ…æˆä¸€ä¸ª.aæ–‡ä»¶,è¿™æ ·ä½ ä¸€æ¬¡å°±èƒ½å‘Šè¯‰ç¼–è¯‘å™¨æ‰€æœ‰ç›®æ ‡æ–‡ä»¶çš„æ‰€åœ¨äº†(éƒ½åœ¨.aæ–‡ä»¶é‡Œ)

<h6>è®©æˆ‘ä»¬çœ‹ä¸‹å¦‚ä½•æ‰“åŒ…</h6>

<p>æˆ‘ä»¬ç”¨è¿‡.zipå’Œ.taræ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶åŒ…å«äº†å¤šä¸ªæ–‡ä»¶,.aæ–‡ä»¶ä¸æ­¤ç±»ä¼¼ï¼Œä¸€ä¸ªæ–‡ä»¶åŒ…å«äº†å¤šä¸ª.oæ–‡ä»¶
æ‰“å¼€å‘½ä»¤è¡Œï¼Œåˆ‡æ¢åˆ°åº“ç›®å½•ä¸‹ï¼Œæ¯”å¦‚/usr/libé‡Œã€‚åœ¨æ­¤ç›®å½•ä¸Šï¼Œä½ å°†çœ‹åˆ°è®¸å¤š.aæ–‡ä»¶,æœ‰ä¸€ä¸ªnmçš„å‘½ä»¤å¯ä»¥ç”¨æ¥æŸ¥çœ‹.aæ–‡ä»¶é‡Œæœ‰å“ªäº›.oæ–‡ä»¶
<img src="http://xiekunRonaldo.github.io/images/2014/7/libl.png">
<img src="http://xiekunRonaldo.github.io/images/2014/7/nm.png">
åœ¨æˆ‘ä»¬ç”¨.aæ–‡ä»¶ç¼–è¯‘ç¨‹åºä¹‹å‰,å…ˆçœ‹çœ‹å¦‚ä½•å°†encrypt.oå’Œchecksum.oæ–‡ä»¶å­˜å‚¨åˆ°ä¸€ä¸ª.aæ–‡ä»¶é‡Œå§
ç”¨arå‘½ä»¤æ¥åˆ›å»ºä¸€ä¸ª.aæ–‡ä»¶</p>

<pre><code>  ar -rcs libhfsecurity.a encrypt.o checksum.o
</code></pre>

<p>rcsä¸‰ä¸ªé€‰é¡¹çš„è§£é‡Šå¦‚ä¸‹
-rè¡¨ç¤ºå¦‚æœ(.a)æ–‡ä»¶å·²ç»å­˜åœ¨,æ–‡ä»¶å°†è¢«æ›´æ–°
-cè¡¨ç¤º.aåˆ›å»ºæˆåŠŸä¸å¦éƒ½æ— ä»»ä½•åé¦ˆä¿¡æ¯
-så‘Šè¯‰aråœ¨æ–‡ä»¶çš„å¼€å¤´åˆ›å»ºä¸€ä¸ªç´¢å¼•
æ³¨æ„åˆ°äº†å—ï¼Œæ‰€æœ‰çš„.aæ–‡ä»¶éƒ½æœ‰lib<something>.aå½¢å¼çš„å‘½å,åå­—ä»¥libå¼€å¤´ï¼Œå› ä¸ºå®ƒä»¬æ˜¯é™æ€åº“ï¼Œæˆ‘ä»¬å°†å¾ˆå¿«å­¦ä¹ åˆ°ä»€ä¹ˆæ˜¯é™æ€åº“</p></li>
</ol>


<p>åˆ›å»ºå¥½äº†æ ‡å‡†åº“æ–‡ä»¶åï¼Œè¯¥å¦‚ä½•ä½¿ç”¨å‘¢</p>

<ul>
<li><p>å°†å®ƒæ”¾åˆ°ä¸€ä¸ªæ ‡å‡†ç›®å½•å¦‚/user/local/libé‡Œ
ä¸€äº›ç å†œåœ¨ç¡®è®¤.aæ–‡ä»¶èƒ½å·¥ä½œåå–œæ¬¢å°†.aæ–‡ä»¶æ”¾åœ¨ä¸€æ ‡å‡†åº“é‡Œï¼Œåœ¨Linuxå’ŒMacé‡Œ/usr/local/libç›®å½•æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œå› ä¸ºè¿™ä¸ªç›®å½•å°±æ˜¯ä¸“é—¨ç”¨æ¥æ”¾ç½®ä½ è‡ªå·±çš„åº“æ–‡ä»¶çš„</p></li>
<li><p>å°†.aæ–‡ä»¶æ”¾åˆ°ä½ è‡ªå·±å–œæ¬¢æ”¾ç½®çš„åº“æ–‡ä»¶ç›®å½•ä¸‹,å¦‚/my_libä¸­
æ—¢ç„¶åº“åˆ›å»ºå¥½äº†ï¼Œé‚£æˆ‘ä»¬æ¥çœ‹çœ‹æ€ä¹ˆåˆ©ç”¨è¿™äº›åº“æ¥ç¼–è¯‘ç”¨åˆ°è¿™äº›åº“çš„ç¨‹åº</p></li>
<li>å¦‚æœä½ å°†.aæ–‡ä»¶æ”¾åˆ°æ ‡å‡†åº“ç›®å½•ä¸­,ä½ å¯ä»¥æŒ‰ä»¥ä¸‹æ–¹å¼æ¥ç¼–è¯‘ä»£ç 
<img src="http://xiekunRonaldo.github.io/images/2014/7/nm.png"></li>
<li><p>å¦‚æœä½ æ˜¯å°†.aæ–‡ä»¶æ”¾åœ¨ä½ è‡ªå·±çš„åº“æ–‡ä»¶ç›®å½•ä¸‹ï¼Œå¯æŒ‰ä»¥ä¸‹æ–¹å¼æ¥ç¼–è¯‘ä»£ç </p>

<pre><code> gcc test_code.c -L/my_lib -lhfsecurity -o test_code
</code></pre>

<p>-Lé€‰é¡¹å‘Šè¯‰ç¼–è¯‘å™¨å»å“ªä¸ªç›®å½•å¯»æ‰¾åº“æ–‡ä»¶</p></li>
</ul>


<p>ç°åœ¨æœ‰ä¸€ä¸ªæå®‰å…¨çš„å“¥ä»¬åœ¨ç”¨æœ€æ–°çš„åŠ å¯†åº“ç¼–è¯‘ä¸€ä¸ªé“¶è¡Œç›¸å…³çš„ç¨‹åºæ—¶é‡åˆ°äº†ä¸€ç‚¹éº»çƒ¦ï¼Œä»–æŠŠæºç å’Œ ecnryptï¼Œchecksum çš„æºç æ”¾åœ¨äº†åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œä»–æƒ³è¦åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªlibhfsecurity.aåº“å¹¶ç”¨å®ƒå»ç¼–è¯‘ç¨‹åºï¼Œä½ èƒ½å¸®åŠ©å®ƒä¿®æ”¹å®ƒçš„makefileæ–‡ä»¶å—
è¿™ä¸ªç¨‹åºå«band_vaultï¼Œå®ƒç”¨äº†ä»¥ä¸‹çš„includeè¯­å¥</p>

<pre><code>#include&lt;encrypt.h&gt;
#include&lt;checksum.h&gt;
</code></pre>

<p>ç”±äºç”¨åˆ°äº†å°–æ‹¬å·ï¼Œç¼–è¯‘å™¨éœ€è¦ä½¿ç”¨ç”¨-Ié€‰é¡¹å‘ŠçŸ¥å¤´æ–‡ä»¶åœ¨å“ª
makefileæ–‡ä»¶å¦‚ä¸‹
<img src="http://xiekunRonaldo.github.io/images/2014/7/bank_vault_makefile.png"><br/>
-Lé€‰é¡¹å¿…é¡»å‡ºç°åœ¨æºæ–‡ä»¶åé¢æ‰è¡Œ
ä».aæ–‡ä»¶ä¸­æå–ä¸­æŸä¸ªç›®æ ‡æ–‡ä»¶</p>

<pre><code>ar -x libhfsecurity.a encrypt.o
</code></pre>

<p>å†æ¥çœ‹ä¸€ä¸ªä¾‹å­</p>

<pre><code>//hfcal.c
#include &lt;stdio.h&gt; 
#include &lt;hfcal.h&gt;

void display_calories(float weight, float distance, float coeff) {      printf("Weight: %3.2f lbs\n", weight);      printf("Distance: %3.2f miles\n", distance);        printf("Calories burned: %4.2f cal\n", coeff * weight * distance);  }

//elliptical.c
#include &lt;stdio.h&gt;
#include &lt;hfcal.h&gt;  int main() {        display_calories(115.2, 11.3, 0.79);        return 0;   }
</code></pre>

<p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ç¼–è¯‘ä»£ç </p>

<ol>
<li><p>é¦–å…ˆï¼Œåˆ›å»ºhfcal.oæ–‡ä»¶,hfcal.hå¤´æ–‡ä»¶å­˜å‚¨åœ¨./includes</p>

<pre><code> gcc -I./includes -c hfcal.c -o hfcal.o
</code></pre>

<p>-cé€‰é¡¹è¡¨ç¤ºåªæ˜¯åˆ›å»ºç›®æ ‡æ–‡ä»¶ï¼Œä¸é“¾æ¥</p></li>
<li><p>åˆ›å»ºelliptical.oæ–‡ä»¶</p>

<pre><code> gcc -I./includes -c elliptical.c -o elliptical.o
</code></pre>

<p>åŒæ ·çš„ï¼Œä½ éœ€è¦å‘Šè¯‰ç¼–è¯‘å™¨å¤´æ–‡ä»¶åœ¨./includesä¸‹çš„</p></li>
<li><p>ä½ éœ€è¦ä»hfcal.oä¸­åˆ›å»ºä¸€ä¸ª.aæ–‡ä»¶ï¼Œå¹¶å°†å®ƒå­˜å‚¨åœ¨./libsä¸­</p>

<pre><code> ar -rcs ./libs/libhfcal.a hfcal.o
</code></pre></li>
</ol>


<p>è¢«æ‰“åŒ…çš„libhfcal.aæ–‡ä»¶å°†è¢«æ”¾åœ¨./libsç›®å½•ä¸‹</p>

<ol>
<li><p>æœ€åï¼Œç”¨elliptical.oå’Œlibhfcal.aåˆ›å»ºellipticalå¯æ‰§è¡Œæ–‡ä»¶</p>

<pre><code> gcc elliptical.o -L./libs -lhfcal -o elliptical
</code></pre></li>
</ol>


<p>ç°åœ¨ä½ èƒ½æ‰§è¡Œellipticalå¯æ‰§è¡Œæ–‡ä»¶äº†</p>

<pre><code>&gt; ./elliptical  Weight: 115.20 lbs  Distance: 11.30 miles   Calories burned: 1028.39 cal    &gt;
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Head First Cç¬¬ä¸ƒç« ç¬”è®°-é«˜çº§å‡½æ•°]]></title>
    <link href="http://xiekunRonaldo.github.io/blog/2014/07/15/head-first-cdi-qi-zhang-bi-ji-gao-ji-han-shu/"/>
    <updated>2014-07-15T22:11:00+08:00</updated>
    <id>http://xiekunRonaldo.github.io/blog/2014/07/15/head-first-cdi-qi-zhang-bi-ji-gao-ji-han-shu</id>
    <content type="html"><![CDATA[<p>å¯¼è¯»:è¿™ä¸€ç« æˆ‘ä»¬å°†å­¦ä¹ å‡½æ•°çš„ä¸€äº›é«˜çº§ç‰¹æ€§,å¦‚</p>

<ol>
<li>å°†å‡½æ•°ä½œä¸ºä¸€ä¸ªå‚æ•°è¿›è¡Œä¼ é€’</li>
<li>ç”¨æ¯”è¾ƒå‡½æ•°è¿›è¡Œæ’åº</li>
<li>ç”¨å¯å˜å‚æ•°çš„å‡½æ•°è®©ä½ çš„ä»£ç å˜å¾—æ›´åŠ çµæ´»</li>
</ol>


<h5>å‡½æ•°æŒ‡é’ˆ</h5>

<pre><code>int (*warp_fn)(int);
</code></pre>

<p>å°†å‡½æ•°æŒ‡é’ˆå½“ä½œå‚æ•°ä¼ é€’ç»™å‡½æ•°</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>void find(int (*mactch)(char *)){
</span><span class='line'>  if (match(ADS[i])){
</span><span class='line'>      //char *ADS[] = {"one", "two"};
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h5>ç”¨å‡½æ•°æŒ‡é’ˆæ¥æ’åº</h5>

<p>Cæ ‡å‡†åº“é‡Œæœ‰ä¸€ä¸ªæ’åºæŒ‡é’ˆå¦‚ä¸‹</p>

<p><img src="http://xiekunRonaldo.github.io/images/2014/7/qsort.png"></p>

<p>å‡è®¾ä½ æœ‰ä»¥ä¸‹æ•´å½¢æ•°ç»„ï¼Œä½ æƒ³æŒ‰å‡åºæ’åºï¼Œè¯¥å¦‚ä½•å†™æ’åºå‡½æ•°</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>int scores[] = {543,323,32,554,11,3,112};
</span><span class='line'>int compare_scores(const void* score_a, const void* score_b)
</span><span class='line'>{
</span><span class='line'>  int a = *(int*)score_a; 
</span><span class='line'>  int b = *(int*)score_b;
</span><span class='line'>  return a-b;
</span><span class='line'>}
</span><span class='line'>qsort(scores, 7, sizeof(int), compare_scores);</span></code></pre></td></tr></table></div></figure>


<p>å¦‚æœæ˜¯ä¸€ä¸ªchar *p[]æ•°ç»„å‘¢ï¼Œè¯¥å¦‚ä½•å†™compareå‡½æ•°</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>int compare_names(const void* a, const void* b){
</span><span class='line'>  char** sa = (char**)a;
</span><span class='line'>  char** sb = (char**)b; 
</span><span class='line'>  return strcmp(*sa, *sb);ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h5>å‡½æ•°æŒ‡é’ˆæ•°ç»„</h5>

<pre><code>//dump,second_change, marriageéƒ½æ˜¯å‡½æ•°
void (*replies[])(response) = {dump, second_chance, marriage};
</code></pre>

<p>åˆ¤æ–­è°ƒç”¨çš„æ˜¯å¦æ˜¯æŸä¸ªå‡½æ•°</p>

<pre><code>enum response_type {DUMP, SECOND_CHANCE, MARRIAGE};
replies[SECOND_CHANCE] == second_chanceå®Œæ•´çš„demo
typedef struct {    char *name; enum response_type type; } response;    enum response_type {DUMP, SECOND_CHANCE, MARRIAGE};
void (*replies[])(response) = {dump, second_chance, marriage};

int main()
{
    response r[] = {            {"Mike", DUMP}, {"Luis", SECOND_CHANCE},            {"Matt", SECOND_CHANCE}, {"William", MARRIAGE}      };
    int i;
    for (i = 0; i &lt; 4; i++){
        (replies[r[i].type])(r[i]);
    }
}
</code></pre>

<h5>å¯å˜å‚å‡½æ•°</h5>

<p>demo1</p>

<pre><code>#include &lt;stdarg.h&gt;
void print_ints(int args, ....){
    va_list ap; 
    va_start(ap, args);
    int i;
    for (i = 0; i &lt; args; i++) {            printf("argument: %i\n", va_arg(ap, int));      }
    va_end(ap);
}
</code></pre>

<p>æ³¨:va_end,va_startæ˜¯å®</p>

<p>demo2</p>

<pre><code>enum drink {    MUDSLIDE, FUZZY_NAVEL, MONKEY_GLAND, ZOMBIE };
printf("Price is %.2f\n", total(3, MONKEY_GLAND, MUDSLIDE, FUZZY_NAVEL));
double total(int args, ...)
{
    double total = 0;       va_list ap;
    va_start(ap, args);             int i;
    for(i = 0; i &lt; args; i++) {         enum drink d = va_arg(ap, enum drink);          total = total + price(d);       }       va_end(ap);     return total;
}
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Head First Cç¬¬å…­ç« -æ•°æ®ç»“æ„å’ŒåŠ¨æ€å†…å­˜]]></title>
    <link href="http://xiekunRonaldo.github.io/blog/2014/07/13/head-first-cdi-liu-zhang-shu-ju-jie-gou-he-dong-tai-nei-cun/"/>
    <updated>2014-07-13T11:19:10+08:00</updated>
    <id>http://xiekunRonaldo.github.io/blog/2014/07/13/head-first-cdi-liu-zhang-shu-ju-jie-gou-he-dong-tai-nei-cun</id>
    <content type="html"><![CDATA[<p>è¿™ä¸€ç« ä¸­æˆ‘ä»¬å°†å­¦ä¹ åˆ°å¦‚ä½•ç”¨ç»“æ„ä½“æŒ‡é’ˆæ¥å°†è‡ªå®šä¹‰çš„æ•°æ®ç±»å‹è¿æ¥æˆä¸€ä¸ªæ›´å¤§æ›´å¤æ‚çš„æ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬é€šè¿‡åˆ›å»ºé“¾è¡¨æ¥äº†è§£ç»“æ„ä½“æŒ‡é’ˆçš„ç”¨å¤„ï¼Œä¹Ÿå°†å­¦ä¹ åˆ°å¦‚ä½•åœ¨å †ä¸Šåˆ†é…å†…å­˜ï¼Œå¹¶åœ¨ä½ ç”¨å®Œä¹‹åé‡Šæ”¾å®ƒï¼Œæˆ‘ä»¬ä¹Ÿå°†å­¦ä¹ åˆ°valgrindçš„ä½¿ç”¨</p>

<h4>åœ¨å †ä¸Šåˆ†é…å†…å­˜ä»¥åŠé‡Šæ”¾å†…å­˜</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>typedef struct island{ 
</span><span class='line'>  char *name;
</span><span class='line'>  char *opens;
</span><span class='line'>  char *closes;
</span><span class='line'>  island *next;   } island;
</span><span class='line'>
</span><span class='line'>#include&lt;stdlib.h&gt;
</span><span class='line'>island *p = malloc(sizeof(island))
</span><span class='line'>free(p);</span></code></pre></td></tr></table></div></figure>


<p>ä»¥ä¸‹å‡½æ•°æœ‰ä½•é—®é¢˜</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>island* create(char *name) {
</span><span class='line'>      island *i = malloc(sizeof(island)); 
</span><span class='line'>      i-&gt;name = name;
</span><span class='line'>      i-&gt;opens = "09:00";
</span><span class='line'>      i-&gt;closes = "17:00";
</span><span class='line'>      i-&gt;next = NULL;
</span><span class='line'>      return i; 
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>å½“åœ¨ç¨‹åºé‡Œè°ƒç”¨å¦‚ä¸‹ä»£ç æ—¶</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>char name[80];fgets(name, 80, stdin);island *p_island0 = create(name); 
</span><span class='line'>fgets(name, 80, stdin);island *p_island1 = create(name);</span></code></pre></td></tr></table></div></figure>


<p>p_island0å’Œp_island1çš„nameæ˜¯ä¸€æ ·çš„ï¼ï¼ï¼åŸæ¥æ˜¯createå‡½æ•°ä¼ å…¥çš„åªæ˜¯nameçš„åœ°å€ï¼Œä¸¤è€…çš„åœ°å€æ˜¯ä¸€æ ·çš„ï¼Œä½ å¿…é¡»ç”¨strdupå‡½æ•°copyå­—ç¬¦ä¸²,æ•…ä»¥ä¸Šcreateå‡½æ•°çš„ä»£ç ä¸­çš„</p>

<pre><code>i-&gt;name = name;
</code></pre>

<p>å¯æ”¹ä¸º</p>

<pre><code>i-&gt;name = strdup(name);
</code></pre>

<p>ä¸è¿‡è¦è®°å¾—ç”¨strdup()æ‹·è´å­—ç¬¦ä¸²ï¼Œæœ€åéœ€è¦ç”¨free()å°†æ­¤æ‹·è´å­—ç¬¦ä¸²releaseæ‰</p>

<h3>valgrindå¯ç”¨æ¥æ£€æµ‹å†…å­˜æ³„æ¼</h3>

<p>valgrindèƒ½æ¨¡æ‹Ÿåœ¨å †ä¸Šåˆ†é…çš„æ•°æ®ï¼Œå®ƒé€šè¿‡åˆ›å»ºæ¨¡æ‹Ÿçš„malloc()ç‰ˆæœ¬æ¥å·¥ä½œï¼Œå½“ä½ çš„ç¨‹åºæƒ³è¦åˆ†é…ä¸€äº›å †ä¸Šçš„å†…å­˜æ—¶ï¼Œvalgrindå°†æˆªè·ä½ å¯¹malloc()å’Œfree()çš„è°ƒç”¨å¹¶è¿è¡Œå®ƒè‡ªå·±çš„æ¨¡æ‹Ÿç‰ˆæœ¬çš„malloc()å’Œfree(),valgrindç‰ˆæœ¬çš„malloc()å°†è®°å½•è°ƒç”¨å®ƒçš„é‚£äº›ä»£ç ä»¥åŠå®ƒæ‰€åˆ†é…çš„é‚£éƒ¨åˆ†å†…å­˜,å½“ä½ çš„ç¨‹åºç»ˆæ­¢æ—¶,valgrindå°†ä¼šæŠ¥å‘Šä»»ä½•å †ä¸Šè¿˜å­˜åœ¨çš„æ•°æ®å¹¶ä¸”å‘Šè¯‰ä½ è¿™äº›æ•°æ®ç”±å“ªäº›ä»£ç è°ƒç”¨äº§ç”Ÿçš„</p>

<h4>å‡†å¤‡:æ·»åŠ debugä¿¡æ¯</h4>

<p>ç”¨valgrindè¿è¡Œä¹‹å‰ä½ ä¸éœ€è¦å¯¹ä½ çš„ä»£ç ä½œä»»ä½•æ“ä½œï¼Œä½ ç”šè‡³ä¸éœ€è¦é‡æ–°ç¼–è¯‘ä»£ç ï¼Œä½†æ˜¯ä¸ºäº†æ›´å¥½åœ°åˆ©ç”¨valgrindï¼Œä»£éœ€è¦ç¡®ä¿ä½ çš„å¯æ‰§è¡Œä»£ç åŒ…å«debugä¿¡æ¯ï¼Œdebugä¿¡æ¯æ˜¯åœ¨ç¼–è¯‘ä»£ç ååµŒå…¥åˆ°å¯æ‰§è¡Œæ–‡ä»¶é‡Œçš„é¢å¤–æ•°æ®ï¼Œæ¯”å¦‚ä»£ç å¯¹åº”çš„è¡Œæ•°ï¼Œå¦‚æœdebugä¿¡æ¯å­˜åœ¨äº†ï¼Œvalgrindå°†èƒ½ç»™ä½ è®¸å¤šå†…å­˜æ³„æ¼çš„å…·ä½“ä¿¡æ¯
æµ‹è¯•æ‰€ç”¨ç¨‹åº<a href="https://gist.github.com/xiekunRonaldo/cdde073cac5636270322">spies</a>
ç”¨valgrindç»“åˆ&mdash;leak-check=fullé€‰é¡¹è¿›è¡Œä»¥ä¸‹æµ‹è¯•</p>

<p><img src="http://xiekunRonaldo.github.io/images/2014/7/valgrind1.png"></p>

<p>ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œå½“SPIESé€€å‡ºåï¼Œå †ä¸Šå·²æ— å¯¹è±¡ï¼Œå†è¿è¡Œä¸€éè¯•è¯•çœ‹ï¼Œç„¶åå‘Šè¯‰ç¨‹åºæœ‰ä¸€ä¸ªHayden Fantucciçš„å«Œç–‘äººä¼šæ€æ ·</p>

<p><img src="http://xiekunRonaldo.github.io/images/2014/7/valgrind2.png"></p>

<p>è¿™æ¬¡,valgrindå‘ç°äº†å†…å­˜æ³„æ¼,ä»ä¸Šå›¾å¯çœ‹å‡ºï¼Œåœ¨ç¨‹åºç»“æŸæ—¶ï¼Œå †ä¸Šæœ‰19ä¸ªå­—èŠ‚çš„ç©ºé—´æœªé‡Šæ”¾,valgrindå‘Šè¯‰ä½ ä»¥ä¸‹ä¿¡æ¯</p>

<ol>
<li>19ä¸ªå­—èŠ‚çš„å†…å­˜åˆ†é…äº†ä½†æœªé‡Šæ”¾</li>
<li>åˆ†é…äº†11æ¬¡çš„å†…å­˜ç©ºé—´ï¼Œä½†åªé‡Šæ”¾äº†10æ¬¡</li>
<li>è¿™å‡ è¡Œç»™äº†æˆ‘ä»¬ä»€ä¹ˆçº¿ç´¢</li>
<li>ä¸ºä»€ä¹ˆæ˜¯19ä¸ªå­—èŠ‚ï¼Ÿè¯´æ˜äº†ä»€ä¹ˆ?
ä»ä»¥ä¸ªä¿¡æ¯å¯å¾—,&ldquo;Loretta Barnsworth&#8221;å äº†19ä¸ªå­—èŠ‚,strdupå¯¼è‡´äº†å†…å­˜æ³„æ¼ï¼</li>
<li>valgrindæ˜¯å¦‚ä½•æˆªè·å¯¹malloc()å’Œfree()çš„è°ƒç”¨çš„
ç­”:malloc()å’Œfree() å®é™…ä¸Šæ˜¯æ ‡å‡†åº“å‡½æ•°ï¼Œä¸è¿‡valgrindåŒ…å«ä¸€ä¸ªå®ƒè‡ªå·±çš„malloc()å’Œfree()ç‰ˆæœ¬çš„æ ‡å‡†åº“å‡½æ•°ï¼Œå½“ä½ ç”¨valgrindæ¥è¿è¡Œç¨‹åºæ—¶ï¼Œä½ çš„ç¨‹åºå°†ç”¨valgrindçš„malloc()å’Œfree()å‡½æ•°ï¼Œè€ŒéCçš„æ ‡å‡†åº“å‡½æ•°</li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Head First Cç¬¬äº”ç« å­¦ä¹ ç¬”è®°]]></title>
    <link href="http://xiekunRonaldo.github.io/blog/2014/07/13/head-first-cdi-wu-zhang-xue-xi-bi-ji/"/>
    <updated>2014-07-13T09:22:09+08:00</updated>
    <id>http://xiekunRonaldo.github.io/blog/2014/07/13/head-first-cdi-wu-zhang-xue-xi-bi-ji</id>
    <content type="html"><![CDATA[<h4>Unionçš„åˆå§‹åŒ–</h4>

<ol>
<li><p>ç”¨.æ¥åˆå§‹åŒ–</p>

<pre><code> typedef union { 
     short count;
     float weight;
     float volume;       } quantity;
 //By name       quantity q = {.weight=1.5};
 //By dot notation
 quantity q;
 q.volume = 3.7;
</code></pre></li>
<li><p>structä¹Ÿå¯ä»¥æŒ‰åå­—(Designated initializer)æ¥è¿›è¡Œåˆå§‹åŒ–
         typedef struct {            const char *color;          int gears;          int height;     } bike;     bike b = {.height=17, .gears=21};</p></li>
</ol>


<p>unionå¯ä»¥ç”¨åœ¨structä¸­</p>

<pre><code>typedef struct {        const char *name;       const char *country;        quantity amount;    } fruit_order;
</code></pre>

<p>ä½ å¯ä»¥é€šè¿‡.æˆ–->æ¥è®¿é—®æˆå‘˜å€¼</p>

<pre><code>fruit_order apples = {"apples", "England", .amount.weight=4.2};
</code></pre>

<p>å‡è®¾æœ‰ä¸€ä¸‹å®šä¹‰</p>

<pre><code>typedef union { 
    float lemon;
    int lime_pieces;    } lemon_lime;
typedef struct {        float tequila;      float cointreau;        lemon_lime citrus;  } margarita;
</code></pre>

<p>åˆ™ä»¥ä¸‹å®šä¹‰æ˜¯é”™è¯¯çš„</p>

<pre><code>margarita m;    m = {2.0, 1.0, {0.5}};  //ç¼–è¯‘å™¨ä¼šè®¤ä¸ºæ˜¯æ•°ç»„
</code></pre>

<p>ä»¥ä¸‹å®šä¹‰æ‰æ˜¯å¯¹çš„</p>

<pre><code>margarita m = {2.0, 1.0, {0.5}};
</code></pre>

<p>åœ¨ä¸€ä¸ªunioné‡Œï¼Œå¯èƒ½ä¼šæœ‰å¾ˆå¤šå¯èƒ½çš„å€¼ï¼Œä½†ä¸€æ—¦è¢«èµ‹å€¼ï¼Œä½ æ²¡æ³•çŸ¥é“å®ƒå­˜å‚¨çš„å€¼çš„ç±»å‹
æˆ‘ä»¬å¯èƒ½ä¸ºæŸäº›å­—æ®µè®¾å®šäº†å€¼å´è®¿é—®äº†å¦ä¸€ä¸ªå­—æ®µï¼Œè¿™å¯èƒ½å‡ºç°å¤§é—®é¢˜,å‡è®¾æœ‰ä»¥ä¸‹ç¨‹åº</p>

<pre><code>#include &lt;stdio.h&gt; 
typedef union { 
  float weight;   int count;    } cupcake;
    int main() {        cupcake order = {2};        printf("Cupcakes quantity: %i\n", order.count);     return 0;   }
</code></pre>

<p>è¿è¡Œç¨‹åºå°†ä¼šå‡ºç°ä»¥ä¸‹ç»“æœ</p>

<pre><code>gcc badunion.c -o badunion &amp;&amp; ./badunion 
Cupcakes quantity: 1073741824å¯ä»¥ç”¨enumæ¥é¿å…æ­¤ç±»é—®é¢˜
</code></pre>

<h4>Bitfiled</h4>

<p>bitfieldèƒ½è®©ä½ æŒ‡å®šstructé‡Œçš„fieldèƒ½æœ‰å‡ ä½ï¼Œä½ å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼å®šä¹‰struct</p>

<pre><code>typedef struct {
    unsigned int low_pass_vcf:1;
    unsigned int filter_coupler:1;  } synth;
</code></pre>

<p>ç”¨bitfieldï¼Œä½ èƒ½è®©æ¯ä¸ªfieldéƒ½åªå ä¸€ä½
å¦‚æœä½ æœ‰ä¸€è¿ä¸²çš„bitfields,è®¡ç®—æœºèƒ½å°†å®ƒä»¬æ’åˆ—å‹ç¼©ä»¥èŠ‚çœç©ºé—´ï¼Œæ‰€ä»¥å¦‚æœä½ æœ‰8ä¸ª1ä½çš„bitfieldsï¼Œç”µè„‘å°†ä¼šæŠŠå®ƒä»¬å­˜å‚¨åˆ°ä¸€ä¸ªå­—èŠ‚é‡Œ
bitfieldçš„ä¸ä»…å¯ä»¥èŠ‚çœç©ºé—´ï¼Œä¹Ÿå¯ä»¥è¯»å†™æŸäº›äºŒè¿›åˆ¶æ–‡ä»¶</p>

<ul>
<li>bitfieldåº”è¯¥è¢«å£°æ˜ä¸ºunsigned int</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Head First Cç¬¬å››ç« å­¦ä¹ ç¬”è®°]]></title>
    <link href="http://xiekunRonaldo.github.io/blog/2014/07/01/head-first-cdi-si-zhang-xue-xi-bi-ji/"/>
    <updated>2014-07-01T19:23:15+08:00</updated>
    <id>http://xiekunRonaldo.github.io/blog/2014/07/01/head-first-cdi-si-zhang-xue-xi-bi-ji</id>
    <content type="html"><![CDATA[<p><code>#include &lt;limits.h&gt;</code>æ­¤å¤´æ–‡ä»¶åŒ…å«ä¸€äº›æ•´å‹å¦‚intå’Œcharçš„å€¼,å¯æ‰“å°æ•´å‹çš„æœ€å¤§æœ€å°å€¼,å¦‚</p>

<pre><code>printf("The value of INT_MAX is %i\n", INT_MAX); 
printf("The value of INT_MIN is %i\n", INT_MIN);
</code></pre>

<p><code>#include &lt;float.h&gt;</code>æ­¤å¤´æ–‡ä»¶åŒ…å«ä¸€äº›æµ®ç‚¹å‹å¦‚floatå’Œdoubleçš„å€¼,å¯æ‰“å°æµ®ç‚¹çš„æœ€å¤§æœ€å°å€¼,å¦‚</p>

<pre><code>printf("The value of FLT_MAX is %f\n", FLT_MAX);
printf("The value of FLT_MIN is %.50f\n", FLT_MIN);
</code></pre>

<p>å¦‚æœä½ æƒ³çŸ¥é“char,short,doubleæˆ–longçš„å…·ä½“ç»†èŠ‚å‘¢,æ²¡é—®é¢˜ï¼Œåªè¦å°†INTå’ŒFLTæ›¿æ¢æˆCHAR,DBL,SHRT,LNGå³å¯
ä¸è¿‡ä½ ä¼šå‘ç°åœ¨ä¸åŒçš„æœºå™¨ä¸Šï¼Œè¿™äº›å€¼éƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œå› ä¸ºCåœ¨ä¸åŒçš„OSå’Œå¤„ç†å™¨ä¸Šç”¨äº†ä¸åŒçš„æ•°æ®ç±»å‹ï¼Œè¿™ä¹ˆåšå…è®¸å®ƒæœ€å¤§é™åº¦åœ°åˆ©ç”¨äº†ç¡¬ä»¶çš„ç‰¹æ€§,é‚£ä¹ˆCæ˜¯å¦‚ä½•åšçš„å‘¢
å½“Cè¢«å‘æ˜æ—¶ï¼Œè®¸å¤šæœºå™¨æ˜¯8ä½çš„ï¼Œç°åœ¨ï¼Œè®¸å¤šæœºå™¨æ˜¯32ä½æˆ–64ä½çš„ï¼Œç”±äºCå¹¶ä¸æŒ‡å®šæ•°æ®ç±»å‹çš„ç¡®åˆ‡å¤§å°ï¼Œè¿™æ ·ï¼Œå®ƒæœ‰å¾ˆå¥½çš„ç§»æ¤æ€§ï¼Œéšç€è¶Šæ¥è¶Šå¤šçš„æœºå™¨è¢«å‘æ˜å‡ºæ¥ï¼ŒCå°†èƒ½å¤Ÿæœ‰é™åœ°åˆ©ç”¨å®ƒä»¬</p>

<p><code>è¿™é‡Œæˆ‘ä»¬è¯´çš„8ä½å’Œ64ä½æ˜¯ä»€ä¹ˆæ„æ€</code>
ä¸€å°è®¡ç®—æœºçš„ä½å¤§å°å®é™…ä¸Šè¡¨ç¤ºå¤šç§æƒ…å†µï¼Œæ¯”å¦‚å®ƒçš„CPUæŒ‡ä»¤çš„å¤§å°æˆ–è€…CPUä¸€æ¬¡èƒ½ä»å†…å­˜ä¸­è¯»å–çš„æ•°æ®å¤§å°ï¼Œä½å¤§å°æ˜¯ä¸€å°è®¡ç®—æœºèƒ½å¤„ç†åœ°æœ€ä¼˜å¤§å°
<code>é‚£ä¹ˆè¿™å’Œintsæˆ–doublesçš„å¤§å°æœ‰ä½•å…³ç³»å‘¢</code>
å¦‚æœä¸€å°è®¡ç®—æœºèƒ½æœ€ä¼˜åœ°å¤„ç†32ä½çš„æ•°ï¼Œé‚£ä¹ˆåŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œå¦‚intä¹Ÿä¼šè¢«è®¾ç½®æˆ32ä½
<code>floatså’Œdoublesæ˜¯å¦‚ä½•å­˜å‚¨çš„</code>
<a href="http://tinyurl.com/6defkv6">http://tinyurl.com/6defkv6</a>
ä¸€æ®µä»£ç å¼•å‘çš„æ€è€ƒ
<img src="http://xiekunRonaldo.github.io/images/2014/7/errorcode.png"></p>

<p>è¿è¡Œä»¥ä¸Šä»£ç </p>

<p><img src="http://xiekunRonaldo.github.io/images/2014/7/errorcommandline.png"></p>

<p><code>error: conflicting types for 'add_with_tax'</code>æ­¤è¯ä½•è§£</p>

<p><code>å½“ç¼–è¯‘å™¨çœ‹åˆ°ä»¥ä¸‹çš„ä»£ç æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆ</code></p>

<pre><code>printf("Total so far: %.2f\n", add_with_tax(val));
</code></pre>

<p>ç¼–è¯‘å™¨å°†çœ‹åˆ°ä¸€ä¸ªå¯¹ä¸è®¤è¯†çš„å‡½æ•°çš„è°ƒç”¨ï¼Œå®ƒå¹¶ä¸æŠ±æ€¨ï¼Œç¼–è¯‘å™¨ä¼šçŒœæƒ³å®ƒä¼šåœ¨æºæ–‡ä»¶çš„éšåéƒ¨åˆ†å‘ç°æ›´å¤šæ­¤å‡½æ•°çš„ä¿¡æ¯ï¼Œä¸å¹¸çš„æ˜¯ï¼Œè¿™å°±æ˜¯é—®é¢˜æ‰€åœ¨,ç¼–è¯‘å™¨ä¼šæƒ³ï¼Œè¿™ä¸ªå‡½æ•°æˆ‘ä»æ¥æ²¡è§è¿‡ï¼Œä½†æˆ‘è¦å…ˆè®°å½•å®ƒä»¥ä¾¿åœ¨æºæ–‡ä»¶çš„ååŠéƒ¨åˆ†å¯¹å®ƒè¿›è¡Œå¤„ç†
<code>é—®é¢˜æ˜¯ç¼–è¯‘éœ€è¦çŸ¥é“æ­¤å‡½æ•°çš„è¿”å›ç±»å‹</code>å½“ç„¶ï¼Œç¼–è¯‘å™¨æ­¤æ—¶å¹¶ä¸çŸ¥é“å‡½æ•°çš„è¿”å›ç±»å‹ï¼Œæ‰€ä»¥å®ƒå°±ä½œ äº†ä¸€ä¸ªå‡è®¾ï¼Œç¼–è¯‘å™¨å‡è®¾æ­¤å‡½æ•°è¿”å›intå€¼
<code>ä½†å½“ç¼–è¯‘å™¨åˆ°è¾¾æ­¤å‡½æ•°çš„å®šä¹‰æ—¶ï¼Œå®ƒå°†è¿”å›ä¸€ä¸ªâ€œconflicting types for â€˜add_with_taxâ€™â€é”™è¯¯</code>
è¿™æ˜¯å› ä¸ºç¼–è¯‘å™¨è®¤ä¸ºå®ƒçœ‹åˆ°äº†ä¸¤ä¸ªåŒåå‡½æ•°ï¼Œä¸€ä¸ªæ˜¯å®é™…å­˜åœ¨æ–‡ä»¶ä¸­çš„å‡½æ•°ï¼Œä¸€ä¸ªåˆ™æ˜¯ç¼–è¯‘å™¨å‡è®¾çš„ï¼Œè¿”å›intå‹çš„å‡½æ•°
<code>é‚£ä¹ˆå¦‚ä½•è§£å†³æ­¤é—®é¢˜å‘¢ï¼Œä½ å¯èƒ½ä¼šè®¤ä¸ºï¼ŒæŠŠå‡½æ•°æ”¾åœ¨è°ƒç”¨ä»£ç çš„å‰é¢æŒ‰æ­£ç¡®åœ°é¡ºåºä¹¦å†™ä¸å°±okäº†å—</code>
è¿™ä¹ˆåšç¡®å®å¯ä»¥è§£å†³é—®é¢˜ï¼Œä½†<code>ä¿®æ”¹å‡½æ•°çš„é¡ºåºæ˜¯ä»¶å¾ˆç—›è‹¦çš„äº‹</code>,å‡è®¾æœ‰ä»¥ä¸‹æƒ…å†µï¼Œä½ æ·»åŠ äº†ä¸€ä¸ªå¾ˆæ£’çš„æ–°å‡½æ•°</p>

<pre><code>int do_whatever(){...}  float do_something_fantastic(int awesome_level) {...} int do_stuff() {  do_something_fantastic(11); }
</code></pre>

<p>æ­¤æ—¶ä½ æ”¹å˜æ³¨æ„æƒ³åœ¨do_whateverè°ƒç”¨do_something_fantasticå‡½æ•°å‘¢ï¼Œé‚£ä½ ä¸å¾—ä¸å°†do_something_fantasticå‡½æ•°ç§»do_whateverå‰é¢,å¾ˆéº»çƒ¦ï¼Œæ›´éº»çƒ¦çš„æ˜¯ï¼Œæœ‰äº›é€’å½’å‡½æ•°å°†åœ¨å®ƒè¢«å®šä¹‰å‰è°ƒç”¨è‡ªå·±,å¦‚</p>

<pre><code>float ping(){
    pong();
}
float pong(){
    ping();
}
</code></pre>

<p>å¦‚æœä½ æœ‰ä¸¤ä¸ªç›¸äº’è°ƒç”¨çš„å‡½æ•°ï¼Œå…¶ä¸­ä¸€ä¸ªå¿…ç„¶ä¼šåœ¨å®ƒå®šä¹‰ä¹‹å‰è¢«è°ƒç”¨ï¼Œè¿™æ ·å¿…ç„¶æ€§é”™è¯¯ï¼Œè§£å†³æ–¹æ³•æ˜¯
<code>å°†å£°æ˜å’Œå®šä¹‰åˆ†éš”å¼€æ¥</code>,å°†å£°æ˜æ”¾åœ¨å¤´æ–‡ä»¶(.h)å°†å®šä¹‰æ”¾åœ¨å®ç°æ–‡ä»¶(.c)
<code>è¦ç‚¹</code>
* ä»ä»¥ä¸Šå¯å¾—çŸ¥å®é™…ä¸Šä½ æ— é¡»ä¸ºè¿”å›å€¼ä¸ºintå‡½æ•°å£°æ˜
å°†å¤šä¸ªæºæ–‡ä»¶ç¼–è¯‘æˆä¸€ä¸ªå¯æ‰§è¡Œç¨‹åº</p>

<pre><code>gcc message_hider.c encrypt.c -o message_hider
</code></pre>

<p><code>ç¼–è¯‘</code>   gcc -c *.c</p>

<p><code>é“¾æ¥</code>   gcc *.o -o launch</p>

<p>é—®é¢˜æ˜¯å¦‚æœæœ‰éå¸¸å¤šçš„æºæ–‡ä»¶ï¼Œå½“ä½ ä¿®æ”¹ä¸€ä¸ªï¼Œä½ éœ€è¦æŠŠæ‰€æœ‰çš„è¿™äº›æºæ–‡ä»¶å…¨éƒ½ç¼–è¯‘ä¸€éï¼Œè¦æµªè´¹å¾ˆå¤šæ—¶é—´!é‚£å¦‚ä½•è§£å†³å‘¢</p>

<h4>makeå·¥å…·</h4>

<p>makeæ˜¯ä¸€ç§èƒ½è‡ªåŠ¨ç¼–è¯‘ä½ çš„æºæ–‡ä»¶çš„ä¸€ç§å·¥å…·
<img src="http://xiekunRonaldo.github.io/images/2014/7/theater.png">
å¦‚ä¸Šæ‰€æœªï¼Œä½ å¦‚ä½•æ–­å®šthruster.oæ–‡ä»¶éœ€è¦é‡æ–°ç¼–è¯‘å‘¢ï¼Œçœ‹æ—¶é—´æˆ³ï¼Œå¦‚æœthruster.oæ–‡ä»¶æ—©äºthruster.c,thruster.oå°±éœ€è¦é‡æ–°åˆ›å»ºäº†ï¼Œç›¸å½“ç®€å•çš„è§„åˆ™ï¼Œä¸æ˜¯å—ï¼Œæ—¢ç„¶æ˜ç™½äº†è§„åˆ™ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨makeå·¥å…·è‡ªåŠ¨è¿›è¡Œæ­¤è¿‡ç¨‹ï¼Œmakeå°†ä¼šæ¯”è¾ƒæºæ–‡ä»¶å’Œç›®æ ‡æ–‡ä»¶çš„æ—¶é—´æˆ³ï¼Œå¦‚æœæŸäº›ç›®æ ‡æ–‡ä»¶çš„æ—¶é—´æˆ³æ—©äºæºæ–‡ä»¶ï¼Œåˆ™å®ƒå°†å¯¹è¿™äº›æºæ–‡ä»¶é‡æ–°ç¼–è¯‘ï¼Œä½†åœ¨æ­¤ä¹‹å‰ï¼Œä½ éœ€è¦å‘Šè¯‰makeè¿™ä¸ªå·¥å…·ä¸€äº›ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–‡ä»¶çš„ä¿¡èµ–å…³ç³»ç­‰ï¼Œä½ éœ€è¦ç¡®åˆ‡åœ°å‘Šè¯‰å®ƒä½ æƒ³è¦å¦‚ä½•ç¼–è¯‘ä»£ç </p>

<h4>makeéœ€è¦çŸ¥é“å“ªäº›ä¸œè¥¿</h4>

<p>å¦‚æœä½ æƒ³å°†thruster.cç¼–è¾‘æˆä¸€ä¸ªå«thruster.oçš„ç›®æ ‡æ–‡ä»¶,ä¾èµ–æ–‡ä»¶å’Œé…æ–¹åˆ†åˆ«æ˜¯ä»€ä¹ˆ,thruster.oæ˜¯ç›®æ ‡æ–‡ä»¶,å› ä¸ºè¿™æ˜¯ä½ æƒ³è¦ç”Ÿæˆçš„æ–‡ä»¶ï¼Œthruster.cå°±æ˜¯ä¿¡èµ–æ–‡ä»¶ï¼Œå› ä¸ºå®ƒæ˜¯ç¼–è¯‘æ‰€éœ€çš„è½¬åŒ–ä¸ºthruster.oçš„æºæ–‡ä»¶ï¼Œé‚£ä¹ˆé…æ–¹æ˜¯ä»€ä¹ˆå‘¢ï¼Œæ˜¯å°†thruster.cè½¬åŒ–ä¸ºthruster.oçš„ç¼–è¯‘å™¨å‘½ä»¤</p>

<pre><code>gcc -c thruster.c
</code></pre>

<p>æ˜ç™½äº†å—ï¼Ÿå¦‚æœä½ å‘Šè¯‰makeå·¥å…·ç›¸åº”çš„ä¿¡èµ–æ–‡ä»¶å’Œé…æ–¹,ä½ å°±èƒ½è®©makeå·¥å…·çŸ¥é“ä½•æ—¶å®ƒéœ€è¦é‡æ–°ç¼–è¯‘æˆthruster.oäº†
ä½†ä½ å¯ä»¥æ›´è¿›ä¸€æ­¥ï¼Œä¸€æ—¦ä½ ç¼–è¯‘äº†thruster.oçš„ç›®æ ‡æ–‡ä»¶ï¼Œä½ å°±å°†ç”¨å®ƒåˆ›å»ºlaunchç¨‹åºäº†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œlaunchæ–‡ä»¶ä¹Ÿå¯ä»¥è¢«è®¾ç½®æˆä¸€ä¸ªç›®æ ‡ï¼Œå› ä¸ºå®ƒæ˜¯ä½ è¦äº§ç”Ÿçš„æ–‡ä»¶ï¼Œlaunchçš„ä¾èµ–æ–‡ä»¶æ˜¯æ‰€æœ‰çš„.oçš„ç›®æ ‡æ–‡ä»¶ï¼Œé…æ–¹æ˜¯ä»¥ä¸‹å‘½ä»¤</p>

<pre><code>gcc *.o -o launch
</code></pre>

<p>ä¸€æ—¦makeçŸ¥é“äº†æ‰€æœ‰çš„ä¾èµ–æ–‡ä»¶å’Œè§„åˆ™ï¼Œä½ æ‰€è¦åšçš„å°±æ˜¯å‘Šè¯‰å®ƒå»åˆ›å»ºlaunchæ–‡ä»¶äº†
<img src="http://xiekunRonaldo.github.io/images/2014/7/make.png"></p>

<p>ä»¥ä¸‹æ˜¯makeæ–‡ä»¶çš„å†…å®¹
<img src="http://xiekunRonaldo.github.io/images/2014/7/makefile.png"></p>

<p>æœ€åè¾“å…¥ä»¥ä¸‹å‘½ä»¤
<img src="http://xiekunRonaldo.github.io/images/2014/7/makelaunch.png">
ä½ èƒ½çœ‹åˆ°makeèƒ½å¤Ÿæ‰§è¡Œåˆ›å»ºlaunchç¨‹åºæ‰€éœ€çš„å‘½ä»¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬çœ‹çœ‹å¦‚æœä½ æ”¹å˜äº†thruster.cæ–‡ä»¶ç„¶åé‡æ–°æ‰§è¡Œmakeå‘½ä»¤ä¼šå‘ç”Ÿä»€ä¹ˆ
<img src="http://xiekunRonaldo.github.io/images/2014/7/remake.png">
æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå®ƒåªç¼–è¯‘thruster.oäº†ï¼Œç„¶åé‡æ–°é“¾æ¥</p>

<pre><code>æ³¨:ç”±äºmakeæ–‡ä»¶è°ƒç”¨OSåº•å±‚çš„æ“ä½œç³»ç»Ÿï¼Œæœ‰æ—¶åŒä¸€ä¸ªmakeæ–‡ä»¶å¹¶ä¸é€‚ç”¨åœ¨ä¸åŒçš„OSä¸Š
</code></pre>

<p>é™¤äº†ç¼–è¯‘ä»£ç ï¼Œmakeä¹Ÿå¯ç”¨ä½œcommand-line installer,æˆ–æºç ç®¡ç†å·¥å…·ï¼Œå®é™…ä¸Šï¼Œæœ‰å‘½ä»¤è¡Œä¸Šä½ å‡ ä¹å¯ä»¥æŠŠmakeç”¨åœ¨ä»»ä½•ä½ æƒ³æ‰§è¡Œçš„ä»»åŠ¡ä¸Š</p>

<p>å¦‚æœä½ è§‰å¾—makeè¿˜ä¸å¤Ÿè‡ªåŠ¨åŒ–ï¼Œä½ å¯ä»¥è¯•è¯•<a href="http://www.gnu.org/software/autoconf/">autoconf</a>ç”¨æ¥äº§ç”Ÿmakeæ–‡ä»¶</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Head First C ç¬¬ä¸‰ç« å­¦ä¹ ç¬”è®°-åˆ›å»ºå°å·¥å…·]]></title>
    <link href="http://xiekunRonaldo.github.io/blog/2014/06/29/head-first-c-di-san-zhang-xue-xi-bi-ji-chuang-jian-%5B%3F%5D-xie-xiao-gong-ju/"/>
    <updated>2014-06-29T18:44:13+08:00</updated>
    <id>http://xiekunRonaldo.github.io/blog/2014/06/29/head-first-c-di-san-zhang-xue-xi-bi-ji-chuang-jian-[?]-xie-xiao-gong-ju</id>
    <content type="html"><![CDATA[<h3>è¦ç‚¹</h3>

<p>Linux/Unixç³»ç»Ÿæœ‰å¾ˆå¤šå°å·¥å…·,è¿™äº›å°å·¥å…·æ‰§è¡Œä¸€äº›ç‰¹å®šçš„ä»»åŠ¡ï¼Œæ¯”å¦‚è¯»å†™æ–‡ä»¶ï¼Œè¿‡æ»¤æ•°æ®ç­‰ï¼Œè¿™äº›å·¥å…·éƒ½åªè´Ÿè´£å¤„ç†è‡ªå·±çš„äº‹æƒ…ï¼Œå„å¸å…¶èŒï¼Œæ— éœ€é¡¾è™‘å…¶ä»–çš„å·¥å…·æ‰€åšçš„äº‹ï¼Œè¿™æ ·åšçš„å¥½å¤„å¯ä»¥å¦‚æœä½ éœ€è¦å¤„ç†ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„ä»»åŠ¡ï¼Œä½ å¯ä»¥å°†å®ƒåˆ†å‰²æˆå„ä¸ªå°ä»»åŠ¡ï¼Œæ¯ä¸ªå°ä»»åŠ¡ç”±ç›¸åº”çš„å·¥å…·å®Œæˆï¼Œå°±æœ‰æ•ˆåœ°åšåˆ°äº†è§£è€¦,åŒæ—¶è¿™ä¹ˆåšä¹Ÿä½¿å¾—æ¯ä¸ªå°ç¨‹åºæ›´å®¹æ˜“è°ƒè¯•</p>

<p>æ­¤ç« ä»‹ç»æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•äº†è§£å‘½ä»¤è¡Œå‚æ•°ï¼Œå¤„ç†æµä¿¡æ¯ï¼Œé‡å®šå‘ï¼Œå¹¶å¿«é€Ÿåœ°å°†å„ä¸ªå·¥å…·ç»„åˆèµ·æ¥</p>

<p>æœ¬ç« æˆ‘ä»¬ä¸»è¦ä»¥å°†ä»¥ä¸‹æ•°æ®æ ¼å¼</p>

<pre><code>42.363327,-71.097588,Speed = 23 
42.363255,-71.096710,Speed = 17
</code></pre>

<p>è½¬æ¢æˆä»¥ä¸‹çš„JSONå½¢å¼è¿›è¡Œè®¨è®ºåˆ†æ</p>

<pre><code>[{latitude: 42.363400, longitude: -71.098465, info: 'Speed = 21'},
 {latitude: 42.363327, longitude: -71.097588, info: 'Speed = 23'}, 
 {latitude: 42.363255, longitude: -71.096710, info: 'Speed = 17'},  ...]
</code></pre>

<p>ä»¥ä¸‹ç¨‹åº(geo2json)èƒ½ä»å‘½ä»¤è¡Œä¸­è¯»å–ä»¥é€—å·åˆ†éš”çš„è¡Œï¼Œå¹¶å°†å®ƒä»¥JSONçš„å½¢å¼å±•ç¤ºå‡ºæ¥</p>

<pre><code>//geo2json
#include &lt;stdio.h&gt;  int main() {        float latitude;     float longitude;        char info[80]; intstarted= 0 ï¿¼ ï¿¼ ;      puts("data=[");         while (scanf("%f,%f,%79[^\n]", &amp;latitude, &amp;longitude, info) == 3) {         if (started)                printf(",\n");          else                started= 1 ;
        if ((latitude &lt; -90.0) || (latitude &gt; 90.0)) {              printf(â€œInvalid latitude: %f\nâ€, latitude);             return 2;
        }           if ((longitude &lt; -180.0) || (longitude &gt; 180.0)) {              printf(â€œInvalid longitude: %f\nâ€, longitude);               return 2;           }           printf("{latitude: %f, longitude: %f, info: '%s'}", latitude , longitude , info );      }       puts("\n]");        return 0;   }
</code></pre>

<p>scanf()ä¼šè¿”å›è¾“å…¥çš„å‚æ•°ä¸ªæ•°</p>

<pre><code>while (scanf("%f,%f,%79[^\n]", , , ) == 3)
</code></pre>

<ul>
<li>æ³¨æ„ä»¥ä¸Šçš„[^\n]è¡¨ç¤ºç¬¬ä¸‰ä¸ªè¾“å…¥å‚æ•°çš„å†…å®¹ä¸ºé™¤æ¢è¡Œä»¥å¤–çš„å­—ç¬¦ä¸²</li>
</ul>


<p>ä»¥ä¸Šç¨‹åºè®©ä½ åœ¨é”®ç›˜ä¸Šè¾“å…¥GPSæ•°æ®ï¼Œå°†å°†å®ƒä»¬åœ¨JSONçš„å½¢å¼è¾“å‡ºåˆ°å±å¹•ä¸Š,é—®é¢˜æ˜¯è¾“å…¥å’Œè¾“å‡ºæ··èµ·æ¥äº†ï¼Œå¦‚æœæœ‰è®¸å¤šçš„æ•°æ®ï¼Œä½ è‚¯å®šä¸æƒ³åœ¨é”®ç›˜ä¸Šæ‰‹åŠ¨è¾“å…¥ï¼Œä½ è‚¯å®šå¸Œæœ›èƒ½ç”¨ä¸€ä¸ªå°å·¥å…·(geo2json)å°†å¤§é‡çš„æ•°æ®é€šè¿‡è¯»å–æ–‡ä»¶æ¥è·å–.</p>

<p>åœ¨ä»¥ä¸Šçš„ç¨‹åºä¸­ï¼Œä½ ç”¨scanf()å’Œprintf()æ¥ä»é”®ç›˜ä¸­è¯»å–æ•°æ®å¹¶å°†å®ƒæ˜¾ç¤ºåˆ°æ˜¾ç¤ºå™¨ä¸Šï¼Œä½†å®é™…ä¸Šå®ƒä»¬å¹¶ä¸ç›´æ¥å’Œé”®ç›˜å’Œæ˜¾ç¤ºå™¨äº¤äº’ï¼Œå®ƒä»¬ç”¨äº†æ ‡å‡†è¾“å…¥(Standard Input)å’Œæ ‡å‡†è¾“å‡º(Standard Output)æ¥å’Œç›¸åº”çš„è¾“å…¥è¾“å‡ºè®¾å¤‡äº¤äº’,è¾“å…¥è¾“å‡ºåœ¨ç¨‹åºè¿è¡Œçš„æ—¶å€™ç”±æ“ä½œç³»ç»Ÿåˆ›å»º</p>

<p>æ“ä½œç³»ç»Ÿå†³å®šäº†æ•°æ®å¦‚ä½•è¿›å‡ºæ ‡å‡†è¾“å…¥è¾“å‡ºçš„ï¼Œå¦‚æœä½ ä»ç»ˆç«¯è¿è¡Œä¸€ä¸ªç¨‹åºï¼Œæ“ä½œç³»ç»Ÿå°†æŠŠæ‰€æœ‰çš„æŒ‰é”®ä¿¡æ¯å‘é€ç»™æ ‡å‡†è¾“å…¥ï¼Œå¦‚æœæ“ä½œç³»ç»Ÿä»æ ‡å‡†è¾“å‡ºä¸­è·å–æ•°æ®ï¼Œé»˜è®¤æƒ…å†µä¸‹å®ƒå°†æŠŠæ•°æ®è¾“å…¥å‡ºæ˜¾ç¤ºå™¨ä¸Š
scanf()å’Œprintf()ä¸¤ä¸ªå‡½æ•°å¹¶ä¸å…³å¿ƒæ•°æ®æ¥è‡ªå“ªé‡Œï¼Œå»å‘ä½•æ–¹ï¼Œå®ƒä»¬ä»æ ‡å‡†è¾“å…¥å’Œæ ‡å‡†è¾“å‡ºä¸­è¯»å†™æ•°æ®
å¯èƒ½ä½ ä¼šé—®ï¼Œä¸ºä½•è¿™ä¸¤ä¸ªå‡½æ•°ä¸ç›´æ¥å’Œé”®ç›˜ï¼Œå±å¹•äº¤äº’ï¼Œéš¾é“ä¸æ˜¯æ›´ç®€å•å—</p>

<p>ç¨‹åºç³»ç»Ÿç”¨æ ‡å‡†è¾“å…¥å’Œæ ‡å‡†è¾“å‡ºçš„å½¢å¼ä¸ç¨‹åºè¿›è¡Œäº¤äº’æœ‰ä¸€ä¸ªå¾ˆå¥½çš„ç†ç”±:
ä½ å¯ä»¥é‡å®šå‘æ ‡å‡†è¾“å…¥å’Œæ ‡å‡†è¾“å‡ºåˆ°å…¶ä»–åœ°æ–¹ï¼Œæ¯”å¦‚æ–‡ä»¶</p>

<p>ä½ å¯ä»¥ç”¨&#8221;&lt;&ldquo;æ¥é‡å®šå‘æ ‡å‡†è¾“å…¥:</p>

<pre><code>./geo2json &lt; gpsdata.csv
</code></pre>

<p>&ldquo;&lt;&#8221;å‘Šè¯‰æ“ä½œç³»ç»Ÿç¨‹åºçš„æ ‡å‡†è¾“å…¥åº”ä¸gpsdata.csvæ–‡ä»¶è¿æ¥ï¼Œè€Œéé”®ç›˜ï¼Œæ‰€ä»¥ä½ å¯ä»¥é€šè¿‡æ–‡ä»¶å‘ç¨‹åºä¼ é€æ•°æ®</p>

<p>ä½ ä¹Ÿå¯ä»¥ç”¨&#8221;>&ldquo;æ¥é‡å®šå‘æ ‡å‡†è¾“å‡º</p>

<pre><code>./geo2json &lt; gpsdata.csv &gt; output.json
</code></pre>

<p>å°†ä½ æ‰§è¡Œä»¥ä¸Šå‘½ä»¤ï¼Œä½ å°†å‘ç°åœ¨å±å¹•ä¸Šæ²¡æœ‰ä»»ä½•æ•°æ®ï¼Œå› ä¸ºç»“æœå·²ç»è¾“å‡ºåˆ°output.jsonè¿™ä¸ªæ–‡ä»¶å»äº†</p>

<p>ä»¥ä¸Šçš„ç¨‹åº(geo2json)è™½ç„¶åŠ äº†é”™è¯¯åˆ¤æ–­ï¼Œä½†å¦‚æœæœ‰éæ³•æ•°æ®ï¼Œåœ¨æœ€åçš„è¾“å‡ºæ–‡ä»¶ä¸­ï¼Œä¸€æ ·ä¼šæœ‰éæ³•æ•°æ®
å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œå¦‚ä½•å‘ç°é”™è¯¯ç (ä»¥ä¸Šä¸º2)</p>

<pre><code>echo $?
</code></pre>

<p>å¦‚æœæ•°æ®é”™è¯¯äº†ï¼Œèƒ½æœ‰ä¸“é—¨é’ˆå¯¹è¿™äº›é”™è¯¯çš„è¾“å‡ºè¯¥å¤šå¥½!
æ ‡å‡†é”™è¯¯(Stand Error)åº”è¿è€Œç”Ÿ!å®ƒå°±æ˜¯ä¸“é—¨é’ˆå¯¹é”™è¯¯ä¿¡æ¯çš„è¾“å‡ºï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ ‡å‡†é”™è¯¯ä¸å±å¹•ç›¸è¿,ä»¥ä¸‹æ˜¯é»˜è®¤çŠ¶æ€ä¸‹çš„ä¸‰ç§æ ‡å‡†å¯¹åº”è®¾å¤‡çš„å›¾</p>

<p> <img src="http://xiekunRonaldo.github.io/images/2014/6/standardIOE.png"></p>

<p> ä¹Ÿå°±æ˜¯è¯´å¦‚æœé‡å®šå‘äº†æ ‡å‡†å‡ºå…¥å’Œæ ‡å‡†è¾“å‡ºï¼Œæ ‡å‡†é”™è¯¯ä»å°†å‘é€æ•°æ®åˆ°å±å¹•ä¸Š</p>

<p> <img src="http://xiekunRonaldo.github.io/images/2014/6/standardIOE2.png"></p>

<h3>fprintf()è¾“å‡ºåˆ°ä¸€ä¸ªæ•°æ®æµä¸­(æ ‡å‡†è¾“å‡ºæˆ–æ ‡å‡†é”™è¯¯)</h3>

<p>æˆ‘ä»¬å·²ç»çŸ¥é“print()å°†æ•°æ®è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºä¸­ï¼Œå®é™…ä¸Šprint()åªæ˜¯fprintf()çš„ä¸€ä¸ªç‰¹ä¾‹è€Œå·²
å½“ä½ è°ƒç”¨</p>

<pre><code>printf("I like Turtles!");
</code></pre>

<p>æ—¶ï¼Œå®é™…ä¸Šå®ƒè°ƒç”¨çš„æ˜¯</p>

<pre><code>fprintf(stdout, "I like Turtles!");
</code></pre>

<p>ä»¥ä¸Šæ¸…æ¥šåœ°æ˜¾ç¤ºäº†å­—ç¬¦ä¸²&#8221;I like Turtles&#8221;è¾“å‡ºåˆ°stdout,ä½ å¯ä»¥å‘Šè¯‰fprintf()å‘é€æ•°æ®åˆ°stdoutæˆ–stderr
æ—¢ç„¶çŸ¥é“äº†fprintf()çš„ç”¨æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¿®æ”¹geo2jsonäº†
 <img src="http://xiekunRonaldo.github.io/images/2014/7/updategeo2json.png">
è¿™æ ·é”™è¯¯ä¿¡æ¯å°±ä¸æ ‡å‡†é”™è¯¯è€Œä¸æ˜¯æ ‡å‡†è¾“å‡ºå…³è”äº†,é‡æ–°è¿è¡Œä»£ç ï¼Œä½ å°†çœ‹åˆ°å°½ç®¡æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°äº†output.jsonæ–‡ä»¶ï¼Œé”™è¯¯ä¿¡æ¯ä»ç„¶æ‰“å°åˆ°å±å¹•ä¸Šï¼Œè¿™æ˜¯å› ä¸ºæ ‡å‡†é”™è¯¯ä¿¡æ¯é»˜è®¤å°±æ˜¯æ‰“å°åˆ°å±å¹•ä¸Š</p>

<p> <img src="http://xiekunRonaldo.github.io/images/2014/7/stderroutput.png"></p>

<p>æ ‡å‡†é”™è¯¯çš„åˆ›å»ºå…¶å®å°±æ˜¯ä¸ºäº†å°†é”™è¯¯ä¿¡æ¯å’Œæ­£å¸¸çš„è¾“å‡ºåŒºåˆ†å¼€æ¥ï¼Œä¸è¿‡è¦è®°å¾—ï¼Œæ ‡å‡†é”™è¯¯å’Œæ ‡å‡†è¾“å‡ºéƒ½æ˜¯è¾“å‡ºæµï¼Œä½ å¯ä»¥éšå¿ƒæ‰€æ¬²åœ°ç”¨æŒ‰è‡ªå·±çš„æƒ³æ³•åˆ©ç”¨å®ƒä»¬</p>

<h4>è¦ç‚¹</h4>

<ul>
<li>printf()é»˜è®¤å‘é€æ•°æ®åˆ°æ ‡å‡†è¾“å‡º</li>
<li>æ ‡å‡†è¾“å‡ºé»˜è®¤è¾“å‡ºæ•°æ®åˆ°å±å¹•ä¸Š</li>
<li>åœ¨å‘½ä»¤è¡Œä¸­ä½ å¯ä»¥ç”¨&#8217;>&lsquo;æ¥é‡å®šå‘æ ‡å‡†è¾“å‡º,ç”¨&#8217;2>&#8217;æ¥é‡å®šå‘æ ‡å‡†é”™</li>
</ul>


<p>åœ¨ä»¥ä¸Šå¤„ç†ç»çº¬åº¦æ•°æ®çš„ç¨‹åºä¸­ï¼Œå¦‚æœä½ æƒ³å¾—åˆ°ä¸€å®šèŒƒå›´å†…çš„æ•°æ®ï¼Œå¦‚ä¸‹å›¾
<img src="http://xiekunRonaldo.github.io/images/2014/7/range.png"></p>

<p>ä¸ºäº†ä¸æ”¹å˜geo2jsonè¿™ä¸ªå·¥å…·ï¼Œä½ å¯ä»¥å¦å¤–åˆ›å»ºä¸€ä¸ªå·¥å…·(ç§°å®ƒä¸ºbermudeå§)æ¥è¿‡æ»¤ä¸åœ¨ä»¥ä¸ŠèŒƒå›´çš„æ•°æ®</p>

<pre><code>//bermude
#include &lt;stdio.h&gt;  int main()
{
    float latitude;     float longitude;        char info[80];      while (scanf("%f,%f,%79[^\n]", &amp;latitude, &amp;longitude , info ï¿¼) == 3)
    if (( ï¿¼ ï¿¼ latitude ï¿¼ &gt; ï¿¼ ï¿¼ 26 ï¿¼ ) ï¿¼ ï¿¼ &amp;&amp; ï¿¼ ( ï¿¼ ï¿¼ latitude ï¿¼ &lt; ï¿¼ ï¿¼ 34 ï¿¼ ))     ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼if (( longitude &gt; -76 ) &amp;&amp; ( longitude &lt; -64 )) 
        printf("%f,%f,%s\n", latitude , longitude , info );     ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼ï¿¼return 0;
}   
</code></pre>

<p>è¿™æ ·ï¼Œä½ å¯ä»¥é€šè¿‡ç®¡é“&#8217;|&lsquo;å°†&#8221;bermude&#8221;çš„è¾“å‡ºè¿æ¥åˆ°geo2jsonçš„æ ‡å‡†è¾“å…¥ä¸Šï¼Œè¿›è€Œå¾—åˆ°ç›¸åº”çš„ç»“æœ</p>

<p><img src="http://xiekunRonaldo.github.io/images/2014/7/pipe.png"></p>

<p>æ“ä½œç³»ç»Ÿå°†å¤„ç†ç®¡é“å·¥ä½œçš„ç»†èŠ‚ï¼Œä½ éœ€è¦åšçš„åªæ˜¯è¿è¡Œä¸€ä¸‹ä»¥ä¸‹çš„å‘½ä»¤</p>

<pre><code>bermuda | geo2json
</code></pre>

<p>æ“ä½œç³»ç»Ÿå°†åŒæ—¶è¿è¡Œä¸¤ä¸ªç¨‹åºï¼Œå®Œæ•´çš„å‘½ä»¤æ“ä½œå¦‚ä¸‹</p>

<pre><code>(./bermuda | ./geo2json) &lt; spooky.csv &gt; output.json
</code></pre>

<p>é€šè¿‡ç®¡é“å°†ä¸¤ä¸ªç¨‹åºè”åˆèµ·æ¥ä¸€èµ·è¿è¡Œï¼Œä½ å¯ä»¥æŠŠä¸¤ä¸ªç¨‹åºå½“ä½œä¸€ä¸ªè¿›è¡Œçœ‹å¾…ï¼Œè¿™æ ·ï¼Œä½ å°±èƒ½åƒä¹‹å‰é‚£æ ·é‡å®šå‘æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†è¾“å‡ºäº†ï¼Œæ³¨æ„æ‹¬å·æ˜¯å¿…è¦çš„ï¼ï¼Œè¿™æ ·ä¿è¯äº†æ–‡ä»¶çš„å†…å®¹å°†ä¼ åˆ°bermudaç¨‹åºçš„æ ‡å‡†è¾“å…¥ä¸­
æ€è€ƒï¼šå¦‚æœå¤šä¸ªç¨‹åºé€šè¿‡ç®¡é“è¿æ¥èµ·æ¥ï¼Œæ­¤æ—¶æˆ‘ç”¨&#8221;>&ldquo;å’Œ&rdquo;&lt;&ldquo;æ¥é‡å®šå‘æ ‡å‡†è¾“å…¥å’Œæ ‡å‡†è¾“å‡ºï¼Œå“ªä¸€ä¸ªç¨‹åºå°†è®©å®ƒä»¬çš„è¾“å…¥è¾“å‡ºé‡å®šå‘
ç­”:&rdquo;&lt;&ldquo;å°†æŠŠæ–‡ä»¶çš„å†…å®¹ä¼ åˆ°ç®¡é“ä¸­çš„ç¬¬ä¸€ä¸ªç¨‹åºä¸­,&rdquo;>&ldquo;å°†ä»ç®¡é“ä¸­çš„æœ€åä¸€ä¸ªç¨‹åºä¸­è·å–æ ‡å‡†è¾“å‡º</p>

<h4>å¦‚æœä½ æƒ³å°†è¾“å‡ºä¼ åˆ°å¤šä¸ªæ–‡ä»¶ä¸­å»å‘¢?</h4>

<p>æˆ‘ä»¬å·²ç»çŸ¥é“å¦‚ä½•ç”¨é‡å®šå‘ä»ä¸€ä¸ªæ–‡ä»¶ä¸­è¯»å–æ•°æ®å’Œå†™å…¥æ•°æ®åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­å»äº†ï¼Œé‚£å¦‚æœç¨‹åºæƒ³åšä¸€äº›æ›´å¤æ‚çš„ï¼Œæ¯”å¦‚å‘é€æ•°æ®åˆ°å¤šä¸ªæ–‡ä»¶ä¸­å»è¯¥å¦‚ä½•æ“ä½œå‘¢ï¼Ÿ
å‡è®¾ä½ éœ€è¦å¦å¤–ä¸€ä¸ªå·¥å…·ï¼Œè¿™ä¸ªå·¥å…·å°†ä»ä¸€ä¸ªæ–‡ä»¶ä¸­è¯»å–ä¸€ç³»åˆ—çš„æ•°æ®ï¼Œå¹¶å°†æ•°æ®åˆ†å‰²åˆ°å¤šä¸ªæ–‡ä»¶ä¸­å»
<img src="http://xiekunRonaldo.github.io/images/2014/7/threefiles.png">
é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿä½ æœ€å¤šåªèƒ½é‡å®šå‘åˆ°ä¸¤ä¸ªæ–‡ä»¶ä¸­ï¼Œåˆ†åˆ«ä»æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯ä¸­é‡å®šå‘ï¼Œé‚£ç¬¬ä¸‰ä¸ªæ–‡ä»¶è¯¥æ€ä¹ˆåŠå‘¢?</p>

<h4>ç”¨FILE</h4>

<p>æ¯ä¸€ä¸ªæ•°æ®æµç”±ä¸€ä¸ªæŒ‡å‘æ–‡ä»¶çš„æŒ‡é’ˆè¡¨ç¤ºï¼Œä½ å¯ä»¥ç”¨fopen()æ¥åˆ›å»ºä¸€ä¸ªæ•°æ®æµ</p>

<pre><code>FILE *in_file = fopen("input.txt", "r");
</code></pre>

<p>ä»¥ä¸Šåˆ›å»ºäº†ä¸€ä¸ªæ•°æ®æµï¼Œä»ä¸€ä¸ªæ–‡ä»¶ä¸­è¯»å–æ•°æ®</p>

<pre><code>ILE *out_file = fopen("output.txt", "w");ä»¥ä¸Šåˆ›å»ºçš„ä¸€ä¸ªæ•°æ®æµï¼Œå°†å†™å…¥æ•°æ®åˆ°æ–‡ä»¶ä¸­
</code></pre>

<p>ä¸€æ—¦ä½ åˆ›å»ºäº†ä¸€ä¸ªæ•°æ®æµï¼Œä½ å¯ä»¥ç”¨fprintf()å°†è¾“å‡ºçš„æ•°æ®æŒ‡å‘æ­¤æ–‡ä»¶ä¸­</p>

<pre><code>fprintf(out_file, "Don't wear %s with %s", "red", "green");
</code></pre>

<p>é‚£å¦‚æœæƒ³ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®å‘¢ï¼Œç”¨fscanf()</p>

<pre><code>fscanf(in_file, "%79[^\n]\n", sentence);
</code></pre>

<p>æœ€åï¼Œå½“ä½ å¤„ç†å®Œäº†ä»¥ä¸Šé’ˆå¯¹æ–‡ä»¶çš„æ•°æ®æµæ“ä½œï¼Œä½ éœ€è¦å…³é—­å®ƒï¼Œå®é™…ä¸Šå½“ç¨‹åºç»“æŸçš„æ—¶å€™æ‰€æœ‰çš„æ•°æ®æµéƒ½ä¼šè‡ªåŠ¨å…³é—­ï¼Œä¸è¿‡åœ¨ä¸éœ€è¦å®ƒä»¬æ—¶æ‰‹åŠ¨å…³é—­æ•°æ®æµæ€»é‡ä¸€ä¸ªå¥½ä¹ æƒ¯
å›åˆ°ä»¥ä¸Šçš„é—®é¢˜ï¼Œç°åœ¨æˆ‘ä»¬èƒ½æŠŠæ•°æ®è¾“å‡ºåˆ°3ä¸ªæ–‡ä»¶ä¸­å»äº†ï¼Œç¤ºä¾‹å¦‚ä¸‹</p>

<pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
int main() {        char line[80];      FILE *in = fopen("spooky.csv","r");     FILE *file1 = fopen("ufos.csv", â€œwâ€);
    FILE *file2 = fopen("disappearances.csv","w");
    FILE *file3 = fopen("others.csv","w");  
    while(fscanf(in,"%79[^\n]\n", line) == 1){
        if (strstr(line, "UFO"))                fprintf (file1, "%s\n", line);          else if (strstr(line, "Disappearance")) 
            fprintf (file2, "%s\n", line);          else fprintf (file3, "%s\n", line);     }
    fclose (file1);         fclose (file2);     fclose (file3);     return 0;
}   
</code></pre>

<p> ç¨‹åºæ­£å¸¸è¿è¡Œäº†ï¼Œå½“ä½ ç¼–è¯‘å¹¶æ‰§è¡Œä»¥ä¸‹å‘½ä»¤
<img src="http://xiekunRonaldo.github.io/images/2014/7/threefilesok.png"></p>

<p>ç¨‹åºæ­£å¸¸è¿è¡Œï¼Œå¹¶å°†ç»“æœè¾“å‡ºåˆ°3ä¸ªæ–‡ä»¶ä¸­
é—®é¢˜æ˜¯å¦‚æœä½ æƒ³æ•°æ®è¾“å‡ºåˆ°ä¸åŒçš„æ–‡ä»¶(è€Œä¸æ˜¯æŒ‡å®šçš„æ–‡ä»¶)ï¼Œåˆè¯¥å¦‚ä½•æ“ä½œå‘¢ï¼Œæ¯æ¬¡ç”¨æˆ·éƒ½éœ€è¦é‡æ–°ç¼–è¯‘ç¨‹åºå—</p>

<h4>main()å‡½æ•°çš„å‚æ•°</h4>

<p>å®é™…ä¸Šï¼Œä»»ä½•ä½ å†™çš„ç¨‹åºéƒ½éœ€è¦ç»™ç”¨æˆ·æ”¹å˜ç¨‹åºå·¥ä½œæ–¹å¼çš„çµæ´»æ€§ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªGUIç¨‹åºï¼Œä½ éœ€è¦æä¾›å®ƒçš„åå¥½è®¾ç½®ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œç¨‹åºï¼Œå°±åƒæˆ‘ä»¬çš„categorizeå·¥å…·ï¼Œå®ƒéœ€è¦æä¾›ç»™ç”¨æˆ·ä¼ é€å‘½ä»¤è¡Œå‚æ•°çš„èƒ½åŠ›
<img src="http://xiekunRonaldo.github.io/images/2014/7/commandlineparam.png">
é‚£ä¹ˆï¼Œå¦‚ä½•ä»ç¨‹åºä¸­è¯»å–å‘½ä»¤è¡Œå‚æ•°å‘¢ï¼Œç›®å‰ä¸ºæ­¢ï¼Œä½ ç”¨çš„æ˜¯main()å‡½æ•°ï¼Œæ²¡æœ‰åŒ…å«ä»»ä½•å‚æ•°ï¼Œå®é™…ä¸Šï¼Œä½ è¿˜å¯ä»¥ç”¨ä¸Šmain()å‡½æ•°çš„ç¬¬äºŒä¸ªç‰ˆæœ¬</p>

<pre><code>int main(int argc, char *argv[])
{
    ......Do stuff
}
</code></pre>

<p>ä»¥ä¸Šçš„main()å‡½æ•°æŠŠå‘½ä»¤è¡Œçš„å‚æ•°å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œå®é™…ä¸Šï¼Œç”±äºCæ²¡æœ‰å†…ç½®çš„å­—ç¬¦ä¸²ç±»å‹ï¼Œå®ƒå°†ç”¨ä¸€ä¸ªæŒ‡é’ˆæ•°ç»„æ¥æŒ‡å‘è¿™äº›å‘½ä»¤è¡Œå‚æ•°
<img src="http://xiekunRonaldo.github.io/images/2014/7/argv.png"></p>

<p>åƒCæ•°ç»„ä¸€æ ·,ä½ ä¹Ÿéœ€è¦çŸ¥é“ä¸€ä¸ªæ•°ç»„çš„é•¿åº¦ï¼Œargcå°±è¡¨ç¤ºæ­¤é•¿åº¦
å‘½ä»¤è¡Œå‚æ•°ç»™äº†ä½ ç¨‹åºå¾ˆå¤§çš„çµæ´»æ€§ï¼Œç¡®å®éœ€è¦ä»”ç»†è€ƒè™‘ä¸‹åœ¨ç¨‹åºè¿è¡Œæ—¶è¯¥è®©ç”¨æˆ·ä¼ å“ªäº›å‚æ•°ï¼Œå®ƒå°†è®©ä½ çš„ç¨‹åºæ›´æœ‰ä»·å€¼
ä»¥ä¸‹æ˜¯ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°çš„å®Œæ•´ç¤ºä¾‹</p>

<pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt; int main(int argc, char *argv[]) {      char line[80];
    if (argc != 6) {
        fprintf(stderr, "You need to give 6 arguments\n");
        return 1;
    }

    FILE *in = fopen("spooky.csv", "r");

    FILE *file1 = fopen(argv[2], "w");

    FILE *file2 = fopen(argv[4], "w");

    FILE *file3 = fopen(argv[5], "w");

    while (fscanf(in, "%79[^\n]\n", line) == 1) {
        if (strstr(line, argv[1]))
            fprintf(file1, "%s\n", line);
        else if (strstr(line, argv[3]))
            fprintf(file2, "%s\n", line);
        else 
            fprintf(file3, "%s\n", line);
    }

    fclose(file1);
    fclose(file2);
    fclose(file3); 
    return 0;
}
</code></pre>

<p>è¿è¡Œä»¥ä¸Šç¨‹åºï¼Œä½ é¦–é€‰éœ€è¦ä»¥ä¸‹æ ¼å¼çš„<code>spooky.csv</code>æ–‡ä»¶</p>

<pre><code>30.685163,-68.137207,Type=Yeti 28.304380,-74.575195,Type=UFO    29.132971,-71.136475,Type=Ship 28.343065,-62.753906,Type=Elvis  27.868217,-68.005371,Type=Goatsucker 30.496017,-73.333740,Type=Disappearance    26.224447,-71.477051,Type=UFO 29.401320,-66.027832,Type=Ship    37.879536,-69.477539,Type=Elvis
</code></pre>

<p>è¿™æ ·ï¼Œåœ¨å‘½ä»¤è¡Œä¸­è¾“å‡ºä»¥ä¸‹æ ¼å¼è¿è¡Œç¨‹åº</p>

<pre><code>categorize UFO aliens.csv Elvis elvises.csv the_rest.csv
</code></pre>

<p>å½“ç¨‹åºè¿è¡Œåï¼Œäº§ç”Ÿäº†ä»¥ä¸‹ä¸‰ä¸ªæ–‡ä»¶
<img src="http://xiekunRonaldo.github.io/images/2014/7/3outputfiles.png">
å°½ç®¡åœ¨ä»¥ä¸Šçš„ç¨‹åºä¸­æˆ‘ä»¬æ‰“å¼€å…³é—­ç¨‹åºæ²¡æœ‰å‡ºç°é”™è¯¯ï¼Œåœ¨å®é™…æ“ä½œä¸­æ˜¯å¾ˆå¯èƒ½çŠ¯é”™çš„ï¼Œå¹¸è¿çš„æ˜¯ï¼Œå¦‚æœåœ¨æ‰“å¼€æ•°æ®æµå‘ç”Ÿäº†é”™è¯¯,fopen()å°†è¿”å›0ï¼Œå› æ­¤ï¼Œä»¥ä¸Šçš„ç¨‹åºä¸­ï¼Œä½ åº”è¯¥å°†ä»¥ä¸‹çš„ç¨‹åº</p>

<pre><code>FILE *in = fopen("i_dont_exist.txt", "r");æ”¹ä¸º
FILE *in;   if (!(in = fopen("dont_exist.txt", "r"))) {     fprintf(stderr, "Can't open the file.\n");      return 1;   }
</code></pre>

<p>å¾ˆå¯èƒ½ä½ å†™çš„ç¨‹åºéœ€è¦ä¸€äº›é€‰é¡¹ï¼Œå¦‚æœä½ åˆ›å»ºäº†ä¸€ä¸ªèŠå¤©ç¨‹åºï¼Œå®ƒéœ€è¦ä¸€äº›åå¥½è®¾ç½®ï¼Œå¦‚æœä½ å†™äº†ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œä½ å¯èƒ½éœ€è¦æä¾›ç±»ä¼¼ä»¥ä¸‹çš„å‘½ä»¤è¡Œçš„ä¸€äº›é€‰é¡¹</p>

<pre><code>ps -ae
tail -f logfile.out
</code></pre>

<p>æœ‰ä¸€ä¸ªå«åšgetopt()çš„åº“å‡½æ•°èƒ½è®©ä½ æ›´å¥½åœ°å¤„ç†å‘½ä»¤è¡Œé€‰é¡¹,æ¯æ¬¡ä½ è°ƒç”¨å®ƒï¼Œå®ƒå°†è¿”å›ä¸‹ä¸€ä¸ªåœ¨å‘½ä»¤è¡Œä¸­çš„å‘½ä»¤è¡Œé€‰é¡¹
å‡è®¾ä½ æœ‰ä¸€ä¸ªå‡½æ•°ï¼Œèƒ½æä¾›å¤šä¸ªå‘½ä»¤è¡Œé€‰é¡¹</p>

<pre><code>rocket_to -e 4 -a Brasilia Tokyo Londonè¿™ä¸ªå‡½æ•°å°†éœ€è¦ä¸¤ä¸ªä¸ªé€‰é¡¹ï¼Œå…¶ä¸­ä¸€ä¸ªé€‰é¡¹éœ€è¦æä¾›ä¸€ä¸ªå€¼ï¼Œå¦ä¸€ä¸ªä»…ä»…è¡¨ç¤ºæ­¤é€‰é¡¹æ˜¯å¦å¼€å…³,ä½ å¯ä»¥åœ¨ä¸€ä¸ªå¾ªç¯ä¸­è°ƒç”¨getopt()æ¥å¤„ç†è¿™äº›é€‰é¡¹ï¼Œå¦‚ä¸‹
</code></pre>

<p><img src="http://xiekunRonaldo.github.io/images/2014/7/getopt.png">
åœ¨å¾ªç¯ä¸­ï¼Œä½ ç”¨switchæ¥å¤„ç†æ¯ä¸€ä¸ªåˆæ³•çš„é€‰é¡¹,å­—ç¬¦ä¸²&#8221;ae:&ldquo;å‘ŠçŸ¥getopt()å‡½æ•°aå’Œeæ˜¯åˆæ³•çš„é€‰é¡¹ï¼Œç´§è·Ÿåœ¨eä¹‹åçš„å†’å·è¡¨ç¤º-eåé¢éœ€è¦ä¸€ä¸ªçš„å€¼ï¼Œgetopt()å°†ç”¨optargå˜é‡è¡¨ç¤ºè¿™ä¸ªå€¼å½“å¾ªç¯ç»“æŸï¼Œä½ è®©argvå’Œargcå˜é‡è·³è¿‡æ‰€æœ‰çš„é€‰é¡¹ï¼Œæ­¤æ—¶å®ƒä»¬è¡¨ç¤ºè·Ÿéšè¿™äº›é€‰é¡¹ä¹‹åçš„å‘½ä»¤è¡Œå‚æ•°ï¼Œè¿™æ ·ï¼Œargvæ•°ç»„è¡¨ç¤ºå¦‚ä¸‹</p>

<p><img src="http://xiekunRonaldo.github.io/images/2014/7/skipargv.png">æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†ä¸¤ä¸ªé€‰é¡¹ç»“åˆèµ·æ¥
å¦‚ç”¨-tdè€Œä¸æ˜¯-t -d
é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœç¨‹åºåœ¨å‘½ä»¤è¡Œä¸­çœ‹åˆ°ä»¥&#8221;&ndash;&ldquo;å¼€å¤´çš„å‘½ä»¤è¡Œï¼Œç¨‹åºå°†ä¼šæŠŠå®ƒå½“ä½œå‘½ä»¤è¡Œé€‰é¡¹ï¼Œå¦‚æœè¦é¿å…æ­¤ç§æƒ…å†µï¼Œå¯ä»¥åœ¨&rdquo;&ndash;&ldquo;å‰åŠ &mdash;,è¿™æ ·ï¼Œåœ¨&rdquo;&mdash;&ldquo;ä¹‹åçš„å‚æ•°å°±è¢«å½“ä½œæ™®é€šçš„å‚æ•°äº†</p>

<pre><code>set_temperature -c -- -4
</code></pre>

<p>ä»¥ä¸Šçš„å‘½ä»¤è¡Œä¸­ï¼Œ-4å°±è¢«å½“ä½œæ™®é€šçš„å‚æ•°è€Œéå‘½ä»¤è¡Œé€‰é¡¹</p>
]]></content>
  </entry>
  
</feed>
